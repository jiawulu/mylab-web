function CookieObj() {
	return this.path = "/",
	this.domain = ".3g.qq.com",
	this.days = 30,
	this.set = function(e, t) {
		var n = new Date;
		n.setTime(n.getTime() + this.days * 24 * 60 * 60 * 1e3);
		var r = "";
		r += e + "=" + escape(t),
		r += ";expires=" + n.toGMTString(),
		this.path != "" && (r += ";path=" + this.path),
		this.domain != "" && (r += ";domain=" + this.domain),
		r += ";",
		document.cookie = r
	},
	this.get = function(e) {
		var t = document.cookie.match(new RegExp("(^| )" + e + "=([^;]*)(;|$)"));
		return t != null ? unescape(t[2]) : null
	},
	this.del = function(e) {
		var t = new Date;
		t.setTime(t.getTime() - 1);
		var n = "";
		n += e + "=",
		n += ";expires=" + t.toGMTString(),
		this.path != "" && (n += ";path=" + this.path),
		this.domain != "" && (n += ";domain=" + this.domain),
		n += ";",
		document.cookie = n
	},
	this
}
function LocalStorageObj() {
	return this.set = function(e, t) {
		var n = util.isArray(t) || util.isObject(t) ? util.jsonStringfy(t) : t;
		try {
			localStorage.setItem(e, n)
		} catch(r) {
			return ! 1
		}
	},
	this.get = function(e) {
		var t;
		try {
			t = util.parseJSON(localStorage.getItem(e))
		} catch(n) {
			t = undefined
		}
		return t
	},
	this.remove = function(e) {
		if (! ("localStorage" in window)) return;
		try {
			return localStorage.removeItem(e)
		} catch(t) {}
	},
	this
}
function Canvas(e, t) {
	return
}
function tStrLength(e) {
	var t = 0;
	for (var n = e.length; n--;) e.charCodeAt(n) > 128 ? t += 1: t += .5;
	return Math.ceil(t)
}
function showPersonIndex(e) {
	location.hash = "#guest_home/u=" + e
}
function doSearchTopics(e) {
	location.hash = "#detailTopic/keyword=" + encodeURIComponent(e)
}
function onGetMore() {
	return
}
function hideURLbar() {
	setTimeout(scrollTo, 100, 0, 37)
}
function countTotal(e) {
	var t = "<p>" + e + "</p>",
	n = 0;
	return $(t).contents().each(function(e, t) {
		n += $(t).text().length
	}),
	n
}
function filterContent(e, t) {
	var n = "<p>" + e + "</p>",
	r = "",
	i = t;
	return $(n).contents().each(function(e, t) {
		if (i > 0) {
			var n = $(t);
			t.localName != "a" ? r += n.text().substr(0, i) : r += '<a href="' + n.attr("href") + '">' + n.text().substr(0, i) + "</a>",
			i -= n.text().length
		}
	}),
	r
}
function geoRequestAddr(e) {
	var t = $.ajax({
		url: g_action,
		data: {
			ac: g_ac.AC_LBS_QUERY_ADDR_TEXT,
			latitude: e.latitude,
			longitude: e.longitude
		},
		async: ! 1
	}).responseText,
	n = $.parseJSON(t);
	return $.trim(n.msg)
}
function imgLoader(e, t) {
	var t = t || "img",
	n = e.find(t);
	if (typeof g_from_android != "undefined" && g_from_android) {
		var r = n.length,
		i = 0,
		s = (new Date).getTime(),
		o = function() {
			if (!n[i].getAttribute("data-src")) {
				i++,
				o();
				return
			}
			n[i].src = n[i].getAttribute("data-src"),
			i++;
			if (i == r) return;
			var e = new Image;
			s = (new Date).getTime(),
			e.src = n[i].getAttribute("data-src"),
			e.onload = o,
			e.onerror = o,
			e.onabort = o
		};
		r > 0 && o()
	} else n.each(function(e, t) {
		var n = new Image;
		n.src = t.getAttribute("data-src"),
		n.onload = function() {
			t.src = n.src
		}
	})
}
function noReferer(e, t) {
	var n = window.location.pathname,
	r = n.replace(/\w+\.jsp/, "noreferer.html");
	if (t.indexOf("qq.com") != - 1 || t[0] == "#") window.location.assign(t);
	else {
		var i = window.location.protocol + "//" + window.location.hostname + r + "?" + encodeURIComponent(t);
		window.open(i, "_blank")
	}
}
function MessageLayer() {
	var e = this,
	t = '<div id="shareopration" class="wb-dialog-wrap" style="display:none;"><div class="wb-dialog wb-dialog-share"><div class="wb-dialog-head"><a class="wb-dialog-close" action-data="close">×</a><h2 class="wb-dialog-title">腾讯微博</h2></div><div class="wb-dialog-cont"><div class="wb-input-area"><p id="t_msg_content"></p></div><div class="wb-dialog-bar"><a class="btn send-btn t_go_superqq">前往超Q官网</a><a class="btn send-btn t_cancel">取消</a></div></div></div></div>';
	this.jObj = $(t),
	$("body").append(this.jObj)
}
function ShareLayer() {
	var e = this,
	t = '<div id="shareopration" class="wb-dialog-wrap" style="display:none;"><div class="wb-dialog wb-dialog-share"><div class="wb-dialog-head"><a class="wb-dialog-close" action-data="close">×</a><h2 class="wb-dialog-title">分享到腾讯微博</h2></div><div class="wb-dialog-cont"><div class="wb-input-area"><div class="wb-textarea"><textarea id="t_wirte_textarea"></textarea></div>	</div><div class="wb-dialog-bar"><a class="t_writepop_clear">清空</a><span class="wb-dialog-num t_wirte_wb-dialog-num">140</span><a class="btn send-btn t_wirte_send-btn">发布</a></div></div></div></div>';
	this.jObj = $(t),
	$("body").append(this.jObj),
	this.writeTextArea = this.jObj.find("#t_wirte_textarea")[0],
	this.numTip = this.jObj.find("span.t_wirte_wb-dialog-num")[0],
	this.isPosting = ! 1
}
function MorePopLayer() {
	var e = this,
	t = '<div id="moreoperation" class="wb-dialog-wrap" style="display:none;"> <div class="wb-dialog"><div class="wb-dialog-head"><a  class="wb-dialog-close" action-data="close">×</a> <h2 class="wb-dialog-title">更多</h2></div><div class="wb-dialog-list t_wb-dialog-list"> </div></div></div>';
	this.jObj = $(t),
	$("body").append(this.jObj)
}
function PicMorePopLayer() {
	this.jObj = $('<div id="picmoreoperation" class="wb-dialog-wrap" style="display:none;"> <div class="wb-dialog"> <div class="wb-dialog-head"> <a  class="wb-dialog-close" action-data=\'close\'>×</a> <h2 class="wb-dialog-title">更多操作</h2> </div> <div class="wb-dialog-list"> <a  class="t_modify_pic" >更改图片</a> <a  class="t_delete_pic">删除</a> </div> </div> </div>'),
	$("body").append(this.jObj)
}
function WritePopLayer() {
	this.jObj = $('<div id="writeoperation" class="wb-dialog-wrap" style="display:none"> <div class="wb-dialog"> <div class="wb-dialog-head"> <a  class="wb-dialog-close" action-data=\'close\'>×</a> <h2 class="wb-dialog-title t_wirte_wb-dialog-title"></h2> </div> <div class="wb-dialog-cont"> <div class="wb-input-area"> <div class="wb-textarea"> <textarea id="t_wirte_textarea"></textarea> </div> </div> <div class="wb-dialog-bar"> <a  class="ico-bq t_writepop_ico-bq"></a> <a  class="ico-at t_writepop_ico-at"></a> <a class="t_writepop_clear">清空</a> <span class="wb-dialog-num t_wirte_wb-dialog-num">140</span> <a  class="btn send-btn t_wirte_send-btn">转播</a> </div> <div class="wb-info t_wirte_wb-info"></div> </div> </div> </div>'),
	$("body").append(this.jObj),
	this.writeTextArea = this.jObj.find("#t_wirte_textarea")[0],
	this.numTip = this.jObj.find("span.t_wirte_wb-dialog-num")[0],
	this.writeParams = null,
	this.page = null,
	this.atPage = null,
	this.facePage = null,
	this.isPosting = ! 1
}
function PrivateLayer() {
	var e = '<div class="wb-dialog-wrap" id="privateLayer" style="display:none"><div class="wb-dialog"> <div class="wb-dialog-head"><a class="wb-dialog-close t_close" >×</a><h2 class="wb-dialog-title">发私信</h2></div><div class="wb-dialog-cont"><div class="choose-user"><label for="">收信人：</label><input type="text" class="wb-text-input"><a class="more-user-link t_list">选择用户</a></div><div class="wb-input-area"><div class="wb-textarea"> <textarea></textarea> </div> </div><div class="wb-dialog-bar"><a class="ico-bq current t_facebtn"></a><a class="t_clear">清空</a><span class="wb-dialog-num t_num">140</span><a class="btn send-btn t_send">发送</a></div><div class="wb-info t_last" style="display:none"></div></div></div>';
	this.jObj = $(e),
	$("body").append(this.jObj),
	this.wrapper = this.jObj[0],
	this.last = this.jObj.find(".t_last"),
	this.listBtn = this.jObj.find(".t_list"),
	this.faceBtn = this.jObj.find(".t_facebtn"),
	this.userInput = this.wrapper.querySelector("input"),
	this.textarea = this.wrapper.querySelector("textarea"),
	this.disNum = this.wrapper.querySelector(".t_num"),
	this.clearBtn = this.wrapper.querySelector(".t_clear"),
	this.closeBtn = this.wrapper.querySelector(".t_close"),
	this.postBtn = this.wrapper.querySelector(".t_send"),
	this.bindAction()
}
function UserInfoLayer() {
	var e = this,
	t = '<div class="t_pop_info pop-userinfo" style="display:none;">    <a class="t_close_pop_info pop-userinfo-close">关闭</a><div class="wb-interact-avatar"><a onclick="" class="wb-user-headimg t_home_avatar t_listen_class" clickid="249" style="background:url(http://t1.qlogo.cn/mbloghead/default/40) no-repeat;-webkit-background-size:34px auto;"></a></div>    <div class="pop-userinfo-head">        <div class="wb-summary">            <div class="wb-user">                <strong class="t_username wb-username">...</strong>                <span class="t_vip vip"></span>                <a href="#level"><span class="t_level user-level">...</span></a>            </div>            <div class="wb-user-link">                <a href="#personal_info">个人资料</a>                <a href="#setting_entrance">设置</a>            </div>        </div>    </div>    <div class="pop-userinfo-main">        <div class="followers"><div><a style="width:100%;height:40px;display:block;" class="t_user-follower_target" href="#follower"><span>听众</span><span class="t_user-followerNum">...</span></a></div><div><a style="width:100%;height:40px;display:block;" class="t_user-following_target" href="#following"><span>收听</span><span class="t_user-followingNum">...</span></a></div><div><a style="width:100%;height:40px;display:block;" class="t_user-postNum_target" href="#mine"><span>广播</span><span class="t_user-postNum">...</span></a></div></div>        <div class="wb-member">            <div class="wb-member-tit">经验值等级</div>            <p><a href="#level">今日经验值：<em class="t_todayExp">...</em></a><a href="" style="display:none;" class="day-task-link">每日任务</a></p>        </div>        <div class="wb-member">            <div class="wb-member-tit">管理</div>            <p><a href="#my_favorite">收藏</a>            <a href="#subscription">订阅</a>            <a href="#black_list">黑名单</a></p>        </div>        <div class="wb-member">            <div class="wb-member-tit">我的</div>            <p><a href="#special_following">特别收听</a>            <a href="#may_know">可能认识的人</a>            <a href="#intimate_friend">微博密友</a></p>        </div>    </div></div>';
	this.jObj = $(t),
	$("body").append(this.jObj),
	this.bindAction(),
	this.isPosting = ! 1
}
function Layer() {
	this.blackLayer = $("#t_dialog_pop")
}
function MessageContainer(e, t) {
	this.mst = e,
	this.pageObj = t,
	this.getMoreParam = null,
	this.getMoreData = null,
	this.refreshData = this.getRefreshData()
}
function generatePage(e, t) {
	t = t ? t: MessagePage;
	var n = generateSubClass(t);
	return PageManager.register(e, n),
	n
}
function generateSubClass(e) {
	function t() {
		this.init(),
		this.bindAction()
	}
	return t.prototype = new e,
	t.prototype.constructor = t,
	t
}
function Message() {}
function MBUser(e, t) {
	this.initCfg = t,
	this.init(e),
	this.bindAction()
}
function Topic(e) {
	this.init(e),
	this.bindAction()
}
function Page() {}
function MessagePage() {}
function MbMessage(e, t, n) {
	if (!e) return;
	this.jObj = $(e),
	this.cfg = n,
	this.historyLoadId = "",
	this.bindAction()
}
function PrivateMessage(e) {
	this.jObj = $(e),
	this.bindAction()
}
function MbDetailMessage(e, t) {
	this.jObj = $(e),
	this.sourceElement = $(t),
	this.historyLoadId = "",
	this.bindAction()
}
function ejsRender(e, t) {
	if (e.special_render) return ejsSpecialRender(e.special_render, e);
	var n = Number(e.mst);
	switch (n) {
	case g_mst.DETAIL_ALL_MSG:
	case g_mst.DETAIL_FWD_MSG:
		return renderDetailUl(e);
	case g_mst.HOME_MSG:
	case g_mst.TIMELINE_ORIGINAL_MSG:
	case g_mst.SPECIAL_MSG:
	case g_mst.IMETION_MSG:
	case g_mst.IMETION_MSG_FOLLOWING:
	case g_mst.USER_TIMELINE:
	case g_mst.SEARCH_TOPIC_LIST:
	case g_mst.SEARCH_TOPIC_JX_LIST:
	case g_mst.SEARCH_TOPIC_ALL_LIST:
	case g_mst.IPOST_MSG:
	case g_mst.ORIGINAL_MSG:
	case g_mst.WITH_IMAGE_MSG:
	case g_mst.TIMELINE_WITH_IMAGE_MSG:
	case g_mst.FORWARD_MSG:
	case g_mst.REPLY_MSG:
	case g_mst.KEPT_MSG:
	case g_mst.SEARCH_MSG_LIST:
	case g_mst.HOT_MSG_LIST:
	case g_mst.RANDOM_MSG_LIST:
	case g_mst.NEARBY_MSG_LIST:
	case g_mst.QQ_FRIENDS_MSG:
	case g_mst.TOPIC_LIST_MYFOLLOW:
	case g_mst.FAMOUS_SAY:
	case g_mst.IMENTION_MSG_STAR:
	case g_mst.BIDIRECTION_FOLLOWS:
	case g_mst.LIST_MSG:
	case g_mst.TOPIC_LIST_GOOD:
	case g_mst.TOPIC_LIST_MYFOLLOW:
	case g_mst.TOPIC_LIST_ALL:
	case g_mst.TOPIC_DETAIL_IMAGE:
	case g_mst.TOPIC_DETAIL_NEW:
	case g_mst.TOPIC_DETAIL_ALL:
	case g_mst.TOPIC_DETAIL_DEFINE:
		return renderCommonMsgs(e);
	case g_mst.HOST_SPECIAL_FOLLOWING:
	case g_mst.USER_FOLLOWING_CONF:
		return renderSpecialFollowUsers(e);
	case g_mst.PRIVATEMSGHOME:
		return renderPrivateList(e);
	case g_mst.DIALOGHISTORY:
		return renderPrivateMsg(e);
	case g_mst.TOPIC_LIST:
	case g_mst.HOT_TOPIC_LIST:
	case g_mst.KEYWORD_LIST:
		return renderTopic(e, t);
	case g_mst.USER_FOLLOWER:
	case g_mst.USER_FOLLOWING:
	case g_mst.SEARCH_USER_LIST:
	case g_mst.FAMOUS_USER_LIST:
	case g_mst.HOT_USER_LIST:
	case g_mst.NEARBY_USER_LIST:
	case g_mst.CLOSE_FRIEND:
	case g_mst.MAYBE_KNOW:
	case g_mst.JOINTFOLLOW:
	case g_mst.USER_SPECIAL_FOLLOWING:
	case g_mst.SEARCH_USER_FOLLOWER:
	case g_mst.SEARCH_USER_FOLLOW:
		return renderUserList(e, t);
	case g_mst.RECOMMEND_FAMOUS:
		return renderRecommendList(e, t);
	case g_mst.BLACK_USER_LIST:
		return renderBlackList(e);
	case g_mst.CHANNEL:
		return renderChannel(e);
	case g_mst.CHANNEL_DETAIL:
		return renderChannelDetail(e, t);
	case g_mst.FAMOUS_INDEX:
		return renderFamous(e);
	default:
		return ""
	}
	return ""
}
function ejsSpecialRender(e, t) {
	switch (e) {
	case "no_pub_special_following":
		return ejsNoPubSpecialFollowing();
	case "no_special_following":
		return ejsNoSpecialFollowing();
	default:
		return ""
	}
}
function renderSpecialFollowUsers(e) {
	var t = "",
	n = e.users,
	r;
	t += '<ul class="follower-list focusable" mst="' + e.mst + '" >';
	switch (e.mst) {
	case g_mst.USER_SPECIAL_FOLLOWING:
		r = ejsCreateGuestFollowingUser;
		break;
	case g_mst.HOST_SPECIAL_FOLLOWING:
		r = ejsCreateSpecialFollowingUser;
		break;
	case g_mst.USER_FOLLOWING_CONF:
		r = ejsCreateFollowingConf;
		break;
	default:
		r = null
	}
	if (!r) return "";
	for (var i = 0, s = n.length; i < s; i++) t += r(n[i]);
	return typeof e.getMoreData != "undefined" && (t += ejsUserCreateMoreBtn(e.getMoreData)),
	t += "</ul>",
	t
}
function renderRelatedMessageForTopic(e) {
	var t = '<ul class="t_relatedList timeline-list">';
	if (e == undefined || e.length == 0) t += '<div class="search-result-inner"><p><strong>暂无数据。</strong></p></div>';
	else if (e != undefined && e.length > 0) for (var n = 0, r = e.length; n < r; n++) t += ejsCreateMsg(e[n]);
	return t += "</ul>",
	t
}
function renderCommonMsgs(e) {
	var t = "",
	n = e.msgs;
	if (e.mst == g_mst.SPECIAL_MSG) {
		if (n == undefined || n.length === 0) {
			var r = (new EJS({
				element: "ejs_empty_special_following",
				type: "["
			})).render({});
			return r
		}
	} else if (e.mst == g_mst.NEARBY_MSG_LIST && e.locate && (e.locate == "-1" || e.locate == "-2" || e.locate == "-3")) return ! 1;
	t += '<ul class="t_fwdList timeline-list t_focusable"  mst="' + e.mst + '" >';
	if (n == undefined || n.length == 0) t += '<div class="search-result-inner"><p><strong>暂无数据。</strong></p></div>';
	else if (n != undefined && n.length > 0) {
		var i = e.refMsgCount;
		for (var s = 0, o = n.length; s < o; s++) n[s].isRelatedMsg = e.isRelatedMsg,
		i && (n[s].isRelatedMsg = ! 0, i--),
		t += ejsCreateMsg(n[s])
	}
	if (e.getMoreData) {
		var u;
		switch (parseInt(e.getMoreData.ac, 10)) {
		case g_ac.AC_TOPIC_SEARCH:
			u = createTopicSearchMore;
			break;
		case g_ac.AC_MSG_SEARCH:
			u = createMsgSearchMore;
			break;
		case g_ac.AC_HOT_MSG:
			u = createHotMsgMore;
			break;
		case g_ac.AC_NEARBYMSG:
			u = createNearByMsgMore;
			break;
		default:
			u = createCommonMsgMore
		}
		t += u(e.getMoreData)
	}
	return t += "</ul>",
	t
}
function ejsCreateSpecialFollowingUser(e) {
	var t = (new EJS({
		element: "ejs_user_special_following",
		type: "["
	})).render(e);
	return t
}
function ejsCreateGuestFollowingUser(e) {
	var t = (new EJS({
		element: "ejs_guest_following",
		type: "["
	})).render(e);
	return t
}
function ejsCreateFollowingConf(e) {
	var t = (new EJS({
		element: "ejs_user_following_conf",
		type: "["
	})).render(e);
	return t
}
function ejsCreateMsg(e, t) {
	t || (t = "ejs_common_msg"),
	e && e.authorImgUrl && (e.authorImgUrl = e.authorImgUrl.replace(/40$/, "50")),
	e.sourceMsg && (e.forwardCount = e.sourceMsg.forwardCount),
	e.forwardCount < 9999999 && e.forwardCount > 0 ? e.forwardCount = util.numNotation(e.forwardCount) : e.forwardCount > 9999999 ? e.forwardCount = "9,999,999+": e.forwardCount = "",
	(e.msgType == 4 || e.msgType == 5) && ! nameLengthCheck(e.username, e.replyToUserName) && (e.replyToUserName = "");
	var n = (new EJS({
		element: t,
		type: "["
	})).render(e);
	return n
}
function ejsCreateDetailMsg(e, t) {
	t || (t = "ejs_detail_message");
	var n = (new EJS({
		element: t,
		type: "["
	})).render(e);
	return n
}
function ejsCreateTopicDetailMsg(e, t) {
	t || (t = "ejs_topic_detail_message");
	var n = (new EJS({
		element: t,
		type: "["
	})).render(e);
	return n
}
function ejsCreateTopicAction(e) {
	var t = '<div class="t_action wb-ht-pubinfo editfield-wrap"><span class="wb-ht-num">已有<span class="t_count new-tz">' + e.msgCount + "</span>条微博参与</span> ";
	return e.isTopicKept ? t += ['<a class="t_auth add-dy t_follow-operation" data-iskeyword="', e.iskeyword, '" data-topic-id="', e.topicId, '" data-keyword="', e.keyword, '" data-ac="', e.iskeyword ? g_ac.AC_KEYWORD_DROP: g_ac.AC_TOPIC_DROP, '">取消订阅</a>'].join("") : t += ['<a class="t_auth add-dy t_follow-operation" data-iskeyword="', e.iskeyword, '" data-topic-id="', e.topicId, '" data-keyword="', e.keyword, '" data-ac="', e.iskeyword ? g_ac.AC_KEYWORD_KEEP: g_ac.AC_TOPIC_KEEP, '">添加订阅</a>'].join(""),
	t += "</div>",
	t
}
function createCommonMsgMore(e) {
	var t = "";
	return e && (t = (new EJS({
		element: "ejs_msg_more_button",
		type: "["
	})).render(e)),
	t
}
function createHotMsgMore(e) {
	var t = "";
	return e && (t = (new EJS({
		element: "ejs_hot_msg_more_button",
		type: "["
	})).render(e)),
	t
}
function createNearByMsgMore(e) {
	var t = "";
	return e && (t = (new EJS({
		element: "ejs_nearby_msg_more_button",
		type: "["
	})).render(e)),
	t
}
function createUserListMore(e, t) {
	var n = "";
	return e ? n = (new EJS({
		element: "ejs_user_list_more_button",
		type: "["
	})).render(e) : t == g_mst.JOINTFOLLOW ? n = '<li class="timeline-list-item wb-more t_btn-getmore"> <a>换一批</a></li>': n = "<li class='t_btn-getmore'><div class='talkfooter' ><span></span></div></li>",
	n
}
function createTopicSearchMore(e) {
	if (!e) return "";
	var t = (new EJS({
		element: "ejs_topic_list_more_button",
		type: "["
	})).render(e);
	return t
}
function createSubscriptionMore(e) {
	if (!e) return "";
	var t = (new EJS({
		element: "ejs_subscript_more_button",
		type: "["
	})).render(e);
	return t
}
function ejsUserCreateMoreBtn(e) {
	var t = (new EJS({
		element: "ejs_user_list_more_button",
		type: "["
	})).render(e);
	return t
}
function createMsgSearchMore(e) {
	var t = (new EJS({
		element: "ejs_msg_search_more_button",
		type: "["
	})).render(e);
	return t
}
function ejsCommentCreateMoreBtn(e) {
	var t = (new EJS({
		element: "ejs_comment_more_button",
		type: "["
	})).render(e);
	return t
}
function ejsNoPubSpecialFollowing() {
	var e = (new EJS({
		element: "ejs_no_pub_special_following",
		type: "["
	})).render({});
	return e
}
function ejsNoSpecialFollowing() {
	var e = (new EJS({
		element: "ejs_no_special_following",
		type: "["
	})).render({});
	return e
}
function renderMsgCommentList(e, t) {
	var n, r = "",
	i = e.msgs;
	if (i == undefined || i.length === 0) return "";
	for (var s = 0, o = i.length; s < o; s++) r += renderMsgFwd(i[s]);
	return e.hasNext && e.getMoreData && (r += ejsCommentCreateMoreBtn(e.getMoreData)),
	t ? (n = '<ul class="t_fwdList t_focusable-item deletable-item" style="display: block; " mst="' + e.mst + '">' + r + "</ul>", n) : (n = r, n)
}
function renderMsgFwd(e) {
	return (new EJS({
		element: "ejs_history_fwd_msg",
		type: "["
	})).render(e)
}
function renderPrivateList(e) {
	var t, n = "",
	r = e.msgs;
	if (r == undefined || r.length === 0) return "";
	for (var i = 0, s = r.length; i < s; i++) if (!r[i] || ! r[i].msgId) console.log("empty msg, index: " + i);
	else if (r[i].replyToUserName) {
		var o = r[i];
		o.replyToUserName.length > 11 && (o.replyToUserName = o.replyToUserName.substring(0, 11)),
		n += (new EJS({
			element: "ejs_private_msg",
			type: "["
		})).render(o)
	}
	return t = '<ul class="timeline-list" mst="' + e.mst + '">' + n + createCommonMsgMore(e.getMoreData) + "</ul>",
	t
}
function renderPrivateMsg(e) {
	var t, n = "",
	r = e.msgs;
	if (r == undefined || r.length === 0) return "";
	for (var i = 0, s = r.length; i < s; i++) if (!r[i] || ! r[i].msgId) console.log("empty msg, index: " + i);
	else {
		var o = r[i];
		o.username && o.username.length > 11 && (o.username = o.username.substring(0, 11)),
		n += (new EJS({
			element: "ejs_private_msg_detail",
			type: "["
		})).render(o)
	}
	return t = '<ul class="timeline-list" mst="' + e.mst + '">' + n + createCommonMsgMore(e.getMoreData) + "</ul>",
	t
}
function renderTopic(e, t) {
	var n = '<ul class="timeline-list" mst="' + e.mst + '">',
	r = "",
	i = e.topics,
	s = e.mst;
	for (var o = 0, u = i.length; o < u; o++) i[o].type = s == g_mst.KEYWORD_LIST ? "keyword": "",
	i[o].renderOptions = t,
	r += (new EJS({
		element: "ejs_topic",
		type: "["
	})).render(i[o]);
	return t.noResultData ? n += r + '<li class="more-link"><a href="#hot">更多</a></li></ul>': n += r + createSubscriptionMore(e.getMoreData) + "</ul>",
	n
}
function renderHotTopic(e, t) {
	var n = "",
	r = "",
	i = "",
	s = e.topics;
	"hot" == t ? (n = "<ul mst='" + g_mst.KEYWORD_LIST + '\' class="t_hot ht-list">', i = "ejs_hot_topic_msg") : "related" == t ? (n = "<ul mst='" + g_mst.KEYWORD_LIST + '\'  class="t_related cont-list">', i = "ejs_related_topic_msg") : "activities" == t ? (n = "<ul mst='" + g_mst.KEYWORD_LIST + '\'  class="t_activities ht-list">', i = "ejs_activities_topic_msg") : "banner" == t && (n = "<ul mst='" + g_mst.KEYWORD_LIST + '\'  class="t_banner SH_anim_comp banner_comp topic-swipe">', i = "ejs_banner_topic_msg");
	for (var o = 0, u = s.length; o < u; o++) r += (new EJS({
		element: i,
		type: "["
	})).render(s[o]);
	return n + r + "</ul>"
}
function renderNoDataHotTopic(e, t) {
	var n;
	return "hot" == t ? n = '<ul class="t_hot ht-list" >': "related" == t ? n = '<ul class="t_related cont-list">': "activities" == t && (n = '<ul class="t_activities acti-list">'),
	n += "<div class='search-result-inner'><p><strong>暂无数据，请尝试<a class=\"t_nodata_refresh\">刷新</a></strong></p></div></ul>",
	n
}
function renderUserList(e, t) {
	if (e.mst != g_mst.NEARBY_USER_LIST || ! e.locate || e.locate != "-1" && e.locate != "-2" && e.locate != "-3") {
		var n = '<ul class="follower-list focusable" mst="' + e.mst + '" >',
		r = "",
		i = "users" in e ? e.users: [],
		s = "getMoreData" in e ? e.getMoreData: null;
		if (i.length == 0) t.defaultText ? r += '<li class="timeline-list-item"><div class="search-result-inner"><p><strong>' + t.defaultText + "</strong></p></div></li>": e.mst == g_mst.USER_FOLLOWER ? r += '<li class="timeline-list-item"><div class="search-result-inner"><p><strong>您还没有听众。<a href="#famous">增加更多收听</a>，可以吸引听众哦。</strong></p></div></li>': e.mst == g_mst.USER_FOLLOWING ? r += '<li class="timeline-list-item"><div class="search-result-inner"><p><strong>您还没有收听的人，去<a href="#famous">名人页</a>看看吧。</strong></p></div></li>': e.mst == g_mst.CLOSE_FRIEND ? r += '<li class="timeline-list-item"><div class="search-result-inner"><p><strong>暂无数据。</strong></p></div></li>': e.mst == g_mst.JOINTFOLLOW && (r += '<li class="timeline-list-item"><div class="search-result-inner"><p><strong><a href="#famous">增加更多收听</a>，才可以帮您推荐可能认识的人哦。</strong></p></div></li>'),
		n += r;
		else {
			for (var o = 0, u = i.length; o < u; o++) {
				var a = i[o];
				for (var f in t) a[f] = t[f];
				r += (new EJS({
					element: "ejs_user_list",
					type: "["
				})).render(a)
			}
			n += r + createUserListMore(s, e.mst) + "</ul>"
		}
		return n
	}
	return ! 1
}
function renderRecommendList(e, t) {
	var n = '<ul class="follower-list focusable" mst="' + e.mst + '" >',
	r = "",
	i = "users" in e ? e.users: [],
	s = "getMoreData" in e ? e.getMoreData: null,
	r = "";
	for (var o = 0, u = i.length; o < u; o++) {
		var a = i[o];
		for (var f in t) a[f] = t[f];
		r += (new EJS({
			element: "ejs_user_list",
			type: "["
		})).render(a)
	}
	return n += r + "<li class='timeline-list-item wb-more'><a class='t_refresh'>换一批</a></li></ul>",
	n
}
function renderBlackList(e) {
	var t = e.users,
	n = '<ul class="follower-list focusable" mst="' + e.mst + '" >',
	r = "",
	i = e.users;
	if (t == undefined || t.length == 0) n += '<div class="search-result-inner"><p><strong>暂无数据。</strong></p></div>';
	else {
		for (var s = 0, o = i.length; s < o; s++) r += (new EJS({
			element: "ejs_black_list",
			type: "["
		})).render(i[s]);
		n += r + createUserListMore(e.getMoreData) + "</ul>"
	}
	return n
}
function renderChannel(e) {
	var t = '<ul class="t_class" mst="' + e.mst + '" >',
	n = "",
	r = e.channels;
	for (var i = 0, s = r.length; i < s; i++) r[i].iconUrl && (n += (new EJS({
		element: "ejs_channel_list",
		type: "["
	})).render(r[i]));
	return t += n + "</ul>",
	t
}
function renderChannelDetail(e, t) {
	if (!t) return renderCommonMsgs(e);
	if (t.picType) {
		var n = '<ul class="t_pic_timeline" mst="' + e.mst + '" >',
		r = "",
		i = e.msgs;
		for (var s = 0, o = i.length; s < o; s++) {
			var u = i[s];
			u.cnId && util.getByteLength(u.cnId) > 14 && (u.cnId = util.getByteStr(u.cnId, 14) + "..."),
			u.username && util.getByteLength(u.username) > 14 && (u.username = util.getByteStr(u.username, 14) + "..."),
			u.remark && util.getByteLength(u.remark) > 14 && (u.remark = util.getByteStr(u.remark, 14) + "..."),
			u.forwardCount < 9999999 && u.forwardCount ? u.forwardCount = util.numNotation(u.forwardCount) : u.forwardCount > 9999999 ? u.forwardCount = "9,999,999+": u.forwardCount = "",
			r += (new EJS({
				element: "ejs_pictype_msg",
				type: "["
			})).render(i[s])
		}
		return n += r + createCommonMsgMore(e.getMoreData) + "</ul>",
		n
	}
}
function renderFamous(e) {
	var t = {},
	n = e.recommArray,
	r = e.famousSayArray,
	i = e.famousArray,
	s = e.mst,
	o = '<div class="module"><div class="module-t"><span class="zxht">推荐收听</span></div><div class="module-c"><ul class="people-list" mst=' + s + '>[%= recommend %]<li class="more-link"><a class="t_auth" href="#recommend">查看更多</a></li></ul></div>' + "</div>" + '<div class="module-c">' + '<div class="module-t"><span class="xght">分类名人</span></div>' + '<ul class="txt-link-list t_class"><li>' + '[% for(var i=0;i<classArray.length;i++){ %]<a [%if(i==0){%]class="active"[%}%] classid="[%=classArray[i].classid %]">[%=classArray[i].name%]</a>[% } %]' + "</li></ul>" + '<ul class="people-list t_sp" mst=' + s + '>[%= celebrity %]<li class="more-link"><a class="t_auth" href="#celebrity">查看更多</a></li></ul>' + "</div>" + '<div class="module">' + '<div class="module-t"><span class="xght">名人在说</span></div>' + '<div class="module-c"><ul class="timeline-list t_fsay" mst=' + s + '>[%= talking %]<li class="more-link"><a class="t_auth" href="#talking">查看更多</a></li></ul></div>' + "</div>";
	t.recommend = "";
	for (var u = 0, a = n.length; u < a; u++) t.recommend += (new EJS({
		element: "ejs_people_msg",
		type: "["
	})).render(n[u]);
	t.celebrity = "";
	for (var f = 0, a = i.length; f < a; f++) t.celebrity += (new EJS({
		element: "ejs_people_msg",
		type: "["
	})).render(i[f]);
	t.talking = "";
	for (var l = 0, a = r.length; l < a; l++) t.talking += (new EJS({
		element: "ejs_famous_say",
		type: "["
	})).render(r[l]);
	return t.classArray = e.classArray,
	(new EJS({
		text: o,
		type: "["
	})).render(t)
}
function renderDetailUl(e) {
	var t, n = "",
	r = e.msgs,
	i = e.total,
	s = "";
	if (r == undefined || r.length === 0) {
		var o = e.mst == g_mst.DETAIL_FWD_MSG ? "暂无评论": "暂无转播和评论";
		n = '<li class="timeline-list-item"><div class="wb-empty-msg">' + o + "</div></li>"
	} else {
		for (var u = 0, a = r.length; u < a; u++) n += (new EJS({
			element: "ejs_detail_page",
			type: "["
		})).render(r[u]);
		n += createDetailMore(e.getMoreData)
	}
	return t = '<ul class="t_fwdList t_focusable-item" mst="' + e.mst + '">' + n + "</ul>",
	t
}
function createDetailMore(e) {
	var t = "";
	return e && (t = (new EJS({
		element: "ejs_detail_msg_more_button",
		type: "["
	})).render(e)),
	t
}
function renderHistoryKeywordForSearchPage(e) {
	var t = [];
	if (e && e.length > 0) for (var n = 0, r = e.length; n < r; n++) t.push('<a data-keyword="' + e[n].value + '" data-type="' + e[n].type + '">' + e[n].value + "</a>");
	else t.push('<div class="search-result-inner"><p><strong>暂时没有搜索历史</strong></p></div>');
	return t.join("")
}
function renderSubScriptionKeywordForSearchPage(e) {
	var t = [],
	n = e.topics;
	if (n && n.length > 0) {
		t.push('<p class="key-words-link">');
		for (var r = 0, i = n.length; r < i; r++) t.push((new EJS({
			element: "ejs_search_subscription_keyword",
			type: "["
		})).render(n[r]));
		t.push("</p>"),
		t.push('<p class="more-link"><a href="#subscription">更多</a></p>')
	} else t.push('<div class="t_mykeyword search-result-inner"><p><strong>暂时没有订阅关键词</strong></p></div>');
	return t.join("")
}
function renderMessageForSearchPage(e) {
	var t = [],
	n = e.msgs;
	t.push('<ul mst="' + e.mst + '" class="t_result timeline-list">');
	if (n && n.length > 0) {
		for (var r = 0, i = n.length; r < i; r++) t.push(ejsCreateMsg(n[r]));
		t.push("getMoreData" in e ? createMsgSearchMore(e.getMoreData) : "")
	} else t.push('<li class="timeline-list-item"><div class="search-result-inner"><p><strong>暂时没有找到相关微博</strong></p></div></li>');
	return t.push("</ul>"),
	t.join("")
}
function renderHotTopicForSearchPage(e, t) {
	var n = [],
	r = e.topics;
	n.push('<ul mst="' + e.mst + '" class="timeline-list">');
	if (r && r.length > 0) {
		for (var i = 0, s = r.length; i < s; i++) r[i].renderOptions = t,
		n.push((new EJS({
			element: "ejs_topic",
			type: "["
		})).render(r[i]));
		n.push('<p class="more-link"><a href="#hot">更多</a></p>')
	} else n.push('<li class="timeline-list-item"><div class="search-result-inner"><p><strong>暂时没有找到相关话题</strong></p></div></li>');
	return n.push("</ul>"),
	n.join("")
}
function renderUserForSearchPage(e, t) {
	var n = [],
	r = e.users;
	n.push('<ul mst="' + e.mst + '" class="t_result timeline-list">');
	if (r && r.length > 0) {
		for (var i = 0, s = r.length; i < s; i++) {
			for (var o in t) r[i][o] = t[o];
			n.push((new EJS({
				element: "ejs_user_list",
				type: "["
			})).render(r[i]))
		}
		n.push("getMoreData" in e ? createUserListMore(e.getMoreData) : "")
	} else n.push('<li class="timeline-list-item"><div class="search-result-inner"><p><strong>暂时没有找到相关用户</strong></p></div></li>');
	return n.push("</ul>"),
	n.join("")
}
function renderMaybeUserForSearchPage(e, t) {
	var n = [],
	r = e.users;
	n.push('<ul mst="' + e.mst + '" class="t_maybe timeline-list">');
	if (r && r.length > 0) {
		for (var i = 0, s = r.length; i < s; i++) {
			for (var o in t) r[i][o] = t[o];
			n.push((new EJS({
				element: "ejs_user_list",
				type: "["
			})).render(r[i]))
		}
		n.push('<li class="more-link"><a href="#may_know">更多</a></li>')
	} else n.push('<li class="timeline-list-item"><div class="search-result-inner"><p><strong>暂时没有找到相关用户</strong></p></div></li>');
	return n.push("</ul>"),
	n.join("")
}
function renderHotUserForSearchPage(e) {
	var t = [],
	n = e.users;
	t.push('<ul mst="' + e.mst + '" class="t_hot people-list">');
	if (n && n.length > 0) {
		for (var r = 0, i = n.length; r < i; r++) t.push((new EJS({
			element: "ejs_people_msg",
			type: "["
		})).render(n[r]));
		t.push('<li class="more-link"><a href="#famous">更多</a></li>')
	} else t.push('<li class="people-list-item"><div class="search-result-inner"><p><strong>暂时没有找到相关用户</strong></p></div></li>');
	return t.push("</ul>"),
	t.join("")
}
function renderRecommendUserList(e, t, n, r, i, s) {
	var o = [];
	s == "topic" ? o.push('<div class="st t_recommend"> <div class="st-tit">推荐收听： <div class="t_slide st-slide">') : ! s && t ? o.push('<div class="st t_recommend"> <div class="st-tit">收听' + i + '的人也收听： <div class="t_slide st-slide">') : ! s && ! t && o.push('<div class="st t_recommend"> <div class="st-tit">你收听的人中，有' + r + "人也收听了" + i + '： <div class="t_slide st-slide">');
	if (e && e.length > 0) for (var u = 0, a = Math.ceil(e.length / (s == "topic" ? 2: n == 2 ? 4: 5)); u < a; u++) u == 0 ? o.push('<span class="current">●</span>') : o.push("<span>●</span>");
	if (s == "topic") {
		var f = Math.ceil(e.length / 2) * 300;
		o.push('</div></div> <div class="SH_anim_mask people_mask"><ul class="people-list SH_anim_comp people_comp t_banner" style="width:' + f + 'px;">')
	} else if (!s && n == 2) {
		var f = Math.ceil(e.length / 4) * 300;
		o.push('</div></div> <div class="SH_anim_mask people_mask"><ul class="people-list SH_anim_comp people_comp t_banner" style="width:' + f + 'px;">')
	} else ! s && n == 1 && o.push('</div></div> <div class="SH_anim_mask user_mask"><ul class="user-list SH_anim_comp user_comp t_banner">');
	if (e && e.length > 0) for (var u = 0, a = e.length; u < a; u++) o.push((new EJS({
		element: n == 2 ? "ejs_recommend_people": "ejs_recommend_user",
		type: "["
	})).render(e[u]));
	return o.push("</ul></div></div>"),
	o.join("")
}
function renderAppRecommendUserList(e) {
	var t = [];
	t.push('<div class="st t_friends"> <div class="st-tit">你的这些好友也在玩： <div class="t_slide st-slide">');
	if (e && e.length > 0) {
		for (var n = 0, r = Math.ceil(e.length / 5); n < r; n++) n == 0 ? t.push('<span class="current">●</span>') : t.push("<span>●</span>");
		t.push('</div></div> <div class="SH_anim_mask user_mask"><ul class="user-list SH_anim_comp user_comp t_banner">');
		for (var n = 0, r = e.length; n < r; n++) t.push((new EJS({
			element: "ejs_recommend_user",
			type: "["
		})).render(e[n]))
	}
	return t.join("")
}
function renderAppPic(e) {
	var t = [];
	t.push('<div class="t_app_pic app-pic-slider">'),
	t.push('<div class="app-pic-list">'),
	t.push('<div class="t_mask SH_anim_mask pic_mask">'),
	t.push('<ul class="t_banner SH_anim_comp pic_comp">');
	if (e && e.length > 0) for (var n = 0, r = e.length; n < r; n++) t.push('<li><img src="' + e[n] + '" width="177" height="266"></li>');
	t.push("</ul>"),
	t.push("</div>"),
	t.push('<div class="app-pic-slide t_slide">');
	if (e && e.length > 0) for (var n = 0, r = e.length; n < r; n++) n == 0 ? t.push('<span class="current">●</span>') : t.push("<span>●</span>");
	return t.push("</div>"),
	t.push("</div>"),
	t.push("</div>"),
	t.join("")
}
function renderAppGrade(e) {
	var t = [];
	t.push('<div class="app-rank t_grade">');
	for (var n = 0; n < 5; n++) n < e ? t.push('<span class="app-star"></span>') : t.push('<span class="app-star empty"></span>');
	return t.push("</div>"),
	t.join("")
}
function nameLengthCheck(e, t) {
	var n = "";
	return n = e + t,
	util.getByteLength(n) <= 16 ? ! 0: ! 1
}
function composePageSuccessjs(e) {
	var t = PageManager.getCurrentPage();
	t.successjs(e)
}
function composePageCookiejs() {
	var e = PageManager.getCurrentPage();
	return e.cookiejs()
}
if (!window.jq || typeof jq != "function") {
	var jq = function(e) {
		"use strict";
		function h(e) {
			return e in s ? s[e] : s[e] = new RegExp("(^|\\s)" + e + "(\\s|$)")
		}
		function p(e) {
			for (var t = 0; t < e.length; t++) e.indexOf(e[t]) != t && (e.splice(t, 1), t--);
			return e
		}
		function d(e, n) {
			var r = [];
			if (e == t) return r;
			for (; e; e = e.nextSibling) e.nodeType == 1 && e !== n && r.push(e);
			return r
		}
		function g(e, t) {
			var r;
			try {
				e = e.trim();
				if (e[0] === "#" && e.indexOf(" ") === - 1 && e.indexOf(">") === - 1) t == n ? r = t.getElementById(e.replace("#", "")) : r = [].slice.call(t.querySelectorAll(e));
				else if (e[0] === "<" && e[e.length - 1] === ">") {
					var i = n.createElement("div");
					i.innerHTML = e.trim(),
					r = [].slice.call(i.childNodes)
				} else r = [].slice.call(t.querySelectorAll(e))
			} catch(s) {}
			return r
		}
		function y() {}
		function w(e, t) {
			e.os = {},
			e.os.webkit = t.match(/WebKit\/([\d.]+)/) ? ! 0: ! 1,
			e.os.android = t.match(/(Android)\s+([\d.]+)/) || t.match(/Silk-Accelerated/) ? ! 0: ! 1,
			e.os.ipad = t.match(/(iPad).*OS\s([\d_]+)/) ? ! 0: ! 1,
			e.os.iphone = ! e.os.ipad && t.match(/(iPhone\sOS)\s([\d_]+)/) ? ! 0: ! 1,
			e.os.webos = t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/) ? ! 0: ! 1,
			e.os.touchpad = e.os.webos && t.match(/TouchPad/) ? ! 0: ! 1,
			e.os.ios = e.os.ipad || e.os.iphone,
			e.os.blackberry = t.match(/BlackBerry/) || t.match(/PlayBook/) ? ! 0: ! 1,
			e.os.opera = t.match(/Opera Mobi/) ? ! 0: ! 1,
			e.os.fennec = t.match(/fennec/i) ? ! 0: ! 1,
			e.os.desktop = ! (e.os.ios || e.os.android || e.os.blackberry || e.os.opera || e.os.fennec)
		}
		function N(e) {
			return e._jqmid || (e._jqmid = x++)
		}
		function C(e, t, n, r) {
			t = k(t);
			if (t.ns) var i = L(t.ns);
			return (S[N(e)] || []).filter(function(e) {
				return e && (!t.e || e.e == t.e) && (!t.ns || i.test(e.ns)) && (!n || e.fn == n || typeof e.fn == "function" && typeof n == "function" && "" + e.fn == "" + n) && (!r || e.sel == r)
			})
		}
		function k(e) {
			var t = ("" + e).split(".");
			return {
				e: t[0],
				ns: t.slice(1).
				sort().join(" ")
			}
		}
		function L(e) {
			return new RegExp("(?:^| )" + e.replace(" ", " .* ?") + "(?: |$)")
		}
		function A(e, t, n) {
			m.isObject(e) ? m.each(e, n) : e.split(/\s/).forEach(function(e) {
				n(e, t)
			})
		}
		function O(e, t, n, r, i) {
			var s = N(e),
			o = S[s] || (S[s] = []);
			A(t, n, function(t, n) {
				var s = i && i(n, t),
				u = s || n,
				a = function(t) {
					var n = u.apply(e, [t].concat(t.data));
					return n === ! 1 && t.preventDefault(),
					n
				},
				f = m.extend(k(t), {
					fn: n,
					proxy: a,
					sel: r,
					del: s,
					i: o.length
				});
				o.push(f),
				e.addEventListener(f.e, a, ! 1)
			})
		}
		function M(e, t, n, r) {
			var i = N(e);
			A(t || "", n, function(t, n) {
				C(e, t, n, r).forEach(function(t) {
					delete S[i][t.i],
					e.removeEventListener(t.e, t.proxy, ! 1)
				})
			})
		}
		function H(e) {
			var t = m.extend({
				originalEvent: e
			},
			e);
			return m.each(P, function(n, r) {
				t[n] = function() {
					return this[r] = _,
					e[n].apply(e, arguments)
				},
				t[r] = D
			}),
			t
		}
		var t, n = e.document,
		r = [],
		i = r.slice,
		s = [],
		o = [],
		u = 1,
		a = [],
		f = 1,
		l = /^\s*<(\w+)[^>]*>/,
		c = {},
		v = function(e, r) {
			this.length = 0;
			if (!e) return this;
			if (e instanceof v && r == t) return e;
			if (m.isFunction(e)) return m(n).ready(e);
			if (m.isArray(e) && e.length != t) {
				for (var i = 0; i < e.length; i++) this[this.length++] = e[i];
				return this
			}
			if (m.isObject(e) && m.isObject(r)) {
				if (e.length == t) e.parentNode == r && (this[this.length++] = e);
				else for (var i = 0; i < e.length; i++) e[i].parentNode == r && (this[this.length++] = e[i]);
				return this
			}
			if (m.isObject(e) && r == t) return this[this.length++] = e,
			this;
			if (r !== t) {
				if (r instanceof v) return r.find(e)
			} else r = n;
			var s = this.selector(e, r);
			if (!s) return this;
			if (!m.isArray(s)) return this[this.length++] = s,
			this;
			for (var o = 0; o < s.length; o++) this[this.length++] = s[o];
			return this
		},
		m = function(e, t) {
			return new v(e, t)
		};
		m.map = function(e, n) {
			var r, i = [],
			s,
			o;
			if (m.isArray(e)) for (s = 0; s < e.length; s++) r = n(e[s], s),
			r !== t && i.push(r);
			else if (m.isObject(e)) for (o in e) {
				if (!e.hasOwnProperty(o)) continue;
				r = n(e[o], o),
				r !== t && i.push(r)
			}
			return m([i])
		},
		m.each = function(e, t) {
			var n, r;
			if (m.isArray(e)) {
				for (n = 0; n < e.length; n++) if (t(n, e[n]) === ! 1) return e
			} else if (m.isObject(e)) for (r in e) {
				if (!e.hasOwnProperty(r)) continue;
				if (t(r, e[r]) === ! 1) return e
			}
			return e
		},
		m.extend = function(e) {
			e == t && (e = this);
			if (arguments.length === 1) {
				for (var n in e) this[n] = e[n];
				return this
			}
			return i.call(arguments, 1).forEach(function(t) {
				for (var n in t) e[n] = t[n]
			}),
			e
		},
		m.isArray = function(e) {
			return e instanceof Array && e["push"] != t
		},
		m.isFunction = function(e) {
			return {}.toString.call(e) == "[object Function]"
		},
		m.isObject = function(e) {
			return typeof e == "object"
		},
		m.fn = v.prototype = {
			constructor: v,
			forEach: r.forEach,
			reduce: r.reduce,
			push: r.push,
			indexOf: r.indexOf,
			concat: r.concat,
			selector: g,
			oldElement: t,
			slice: r.slice,
			setupOld: function(e) {
				return e == t ? m() : (e.oldElement = this, e)
			},
			map: function(e) {
				return m.map(this, function(t, n) {
					return e.call(t, n, t)
				})
			},
			each: function(e) {
				return this.forEach(function(t, n) {
					e.call(t, n, t)
				}),
				this
			},
			ready: function(e) {
				return (n.readyState === "complete" || n.readyState === "loaded") && e(),
				n.addEventListener("DOMContentLoaded", e, ! 1),
				this
			},
			find: function(e) {
				if (this.length === 0) return m([]);
				var t = [],
				n;
				for (var r = 0; r < this.length; r++) {
					n = m(e, this[r]);
					for (var i = 0; i < n.length; i++) t.push(n[i])
				}
				return m(p(t))
			},
			html: function(e) {
				if (this.length === 0) return t;
				if (e === t) return this[0].innerHTML;
				for (var n = 0; n < this.length; n++) this[n].innerHTML = e;
				return this
			},
			text: function(e) {
				if (this.length === 0) return t;
				if (e === t) return this[0].textContent;
				for (var n = 0; n < this.length; n++) this[n].textContent = e;
				return this
			},
			css: function(n, r, i) {
				var s = i != t ? i: this[0];
				if (this.length === 0) return this;
				if (r == t && typeof n == "string") {
					var o = e.getComputedStyle(s);
					return s.style[n] ? s.style[n] : e.getComputedStyle(s)[n]
				}
				for (var u = 0; u < this.length; u++) if (m.isObject(n)) for (var a in n) this[u].style[a] = n[a];
				else this[u].style[n] = r;
				return this
			},
			empty: function() {
				for (var e = 0; e < this.length; e++) this[e].innerHTML = "";
				return this
			},
			hide: function() {
				if (this.length === 0) return this;
				for (var e = 0; e < this.length; e++) this.css("display", null, this[e]) != "none" && (this[e].setAttribute("jqmOldStyle", this.css("display", null, this[e])), this[e].style.display = "none");
				return this
			},
			show: function() {
				if (this.length === 0) return this;
				for (var e = 0; e < this.length; e++) this.css("display", null, this[e]) == "none" && (this[e].style.display = this[e].getAttribute("jqmOldStyle") ? this[e].getAttribute("jqmOldStyle") : "block", this[e].removeAttribute("jqmOldStyle"));
				return this
			},
			toggle: function(n) {
				var r = n === ! 0 ? ! 0: ! 1;
				for (var i = 0; i < this.length; i++) e.getComputedStyle(this[i]).display !== "none" || n !== t && r === ! 1 ? (this[i].setAttribute("jqmOldStyle", this[i].style.display), this[i].style.display = "none") : (this[i].style.display = this[i].getAttribute("jqmOldStyle") != t ? this[i].getAttribute("jqmOldStyle") : "block", this[i].removeAttribute("jqmOldStyle"));
				return this
			},
			val: function(e) {
				if (this.length === 0) return t;
				if (e == t) return this[0].value;
				for (var n = 0; n < this.length; n++) this[n].value = e;
				return this
			},
			attr: function(e, n) {
				if (this.length === 0) return t;
				if (n === t && ! m.isObject(e)) {
					var r = this[0].jqmCacheId && c[this[0].jqmCacheId][e] ? this[0].jqmCacheId && c[this[0].jqmCacheId][e] : this[0].getAttribute(e);
					return r
				}
				for (var i = 0; i < this.length; i++) if (m.isObject(e)) for (var s in e) m(this[i]).attr(s, e[s]);
				else m.isArray(n) || m.isObject(n) || m.isFunction(n) ? (this[i].jqmCacheId || (this[i].jqmCacheId = m.uuid()), c[this[i].jqmCacheId] || (c[this[i].jqmCacheId] = {}), c[this[i].jqmCacheId][e] = n) : n == null && n !== t ? (this[i].removeAttribute(e), this[i].jqmCacheId && c[this[i].jqmCacheId][e] && delete c[this[i].jqmCacheId][e]) : this[i].setAttribute(e, n);
				return this
			},
			removeAttr: function(e) {
				var t = this;
				for (var n = 0; n < this.length; n++) e.split(/\s+/g).forEach(function(r) {
					t[n].removeAttribute(r),
					t[n].jqmCacheId && c[t[n].jqmCacheId][e] && delete c[t[n].jqmCacheId][e]
				});
				return this
			},
			remove: function(e) {
				var n = m(this).filter(e);
				if (n == t) return this;
				for (var r = 0; r < n.length; r++) n[r].parentNode && n[r].parentNode.removeChild(n[r]);
				return this
			},
			addClass: function(e) {
				for (var t = 0; t < this.length; t++) {
					var n = this[t].className,
					r = [],
					i = this;
					e.split(/\s+/g).forEach(function(e) {
						i.hasClass(e, i[t]) || r.push(e)
					}),
					this[t].className += (n ? " ": "") + r.join(" "),
					this[t].className = this[t].className.trim()
				}
				return this
			},
			removeClass: function(e) {
				for (var n = 0; n < this.length; n++) {
					if (e == t) return this[n].className = "",
					this;
					var r = this[n].className;
					e.split(/\s+/g).forEach(function(e) {
						r = r.replace(h(e), " ")
					}),
					r.length > 0 ? this[n].className = r.trim() : this[n].className = ""
				}
				return this
			},
			hasClass: function(e, t) {
				return this.length === 0 ? ! 1: (t || (t = this[0]), h(e).test(t.className))
			},
			append: function(r, i) {
				if (r && r.length != t && r.length === 0) return this;
				if (m.isArray(r) || m.isObject(r)) r = m(r);
				var s;
				for (s = 0; s < this.length; s++) if (r.length && typeof r != "string") {
					r = m(r);
					for (var o = 0; o < r.length; o++) i != t ? this[s].insertBefore(r[o], this[s].firstChild) : this[s].appendChild(r[o])
				} else {
					var u = l.test(r) ? m(r) : t;
					if (u == t || u.length == 0) u = n.createTextNode(r);
					if (u.nodeName == t || u.nodeName.toLowerCase() != "script" || !! u.type && u.type.toLowerCase() !== "text/javascript") if (u instanceof v) for (var a = 0; a < u.length; a++) i != t ? this[s].insertBefore(u[a], this[s].firstChild) : this[s].appendChild(u[a]);
					else i != t ? this[s].insertBefore(u, this[s].firstChild) : this[s].appendChild(u);
					else e.eval(u.innerHTML)
				}
				return this
			},
			prepend: function(e) {
				return this.append(e, 1)
			},
			insertBefore: function(e, t) {
				if (this.length == 0) return this;
				e = m(e).get(0);
				if (!e || e.length == 0) return this;
				for (var n = 0; n < this.length; n++) t ? e.parentNode.insertBefore(this[n], e.nextSibling) : e.parentNode.insertBefore(this[n], e);
				return this
			},
			insertAfter: function(e) {
				this.insertBefore(e, ! 0)
			},
			get: function(e) {
				return e = e == t ? 0: e,
				e < 0 && (e += this.length),
				this[e] ? this[e] : t
			},
			offset: function() {
				if (this.length === 0) return t;
				var n = this[0].getBoundingClientRect();
				return {
					left: n.left + e.pageXOffset,
					top: n.top + e.pageYOffset,
					width: parseInt(this[0].style.width),
					height: parseInt(this[0].style.height)
				}
			},
			parent: function(e) {
				if (this.length == 0) return t;
				var n = [];
				for (var r = 0; r < this.length; r++) this[r].parentNode && n.push(this[r].parentNode);
				return this.setupOld(m(p(n)).filter(e))
			},
			children: function(e) {
				if (this.length == 0) return this;
				var t = [];
				for (var n = 0; n < this.length; n++) t = t.concat(d(this[n].firstChild));
				return this.setupOld(m(t).filter(e))
			},
			siblings: function(e) {
				if (this.length == 0) return t;
				var n = [];
				for (var r = 0; r < this.length; r++) this[r].parentNode && (n = n.concat(d(this[r].parentNode.firstChild, this[r])));
				return this.setupOld(m(n).filter(e))
			},
			closest: function(e, r) {
				if (this.length == 0) return t;
				var i = [],
				s = this[0],
				o = m(e, r);
				if (o.length == 0) return m();
				while (s && o.indexOf(s) == - 1) s = s !== r && s !== n && s.parentNode;
				return m(s)
			},
			filter: function(e) {
				if (this.length == 0) return t;
				if (e == t) return this;
				var n = [];
				for (var r = 0; r < this.length; r++) {
					var i = this[r];
					i.parentNode && m(e, i.parentNode).indexOf(i) >= 0 && n.push(i)
				}
				return this.setupOld(m(p(n)))
			},
			not: function(e) {
				if (this.length == 0) return m([]);
				var t = [];
				for (var n = 0; n < this.length; n++) {
					var r = this[n];
					r.parentNode && m(e, r.parentNode).indexOf(r) == - 1 && t.push(r)
				}
				return this.setupOld(m(p(t)))
			},
			data: function(e, t) {
				return this.attr("data-" + e, t)
			},
			end: function() {
				return this.oldElement != t ? this.oldElement: m()
			},
			clone: function(e) {
				e = e === ! 1 ? ! 1: ! 0;
				if (this.length == 0) return t;
				var n = [];
				for (var r = 0; r < this.length; r++) n.push(this[r].cloneNode(e));
				return m(n)
			},
			size: function() {
				return this.length
			},
			serialize: function(e) {
				if (this.length == 0) return "";
				var t = {};
				for (var n = 0; n < this.length; n++) this.slice.call(this[n].elements).forEach(function(e) {
					var n = e.getAttribute("type");
					e.nodeName.toLowerCase() != "fieldset" && ! e.disabled && n != "submit" && n != "reset" && n != "button" && (n != "radio" && n != "checkbox" || e.checked) && (t[e.getAttribute("name")] = e.value)
				});
				return m.param(t, e)
			}
		};
		var b = {
			type: "GET",
			beforeSend: y,
			success: y,
			error: y,
			complete: y,
			context: t,
			timeout: 0,
			crossDomain: ! 1
		};
		m.jsonP = function(t) {
			var r = "jsonp_callback" + ++f,
			i = "",
			s, o = n.createElement("script"),
			u = function() {
				m(o).remove(),
				e[r] && (e[r] = y)
			};
			return e[r] = function(n) {
				clearTimeout(i),
				m(o).remove(),
				delete e[r],
				t.success.call(s, n)
			},
			o.src = t.url.replace(/=\?/, "=" + r),
			t.error && (o.onerror = function() {
				clearTimeout(i),
				t.error.call(s, "", "error")
			}),
			m("head").append(o),
			t.timeout > 0 && (i = setTimeout(function() {
				t.error.call(s, "", "timeout")
			},
			t.timeout)),
			{}
		},
		m.ajax = function(t) {
			var n;
			try {
				n = new e.XMLHttpRequest;
				var r = t || {};
				for (var i in b) r[i] || (r[i] = b[i]);
				r.url || (r.url = e.location),
				r.contentType || (r.contentType = "application/x-www-form-urlencoded"),
				r.headers || (r.headers = {});
				if (!r.dataType) r.dataType = "text/html";
				else switch (r.dataType) {
				case "script":
					r.dataType = "text/javascript, application/javascript";
					break;
				case "json":
					r.dataType = "application/json";
					break;
				case "xml":
					r.dataType = "application/xml, text/xml";
					break;
				case "html":
					r.dataType = "text/html";
					break;
				case "text":
					r.dataType = "text/plain";
					break;
				default:
					r.dataType = "text/html";
					break;
				case "jsonp":
					return m.jsonP(t)
				}
				m.isObject(r.data) && (r.data = m.param(r.data)),
				r.type.toLowerCase() === "get" && r.data && (r.url.indexOf("?") === - 1 ? r.url += "?" + r.data: r.url += "&" + r.data);
				if (/=\?/.test(r.url)) return m.jsonP(r);
				r.crossDomain || (r.crossDomain = /^([\w-]+:)?\/\/([^\/]+)/.test(r.url) && RegExp.$2 != e.location.host),
				r.crossDomain || (r.headers = m.extend({
					"X-Requested-With": "XMLHttpRequest"
				},
				r.headers));
				var s, o = r.context,
				u = /^([\w-]+:)\/\//.test(r.url) ? RegExp.$1: e.location.protocol;
				n.onreadystatechange = function() {
					var e = r.dataType;
					if (n.readyState === 4) {
						clearTimeout(s);
						var t, i = ! 1;
						if (n.status >= 200 && n.status < 300 || n.status === 0 && u == "file:") {
							if (e === "application/json" && ! /^\s*$/.test(n.responseText)) try {
								t = JSON.parse(n.responseText)
							} catch(a) {
								i = a
							} else t = n.responseText;
							n.status === 0 && t.length === 0 && (i = ! 0),
							i ? r.error.call(o, n, "parsererror", i) : r.success.call(o, t, "success", n)
						} else i = ! 0,
						r.error.call(o, n, "error");
						r.complete.call(o, n, i ? "error": "success")
					}
				},
				n.open(r.type, r.url, ! 0),
				r.contentType && (r.headers["Content-Type"] = r.contentType);
				for (var a in r.headers) n.setRequestHeader(a, r.headers[a]);
				if (r.beforeSend.call(o, n, r) === ! 1) return n.abort(),
				! 1;
				r.timeout > 0 && (s = setTimeout(function() {
					n.onreadystatechange = y,
					n.abort(),
					r.error.call(o, n, "timeout")
				},
				r.timeout)),
				n.send(r.data)
			} catch(f) {
				console.log(f)
			}
			return n
		},
		m.get = function(e, t) {
			return this.ajax({
				url: e,
				success: t
			})
		},
		m.post = function(e, n, r, i) {
			return typeof n == "function" && (r = n, n = {}),
			i === t && (i = "html"),
			this.ajax({
				url: e,
				type: "POST",
				data: n,
				dataType: i,
				success: r
			})
		},
		m.getJSON = function(e, t, n) {
			return typeof t == "function" && (n = t, t = {}),
			this.ajax({
				url: e,
				data: t,
				success: n,
				dataType: "json"
			})
		},
		m.param = function(e, t) {
			var n = [];
			if (e instanceof v) e.each(function() {
				var e = t ? t + "[]": this.id,
				r = this.value;
				n.push(e + "=" + encodeURIComponent(r))
			});
			else for (var r in e) {
				var i = t ? t + "[" + r + "]": r,
				s = e[r];
				n.push(m.isObject(s) ? m.param(s, i) : i + "=" + encodeURIComponent(s))
			}
			return n.join("&")
		},
		m.parseJSON = function(e) {
			return JSON.parse(e)
		},
		m.parseXML = function(e) {
			return (new DOMParser).parseFromString(e, "text/xml")
		},
		w(m, navigator.userAgent),
		m.__detectUA = w,
		typeof String.prototype.trim != "function" && (String.prototype.trim = function() {
			return this.replace(/(\r\n|\n|\r)/gm, "").replace(/^\s+|\s+$/, ""),
			this
		}),
		m.uuid = function() {
			var e = function() {
				return ((1 + Math.random()) * 65536 | 0).toString(16).substring(1)
			};
			return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e()
		};
		var E = m.qsa,
		S = {},
		x = 1,
		T = {};
		m.event = {
			add: O,
			remove: M
		},
		m.fn.bind = function(e, t) {
			for (var n = 0; n < this.length; n++) O(this[n], e, t);
			return this
		},
		m.fn.unbind = function(e, t) {
			for (var n = 0; n < this.length; n++) M(this[n], e, t);
			return this
		},
		m.fn.one = function(e, t) {
			return this.each(function(n, r) {
				O(this, e, t, null, function(e, t) {
					return function() {
						var n = e.apply(r, arguments);
						return M(r, t, e),
						n
					}
				})
			})
		};
		var _ = function() {
			return ! 0
		},
		D = function() {
			return ! 1
		},
		P = {
			preventDefault: "isDefaultPrevented",
			stopImmediatePropagation: "isImmediatePropagationStopped",
			stopPropagation: "isPropagationStopped"
		};
		return m.fn.delegate = function(e, t, n) {
			for (var r = 0; r < this.length; r++) {
				var i = this[r];
				O(i, t, n, e, function(t) {
					return function(n) {
						var r, s = m(n.target).closest(e, i).get(0);
						if (s) return r = m.extend(H(n), {
							currentTarget: s,
							liveFired: i
						}),
						t.apply(s, [r].concat([].slice.call(arguments, 1)))
					}
				})
			}
			return this
		},
		m.fn.undelegate = function(e, t, n) {
			for (var r = 0; r < this.length; r++) M(this[r], t, n, e);
			return this
		},
		m.fn.on = function(e, n, r) {
			return n === t || m.isFunction(n) ? this.bind(e, n) : this.delegate(n, e, r)
		},
		m.fn.off = function(e, n, r) {
			return n === t || m.isFunction(n) ? this.unbind(e, n) : this.undelegate(n, e, r)
		},
		m.fn.trigger = function(e, t) {
			typeof e == "string" && (e = m.Event(e)),
			e.data = t;
			for (var n = 0; n < this.length; n++) this[n].dispatchEvent(e);
			return this
		},
		m.Event = function(e, t) {
			var r = n.createEvent(T[e] || "Events"),
			i = ! 0;
			if (t) for (var s in t) s == "bubbles" ? i = !! t[s] : r[s] = t[s];
			return r.initEvent(e, i, ! 0, null, null, null, null, null, null, null, null, null, null, null, null),
			r
		},
		m.proxy = function(e, t) {
			var n = function(n) {
				return e.call(t, n)
			};
			return n
		},
		m
	} (window);
	"$" in window || (window.$ = jq),
	window.numOnly || (window.numOnly = function(t) {
		return isNaN(parseFloat(t)) && (t = t.replace(/[^0-9.-]/, "")),
		parseFloat(t)
	})
} (function(e, t) {
	function v(e) {
		return e.toLowerCase()
	}
	function m(e) {
		return f ? f + e: v(e)
	}
	function g(e) {
		return typeof e == "number" ? e: u[e] || u._default
	}
	function y(n, r, i, s, o) {
		typeof r == "function" && ! o && (o = r, r = t);
		var u = {
			opacity: i
		};
		return s && (e.fx.transforms3d ? u.scale3d = s + ",1": u.scale = s, n.css(e.fx.cssPrefix + "transform-origin", "0 0")),
		n.anim(u, g(r) / 1e3, null, o)
	}
	function b(t, n, r, i) {
		return y(t, n, 0, r, function() {
			s.call(e(this)),
			i && i.call(this)
		})
	}
	function w(e) {
		return e.css({
			visibility: "hidden",
			height: ""
		}),
		e.show(),
		e.originHeight = e.height(),
		e.css("visibility", "visible"),
		e.originHeight
	}
	function E() {
		var e, t = n.createElement("div"),
		i = n.createElement("div"),
		s = "@media (-webkit-transform-3d){#zeptotest{left:9px;position:absolute}}",
		o = ["&shy;", "<style>", s, "</style>"].join("");
		return t.innerHTML += o,
		i.id = "zeptotest",
		t.appendChild(i),
		r.appendChild(t),
		e = i.offsetLeft === 9,
		t.parentNode.removeChild(t),
		e
	}
	function S(t, n, r, i) {
		return e.isFunction(n) ? n.call(t, r, i) : n
	}
	function x(t) {
		var n, r = e('<div style="visible:hidden; position:absolute;"></div>');
		return e("body").append(r),
		t.css("visibility", "hidden"),
		t.show(),
		n = t[0].getBoundingClientRect(),
		t.hide(),
		t.css("visibility", "visible"),
		r.remove(),
		{
			height: n.height,
			width: n.width
		}
	}
	function N(e) {
		var t, r;
		return T[e] || (t = n.createElement(e), n.body.appendChild(t), r = getComputedStyle(t, "").getPropertyValue("display"), t.parentNode.removeChild(t), r == "none" && (r = "block"), T[e] = r),
		T[e]
	}
	function C(n, r) {
		return r === t ? e(n) : e(n).filter(r)
	}
	function k(e) {
		return typeof e.length == "number"
	}
	function L(e) {
		return e.length > 0 ? [].concat.apply([], e) : e
	}
	var n = window.document,
	r = n.documentElement,
	i = e.fn.show,
	s = e.fn.hide,
	o = e.fn.toggle,
	u = {
		_default: 400,
		fast: 200,
		slow: 600
	},
	a = "",
	f,
	l,
	c,
	h = {
		Webkit: "webkit",
		Moz: "",
		O: "o",
		ms: "MS"
	},
	n = window.document,
	p = n.createElement("div"),
	d = /^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;
	e.each(h, function(e, n) {
		if (p.style[e + "TransitionProperty"] !== t) return a = "-" + v(e) + "-",
		f = n,
		! 1
	}),
	e.fx = {
		off: f === t && p.style.transitionProperty === t,
		cssPrefix: a,
		transitionEnd: m("TransitionEnd"),
		animationEnd: m("AnimationEnd")
	},
	e.fn.animate = function(t, n, r, i) {
		return e.isObject(n) && (r = n.easing, i = n.complete, n = n.duration),
		n && (n /= 1e3),
		this.anim(t, n, r, i)
	},
	e.fn.anim = function(n, r, i, s) {
		var o, u = {},
		f, l = this,
		c, h = e.fx.transitionEnd;
		r === t && (r = .4),
		e.fx.off && (r = 0);
		if (typeof n == "string") u[a + "animation-name"] = n,
		u[a + "animation-duration"] = r + "s",
		h = e.fx.animationEnd;
		else {
			for (f in n) d.test(f) ? (o || (o = []), o.push(f + "(" + n[f] + ")")) : u[f] = n[f];
			o && (u[a + "transform"] = o.join(" ")),
			e.fx.off || (u[a + "transition"] = "all " + r + "s " + (i || ""))
		}
		return c = function() {
			var t = {};
			t[a + "transition"] = t[a + "animation-name"] = "none",
			e(this).css(t),
			s && s.call(this)
		},
		r > 0 && this.one(h, c),
		setTimeout(function() {
			l.css(u),
			r <= 0 && setTimeout(function() {
				l.each(function() {
					c.call(this)
				})
			},
			0)
		},
		0),
		this
	},
	p = null,
	e.fn.slideDown = function(e) {
		var t = w(this),
		n = this;
		this.css({
			opacity: "1",
			height: 0,
			overflow: "hidden",
			visibility: "visible"
		}).show(),
		this.animate({
			height: t + "px"
		},
		200, "ease", function() {
			n.css("overflow", ""),
			n.show(),
			e && e()
		})
	},
	e.fn.slideUp = function(e) {
		var t = this;
		this.css({
			opacity: "1",
			height: w(this) + "px",
			overflow: "hidden",
			visibility: "visible"
		}).show(),
		this.animate({
			height: "0px",
			opacity: 0
		},
		200, "ease", function() {
			t.css("overflow", ""),
			t.css("visibility", "hidden"),
			setTimeout(function() {
				t.hide(),
				t.css("opacity", "1")
			},
			0),
			e && e()
		})
	},
	e.fn.toggle = function(e, n) {
		return e === t || typeof e == "boolean" ? o.call(this, e) : this[this.css("display") == "none" ? "show": "hide"](e, n)
	},
	e.fn.fadeTo = function(e, t, n) {
		return y(this, e, t, null, n)
	},
	e.fn.fadeIn = function(e, t) {
		var n = this.css("opacity");
		return n > 0 ? this.css("opacity", 0) : n = 1,
		i.call(this).fadeTo(e, n, t)
	},
	e.fn.fadeOut = function(e, t) {
		return b(this, e, null, t)
	},
	e.fn.fadeToggle = function(e) {
		var t = this.css("opacity") == 0 || this.css("display") == "none";
		return this[t ? "fadeIn": "fadeOut"](e)
	},
	e.extend(e.fx, {
		speeds: u,
		transforms3d: function(n) {
			var i = ! 1;
			return e.each(n, function(e, n) {
				if (r.style[n] !== t) return i = e != 1 || E(),
				! 1
			}),
			i
		} ("perspectiveProperty WebkitPerspective MozPerspective OPerspective msPerspective".split(" "))
	}),
	e.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "), function(t, n) {
		e.fn[n] = function(e, t) {
			return t == null && (t = e, e = null),
			arguments.length > 0 ? this.bind(n, t) : this.trigger(n)
		}
	}),
	e.isEmptyObject = function(e) {
		for (var t in e) return ! 1;
		return ! 0
	},
	e(["width", "height"]).each(function(r, i) {
		e.fn[i] = function(r) {
			var s, o = i.replace(/./, function(e) {
				return e[0].toUpperCase()
			});
			return r === t ? this[0] == window ? window["inner" + o] : this[0] == n ? n.documentElement["offset" + o] : this.getComputedStyle("display") != "none" ? (s = this.offset()) && s[i] : x(this)[i] : this.each(function(t) {
				var n = e(this);
				n.css(i, S(this, r, t, n[i]()))
			})
		}
	}),
	e.fn.offset = function() {
		if (this.length == 0) return null;
		var e = this[0].getBoundingClientRect();
		return {
			left: e.left + window.pageXOffset,
			top: e.top + window.pageYOffset,
			width: e.width,
			height: e.height
		}
	},
	e.fn.scrollTop = function(e) {
		if (!e) return n.body.scrollTop;
		n.body.scrollTop = e
	},
	e.fn.eq = function(e) {
		return e === - 1 ? this.slice(e) : this.slice(e, + e + 1)
	},
	e.fn.slice = function() {
		return e([].slice.apply(this, arguments))
	},
	e.fn.replaceWith = function(t) {
		return this.each(function() {
			e(t).insertBefore(e(this)),
			e(this).remove()
		})
	},
	e.fn.contents = function() {
		var t = [],
		n = this[0].childNodes;
		for (var r = 0; r < n.length; r++) t.push(n[r]);
		return e(t)
	},
	e.fn.text = function(e) {
		if (this.length === 0) return t;
		if (e === t) return this[0].textContent;
		for (var n = 0; n < this.length; n++) this[n].textContent = e;
		return this
	},
	e.trim = function(e) {
		return String.prototype.trim.call(e)
	};
	var T = {};
	e.fn.show = function() {
		return this.each(function() {
			this.style.display == "none" && (this.style.display = null),
			getComputedStyle(this, "").getPropertyValue("display") == "none" && (this.style.display = N(this.nodeName))
		})
	},
	e.fn.getComputedStyle = function(e) {
		return n.defaultView.getComputedStyle(this[0])[e]
	},
	e.fn.parents = function(t) {
		var r = [],
		i = this;
		while (i.length > 0) i = e.map(i, function(e) {
			if ((e = e.parentNode) && e !== n && r.indexOf(e) < 0) return r.push(e),
			e
		});
		return C(r, t)
	},
	e.map = function(e, t) {
		var n, r = [],
		i,
		s;
		if (k(e)) for (i = 0; i < e.length; i++) n = t(e[i], i),
		n != null && r.push(n);
		else for (s in e) n = t(e[s], s),
		n != null && r.push(n);
		return L(r)
	},
	e.scrollToElem = function(t) {
		t = e(t),
		t.length != 0 && (n.body.scrollTop = t.offset().top)
	}
})(jq);
if ("undefined" == typeof T5Kit) {
	var T5Kit = {
		commandQueue: [],
		commandQueueFlushing: ! 1,
		resources: {
			base: ! 0
		}
	};
	T5Kit.hasResource = function(e) {
		return T5Kit.resources[e]
	},
	T5Kit.addResource = function(e) {
		T5Kit.resources[e] = ! 0
	},
	T5Kit.Channel = function(e) {
		this.type = e,
		this.handlers = {},
		this.guid = 0,
		this.fired = ! 1,
		this.enabled = ! 0
	},
	T5Kit.Channel.prototype.subscribe = function(e, t, n) {
		if (null !== e) {
			var r = e;
			return "object" == typeof t && "function" == typeof e && (r = T5Kit.close(t, e)),
			n = n || r.observer_guid || e.observer_guid || this.guid++,
			r.observer_guid = n,
			e.observer_guid = n,
			this.handlers[n] = r,
			n
		}
	},
	T5Kit.Channel.prototype.subscribeOnce = function(e, t) {
		var n = null,
		r = this,
		i = function() {
			e.apply(t || null, arguments),
			r.unsubscribe(n)
		};
		return this.fired ? ("object" == typeof t && "function" == typeof e && (e = T5Kit.close(t, e)), e.apply(this, this.fireArgs)) : n = this.subscribe(i),
		n
	},
	T5Kit.Channel.prototype.unsubscribe = function(e) {
		"function" == typeof e && (e = e.observer_guid),
		this.handlers[e] = null,
		delete this.handlers[e]
	},
	T5Kit.Channel.prototype.fire = function(e) {
		if (this.enabled) {
			var t = ! 1,
			n, r;
			for (n in this.handlers) this.handlers.hasOwnProperty(n) && (r = this.handlers[n], "function" == typeof r && (r = ! 1 === r.apply(this, arguments), t = t || r));
			return this.fired = ! 0,
			this.fireArgs = arguments,
			! t
		}
		return ! 0
	},
	T5Kit.addConstructor = function(e) {
		T5Kit.onT5KitInit.subscribeOnce(function() {
			try {
				e()
			} catch(t) {
				console.log("Failed to run constructor: " + t)
			}
		})
	},
	T5Kit.onT5KitInit = new T5Kit.Channel("onT5KitInit"),
	T5Kit.stringify = function(e) {
		if ("undefined" == typeof JSON) {
			var t = "[",
			n, r, i;
			for (n = 0; n < e.length; n++) if (null !== e[n]) if (0 < n && (t += ","), r = typeof e[n], "number" === r || "boolean" === r) t += e[n];
			else if (e[n] instanceof Array) t = t + "[" + e[n] + "]";
			else if (e[n] instanceof Object) {
				r = ! 0,
				t += "{";
				for (i in e[n]) null !== e[n][i] && (r || (t += ","), t = t + '"' + i + '":', r = typeof e[n][i], t = "number" === r || "boolean" === r ? t + e[n][i] : "function" == typeof e[n][i] ? t + '""': e[n][i] instanceof Object ? t + T5Kit.stringify(e[n][i]) : t + '"' + e[n][i] + '"', r = ! 1);
				t += "}"
			} else r = e[n].replace(/\\/g, "\\\\"),
			r = r.replace(/"/g, '\\"'),
			t = t + '"' + r + '"';
			return t + "]"
		}
		return JSON.stringify(e)
	},
	T5Kit.clone = function(e) {
		var t, n;
		if (!e) return e;
		if (e instanceof Array) {
			n = [];
			for (t = 0; t < e.length; ++t) n.push(T5Kit.clone(e[t]));
			return n
		}
		if ("function" == typeof e || ! (e instanceof Object) || e instanceof Date) return e;
		n = {};
		for (t in e) if (! (t in n) || n[t] !== e[t]) n[t] = T5Kit.clone(e[t]);
		return n
	},
	T5Kit.close = function(e, t, n) {
		return "undefined" == typeof n ? function() {
			return t.apply(e, arguments)
		}: function() {
			return t.apply(e, n)
		}
	},
	T5Kit.includeJavascript = function(e, t) {
		var n = document.getElementsByTagName("head")[0],
		r = document.createElement("script");
		r.type = "text/javascript",
		"function" == typeof t && (r.onload = t),
		r.src = e,
		n.appendChild(r)
	},
	T5Kit.createUUID = function() {
		return T5Kit.UUIDcreatePart(4) + "-" + T5Kit.UUIDcreatePart(2) + "-" + T5Kit.UUIDcreatePart(2) + "-" + T5Kit.UUIDcreatePart(2) + "-" + T5Kit.UUIDcreatePart(6)
	},
	T5Kit.UUIDcreatePart = function(e) {
		var t = "",
		n, r;
		for (n = 0; n < e; n++) r = parseInt(256 * Math.random(), 0).toString(16),
		1 === r.length && (r = "0" + r),
		t += r;
		return t
	},
	T5Kit.callbackId = 0,
	T5Kit.callbacks = {},
	T5Kit.callbackStatus = {
		NO_RESULT: 0,
		OK: 1,
		CLASS_NOT_FOUND_EXCEPTION: 2,
		ILLEGAL_ACCESS_EXCEPTION: 3,
		INSTANTIATION_EXCEPTION: 4,
		MALFORMED_URL_EXCEPTION: 5,
		IO_EXCEPTION: 6,
		INVALID_ACTION: 7,
		JSON_EXCEPTION: 8,
		ERROR: 9
	},
	T5Kit.createMttT5Kit = function() {
		return mttT5Kit = document.createElement("iframe"),
		mttT5Kit.setAttribute("style", "display:none;"),
		mttT5Kit.setAttribute("height", "0px"),
		mttT5Kit.setAttribute("width", "0px"),
		mttT5Kit.setAttribute("frameborder", "0"),
		document.documentElement.appendChild(mttT5Kit),
		mttT5Kit
	},
	T5Kit.exec = function(e, t, n, r, i) {
		var s = null,
		o = {
			className: n,
			methodName: r,
			options: {},
			arguments: []
		};
		if (e || t) s = n + T5Kit.callbackId++,
		T5Kit.callbacks[s] = {
			success: e,
			fail: t
		};
		null != s && o.arguments.push(s);
		for (e = 0; e < i.length; ++e) if (t = i[e], void 0 != t && null != t)"object" == typeof t ? o.options = t: o.arguments.push(t);
		T5Kit.commandQueue.push(T5Kit.stringify(o)),
		1 == T5Kit.commandQueue.length && ! T5Kit.commandQueueFlushing && (T5Kit.mttT5Kit || (T5Kit.mttT5Kit = T5Kit.createMttT5Kit()), T5Kit.mttT5Kit.src = "mtt:" + n + ":" + r)
	},
	T5Kit.getAndClearQueuedCommands = function() {
		return json = JSON.stringify(T5Kit.commandQueue),
		T5Kit.commandQueue = [],
		json
	},
	T5Kit.callbackSuccess = function(e, t) {
		if (T5Kit.callbacks[e]) {
			if (t.status === T5Kit.callbackStatus.OK) try {
				T5Kit.callbacks[e].success && T5Kit.callbacks[e].success(t.message)
			} catch(n) {
				alert("callbacks4 | " + n),
				console.log("Error in success callback: " + e + " = " + n)
			}
			t.keepCallback || delete T5Kit.callbacks[e]
		}
	},
	T5Kit.callbackError = function(e, t) {
		if (T5Kit.callbacks[e]) {
			try {
				T5Kit.callbacks[e].fail && T5Kit.callbacks[e].fail(t.message)
			} catch(n) {
				console.log("Error in error callback: " + e + " = " + n)
			}
			t.keepCallback || delete T5Kit.callbacks[e]
		}
	}
}
if (!T5Kit.hasResource("user")) {
	T5Kit.addResource("user");
	var User = function() {};
	User.prototype.setUserInfo = function(e, t, n) {
		"function" != typeof e ? console.log("User::setUserInfo Error: successCallback is not a function") : "function" != typeof t ? console.log("User::setUserInfo Error: errorCallback is not a function") : T5Kit.exec(e, t, "login", "setUinAndSidInfo", [n])
	},
	User.prototype.getUserInfo = function(e, t) {
		"function" != typeof e ? console.log("User::getUserInfo Error: successCallback is not a function") : "function" != typeof t ? console.log("User::getUserInfo Error: errorCallback is not a function") : T5Kit.exec(e, t, "login", "getUinAndSidInfo", [])
	},
	User.prototype.setQCookie = function(e, t, n) {
		if (typeof e != "function") {
			console.log("User::setQCookie Error: successCallback is not a function");
			return
		}
		if (typeof t != "function") {
			console.log("User::setQCookie Error: errorCallback is not a function");
			return
		}
		T5Kit.exec(e, t, "login", "setQCookie", [n])
	},
	User.prototype.getQCookie = function(e, t) {
		"function" != typeof e ? console.log("User::getQCookie Error: successCallback is not a function") : "function" != typeof t ? console.log("User::getQCookie Error: errorCallback is not a function") : T5Kit.exec(e, t, "login", "getQCookie", [])
	},
	T5Kit.addConstructor(function() {
		"undefined" == typeof T5Kit.user && (T5Kit.user = new User)
	})
}
T5Kit.onT5KitInit.fire(),
util = {
	strToObj: function(e, t) {
		var n = [],
		r = {},
		i,
		s,
		o;
		n = e.split("&"),
		o = n.length;
		for (i = 0; i < o; i++) {
			if (n[i].indexOf("=") < 0) continue;
			s = n[i].split("="),
			r[s[0]] = t ? decodeURIComponent(s[1]) : s[1]
		}
		return r
	},
	objToStr: function(e, t) {
		var n = "",
		r, i;
		for (r in e) {
			if (typeof e[r] == "undefined") continue;
			i = t ? encodeURIComponent(e[r]) : e[r],
			n += r + "=" + i + "&"
		}
		return n.slice(0, n.length - 1)
	},
	getUrlParams: function(e) {
		var t = location.search.substr(1, location.search.length),
		n = util.strToObj(decodeURIComponent(t));
		return e ? n[e] : n
	},
	getHashParams: function(e) {
		var t = e ? e: decodeURIComponent(location.hash),
		n = [],
		r = {};
		return t.replace(/[\.\?'"><:;,\[\]\{\}]/ig, ""),
		n = t.split("/"),
		n.length > 0 && (r.pageId = n.splice(0, 1)[0].substring(1), r.urlParams = n.length > 0 ? util.strToObj(n.join("/"), ! 0) : {}),
		r
	},
	pushHashParams: function(e) {
		location.hash = util.objToHash(e)
	},
	objToHash: function(e) {
		var t = e.pageId,
		n = util.objToStr(e.urlParams, ! 0);
		return n.length > 0 ? t + "/" + n: t
	},
	isArray: function(e) {
		return Object.prototype.toString.call(e) == "[object Array]"
	},
	isObject: function(e) {
		return Object.prototype.toString.call(e) == "[object Object]"
	},
	jsonStringfy: function(e) {
		return "JSON" in window ? JSON.stringify(e) : function(e) {
			var t;
			if (util.isArray(e)) {
				t = "[";
				for (var n = 0; n < e.length; n++) util.isObject(e[n]) || util.isArray(e[n]) ? t += util.jsonStringfy(e[n]) + ",": t += e[n] + ",";
				t = t.substring(0, t.length - 1),
				t += "]"
			} else if (util.isObject(e)) {
				t = "{";
				for (var r in e) util.isObject(e[r]) || util.isArray(e[r]) ? t += r + ":" + util.jsonStringfy(e[r]) + ",": t += r + ":" + e[r] + ",";
				t = t.substring(0, t.length - 1),
				t += "}"
			} else t = "";
			return t
		}
	},
	parseJSON: function(e) {
		var t;
		try {
			t = $.parseJSON(e)
		} catch(n) {
			t = e
		}
		return t
	},
	reverseString: function(e) {
		return typeof e == "string" ? e.split("").reverse().join("") : e
	},
	numNotation: function(e) {
		var t = typeof e != "string" ? e.toString() : e,
		n,
		r,
		i,
		s = [];
		t = util.reverseString(t),
		r = t.length,
		i = Math.ceil(r / 3);
		for (var o = 0; o < i; o++) s.push(t.substr(o * 3, 3));
		return n = s.join(","),
		n = util.reverseString(n),
		n
	},
	getByteLength: function(e) {
		var t = e.length,
		n = 0;
		for (var r = 0; r < t; r++) e.charCodeAt(r) > 0 && e.charCodeAt(r) <= 128 ? n++ : n += 2;
		return n
	},
	getByteStr: function(e, t) {
		var n = 0;
		for (var r = 0; r < e.length; r++) {
			e.charCodeAt(r) > 128 ? n += 2: n++;
			if (n > t) return e.substr(0, r)
		}
		return e
	},
	scriptLoader: function(e, t) {
		var n = document.getElementsByTagName("head")[0] || document.documentElement,
		r = document.createElement("script");
		r.src = e,
		r.onload = r.onerror = function() {
			if (!this.readyState || this.readyState === "loaded" || this.readyState === "complete") n && r.parentNode && n.removeChild(r),
			t()
		},
		n.insertBefore(r, n.firstChild)
	}
},
function() {
	var rsplit = function(e, t) {
		var n = t.exec(e),
		r = new Array,
		i,
		s,
		o;
		while (n != null) i = n.index,
		s = t.lastIndex,
		i != 0 && (o = e.substring(0, i), r.push(e.substring(0, i)), e = e.slice(i)),
		r.push(n[0]),
		e = e.slice(n[0].length),
		n = t.exec(e);
		return ! e == "" && r.push(e),
		r
	},
	chop = function(e) {
		return e.substr(0, e.length - 1)
	},
	extend = function(e, t) {
		for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n])
	};
	EJS = function(e) {
		e = typeof e == "string" ? {
			view: e
		}: e,
		this.set_options(e);
		if (e.precompiled) {
			this.template = {},
			this.template.process = e.precompiled,
			EJS.update(this.name, this);
			return
		}
		if (e.element) {
			if (typeof e.element == "string") {
				var t = e.element;
				e.element = document.getElementById(e.element);
				if (e.element == null) throw t + "does not exist!"
			}
			e.element.value ? this.text = e.element.value: this.text = e.element.innerHTML,
			this.name = e.element.id,
			this.type = e.type || "["
		} else if (e.url) {
			e.url = EJS.endExt(e.url, this.extMatch),
			this.name = this.name ? this.name: e.url;
			var n = e.url,
			r = EJS.get(this.name, this.cache);
			if (r) return r;
			if (r == EJS.INVALID_PATH) return null;
			try {
				this.text = EJS.request(n + (this.cache ? "": "?" + Math.random()))
			} catch(i) {}
			if (this.text == null) throw {
				type: "EJS",
				message: "There is no template at " + n
			}
		}
		var r = new EJS.Compiler(this.text, this.type);
		r.compile(e, this.name),
		EJS.update(this.name, this),
		this.template = r
	},
	EJS.prototype = {
		render: function(e, t) {
			e = e || {},
			this._extra_helpers = t;
			var n = new EJS.Helpers(e, t || {}),
			r;
			try {
				r = this.template.process.call(e, e, n)
			} catch(i) {
				console.error(i),
				r = ""
			} finally {
				return r
			}
		},
		update: function(element, options) {
			typeof element == "string" && (element = document.getElementById(element));
			if (options == null) return _template = this,
			function(e) {
				EJS.prototype.update.call(_template, element, e)
			};
			typeof options == "string" ? (params = {},
			params.url = options, _template = this, params.onComplete = function(request) {
				var object = eval(request.responseText);
				EJS.prototype.update.call(_template, element, object)
			},
			EJS.ajax_request(params)) : element.innerHTML = this.render(options)
		},
		out: function() {
			return this.template.out
		},
		set_options: function(e) {
			this.type = e.type || EJS.type,
			this.cache = e.cache != null ? e.cache: EJS.cache,
			this.text = e.text || null,
			this.name = e.name || null,
			this.ext = e.ext || EJS.ext,
			this.extMatch = new RegExp(this.ext.replace(/\./, "."))
		}
	},
	EJS.endExt = function(e, t) {
		return e ? (t.lastIndex = 0, e + (t.test(e) ? "": this.ext)) : null
	},
	EJS.Scanner = function(e, t, n) {
		extend(this, {
			left_delimiter: t + "%",
			right_delimiter: "%" + n,
			double_left: t + "%%",
			double_right: "%%" + n,
			left_equal: t + "%=",
			left_comment: t + "%#"
		}),
		this.SplitRegexp = t == "[" ? /(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/: new RegExp("(" + this.double_left + ")|(%%" + this.double_right + ")|(" + this.left_equal + ")|(" + this.left_comment + ")|(" + this.left_delimiter + ")|(" + this.right_delimiter + "\n)|(" + this.right_delimiter + ")|(\n)"),
		this.source = e,
		this.stag = null,
		this.lines = 0
	},
	EJS.Scanner.to_text = function(e) {
		return e == null || e === undefined ? "": e instanceof Date ? e.toDateString() : e.toString ? e.toString() : ""
	},
	EJS.Scanner.prototype = {
		scan: function(e) {
			scanline = this.scanline,
			regex = this.SplitRegexp;
			if (!this.source == "") {
				var t = rsplit(this.source, /\n/);
				for (var n = 0; n < t.length; n++) {
					var r = t[n];
					this.scanline(r, regex, e)
				}
			}
		},
		scanline: function(e, t, n) {
			this.lines++;
			var r = rsplit(e, t);
			for (var i = 0; i < r.length; i++) {
				var s = r[i];
				if (s != null) try {
					n(s, this)
				} catch(o) {
					throw {
						type: "EJS.Scanner",
						line: this.lines
					}
				}
			}
		}
	},
	EJS.Buffer = function(e, t) {
		this.line = new Array,
		this.script = "",
		this.pre_cmd = e,
		this.post_cmd = t;
		for (var n = 0; n < this.pre_cmd.length; n++) this.push(e[n])
	},
	EJS.Buffer.prototype = {
		push: function(e) {
			this.line.push(e)
		},
		cr: function() {
			this.script = this.script + this.line.join("; "),
			this.line = new Array,
			this.script = this.script + "\n"
		},
		close: function() {
			if (this.line.length > 0) {
				for (var e = 0; e < this.post_cmd.length; e++) this.push(pre_cmd[e]);
				this.script = this.script + this.line.join("; "),
				line = null
			}
		}
	},
	EJS.Compiler = function(e, t) {
		this.pre_cmd = ["var ___ViewO = [];"],
		this.post_cmd = new Array,
		this.source = " ",
		e != null && (typeof e == "string" ? (e = e.replace(/\r\n/g, "\n"), e = e.replace(/\r/g, "\n"), this.source = e) : e.innerHTML && (this.source = e.innerHTML), typeof this.source != "string" && (this.source = "")),
		t = t || "<";
		var n = ">";
		switch (t) {
		case "[":
			n = "]";
			break;
		case "<":
			break;
		default:
			throw t + " is not a supported deliminator"
		}
		this.scanner = new EJS.Scanner(this.source, t, n),
		this.out = ""
	},
	EJS.Compiler.prototype = {
		compile: function(options, name) {
			options = options || {},
			this.out = "";
			var put_cmd = "___ViewO.push(",
			insert_cmd = put_cmd,
			buff = new EJS.Buffer(this.pre_cmd, this.post_cmd),
			content = "",
			clean = function(e) {
				return e = e.replace(/\\/g, "\\\\"),
				e = e.replace(/\n/g, "\\n"),
				e = e.replace(/"/g, '\\"'),
				e
			};
			this.scanner.scan(function(e, t) {
				if (t.stag == null) switch (e) {
				case "\n":
					content += "\n",
					buff.push(put_cmd + '"' + clean(content) + '");'),
					buff.cr(),
					content = "";
					break;
				case t.left_delimiter:
				case t.left_equal:
				case t.left_comment:
					t.stag = e,
					content.length > 0 && buff.push(put_cmd + '"' + clean(content) + '")'),
					content = "";
					break;
				case t.double_left:
					content += t.left_delimiter;
					break;
				default:
					content += e
				} else switch (e) {
				case t.right_delimiter:
					switch (t.stag) {
					case t.left_delimiter:
						content[content.length - 1] == "\n" ? (content = chop(content), buff.push(content), buff.cr()) : buff.push(content);
						break;
					case t.left_equal:
						buff.push(insert_cmd + "(EJS.Scanner.to_text(" + content + ")))")
					}
					t.stag = null,
					content = "";
					break;
				case t.double_right:
					content += t.right_delimiter;
					break;
				default:
					content += e
				}
			}),
			content.length > 0 && buff.push(put_cmd + '"' + clean(content) + '")'),
			buff.close(),
			this.out = buff.script + ";";
			var to_be_evaled = "/*" + name + "*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {" + this.out + " return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};";
			try {
				eval(to_be_evaled)
			} catch(e) {
				if (typeof JSLINT == "undefined") throw e;
				JSLINT(this.out);
				for (var i = 0; i < JSLINT.errors.length; i++) {
					var error = JSLINT.errors[i];
					if (error.reason != "Unnecessary semicolon.") {
						error.line++;
						var e = new Error;
						throw e.lineNumber = error.line,
						e.message = error.reason,
						options.view && (e.fileName = options.view),
						e
					}
				}
			}
		}
	},
	EJS.config = function(e) {
		EJS.cache = e.cache != null ? e.cache: EJS.cache,
		EJS.type = e.type != null ? e.type: EJS.type,
		EJS.ext = e.ext != null ? e.ext: EJS.ext;
		var t = EJS.templates_directory || {};
		EJS.templates_directory = t,
		EJS.get = function(e, n) {
			return n == 0 ? null: t[e] ? t[e] : null
		},
		EJS.update = function(e, n) {
			if (e == null) return;
			t[e] = n
		},
		EJS.INVALID_PATH = - 1
	},
	EJS.config({
		cache: ! 0,
		type: "<",
		ext: ".ejs"
	}),
	EJS.Helpers = function(e, t) {
		this._data = e,
		this._extras = t,
		extend(this, t)
	},
	EJS.Helpers.prototype = {
		view: function(e, t, n) {
			return n || (n = this._extras),
			t || (t = this._data),
			(new EJS(e)).render(t, n)
		},
		to_text: function(e, t) {
			return e == null || e === undefined ? t || "": e instanceof Date ? e.toDateString() : e.toString ? e.toString().replace(/\n/g, "<br />").replace(/''/g, "'") : ""
		}
	},
	EJS.newRequest = function() {
		var e = [function() {
			return new ActiveXObject("Msxml2.XMLHTTP")
		},
		function() {
			return new XMLHttpRequest
		},
		function() {
			return new ActiveXObject("Microsoft.XMLHTTP")
		}];
		for (var t = 0; t < e.length; t++) try {
			var n = e[t]();
			if (n != null) return n
		} catch(r) {
			continue
		}
	},
	EJS.request = function(e) {
		var t = new EJS.newRequest;
		t.open("GET", e, ! 1);
		try {
			t.send(null)
		} catch(n) {
			return null
		}
		return t.status == 404 || t.status == 2 || t.status == 0 && t.responseText == "" ? null: t.responseText
	},
	EJS.ajax_request = function(e) {
		e.method = e.method ? e.method: "GET";
		var t = new EJS.newRequest;
		t.onreadystatechange = function() {
			t.readyState == 4 && (t.status == 200 ? e.onComplete(t) : e.onComplete(t))
		},
		t.open(e.method, e.url),
		t.send(null)
	}
} ();
var cookieObj = new CookieObj,
global = {},
localStorageObj = new LocalStorageObj;
Canvas.g_loadings = [],
Canvas.prototype.rotation = 0,
Canvas.prototype.draw = function() {
	var e = this.height,
	t = this.ctx,
	n = e / 10,
	r = e / 5,
	i = - Math.PI * 2 / 8;
	t.save(),
	t.clearRect(0, 0, e, e),
	t.translate(e / 2, e / 2);
	for (var s = 0; s < 8; s++) t.save(),
	t.rotate(s * i),
	t.fillStyle = "rgba(" + this.color[0] + "," + this.color[1] + "," + this.color[2] + "," + (8 - (s + this.rotation) % 8) / 8 + ")",
	t.fillRect( - n / 2, r, n, r),
	t.restore();
	t.restore(),
	this.rotation++,
	this.rotation %= 8
},
Canvas.initCanvas = function(e, t, n) {
	if (e && (!e.firstChild || e.firstChild && e.firstChild._id != "sp")) {
		var r = new Canvas(t, n);
		r.obj._id = "sp",
		Canvas.g_loadings.push(r),
		e.insertBefore(r.obj, e.firstChild),
		r.running || (r.running = window.setInterval(function() {
			r.draw()
		},
		125), r.draw())
	}
},
Canvas.removeCanvas = function(e) {
	e.removeAttribute("selected");
	if (e && e.firstChild && e.firstChild._id == "sp") for (var t = Canvas.g_loadings.length; --t >= 0;) {
		var n = Canvas.g_loadings[t];
		if (n.obj == e.firstChild) return e.removeChild(e.firstChild),
		window.clearInterval(n.running),
		n.running = null,
		Canvas.g_loadings.splice(t, 1),
		1
	}
	return 0
},
Canvas.loading = function(e, t, n) {
	return
},
Canvas.unloading = function(e) {
	return ! 1;
	var t, n
};
var g_mst = {
	SEARCH_USER_FOLLOWER: 51,
	SEARCH_USER_FOLLOW: 52,
	CLOSE_FRIEND: 50,
	MAYBE_KNOW: 49,
	DETAIL_ALL_MSG: 66,
	DETAIL_FWD_MSG: 64,
	HOME_MSG: 0,
	IPOST_MSG: 1,
	IMETION_MSG: 2,
	DIRECT_IN_MSG: 3,
	DIRECT_OUT_MSG: 4,
	RANDOM_MSG: 5,
	ORIGINAL_MSG: 6,
	FORWARD_MSG: 7,
	REPLY_MSG: 8,
	KEPT_MSG: 9,
	TIMELINE_MSG: 10,
	SPECIAL_MSG: 11,
	TIMELINE_ORIGINAL_MSG: 12,
	IMETION_MSG_FOLLOWING: 13,
	IMENTION_MSG_STAR: 15,
	WITH_IMAGE_MSG: 14,
	USER_TIMELINE: 16,
	COMMENT_MSG: 17,
	TIMELINE_WITH_IMAGE_MSG: 18,
	BIDIRECTION_FOLLOWS: 19,
	USER_FOLLOWER: 20,
	USER_FOLLOWING: 21,
	USER_SPECIAL_FOLLOWING: 22,
	USER_FOLLOWING_CONF: 23,
	HOST_FOLLOWING: 24,
	HOST_SPECIAL_FOLLOWING: 25,
	TOPIC_LIST: 30,
	SEARCH_TOPIC_LIST: 31,
	SEARCH_USER_LIST: 32,
	SEARCH_MSG_LIST: 33,
	RANDOM_MSG_LIST: 34,
	HOT_USER_LIST: 35,
	HOT_MSG_LIST: 36,
	HOT_TOPIC_LIST: 37,
	FAMOUS_USER_LIST: 38,
	FWD_MESSAGE_LIST: 39,
	BLACK_USER_LIST: 40,
	SEARCH_TOPIC_JX_LIST: 41,
	SEARCH_TOPIC_ALL_LIST: 42,
	TOPIC_LIST_MYFOLLOW: 55,
	TOPIC_LIST_GOOD: 41,
	TOPIC_LIST_ALL: 42,
	NEARBY_USER_LIST: 43,
	NEARBY_MSG_LIST: 44,
	KEYWORD_LIST: 45,
	DIALOGHISTORY: 46,
	PRIVATEMSGHOME: 47,
	CHANNEL: 53,
	CHANNEL_DETAIL: 54,
	FAMOUS_SAY: 56,
	FAMOUS_INDEX: 57,
	RECOMMEND_FAMOUS: 58,
	JOINTFOLLOW: 60,
	APPLIST: 61,
	QQ_FRIENDS_MSG: 99,
	LIST_MSG: 100,
	APPOPENID: 62,
	TOPIC_DETAIL_ALL: 67,
	TOPIC_DETAIL_NEW: 68,
	TOPIC_DETAIL_IMAGE: 69,
	TOPIC_DETAIL_DEFINE: 70
},
g_ac = {
	AC_SINGLEMSG: 213,
	AC_CLOSEFRIEND: 225,
	AC_HOT_INDEX: 232,
	AC_RECOMMENDUSER: 217,
	AC_NO_ACTION: 0,
	AC_USER_FOLLOW: 11,
	AC_USER_UNFOLLOW: 12,
	AC_USER_SEARCH: 13,
	AC_USER_UPDATE: 14,
	AC_MSG_AT: 50,
	AC_MSG_POST: 51,
	AC_MSG_DEL: 52,
	AC_MSG_REPLY: 53,
	AC_MSG_FORWARD: 54,
	AC_MSG_DIRECT: 55,
	AC_MSG_DIRECT_REPLY: 56,
	AC_MSG_DIRECT_MANUAL: 57,
	AC_MSG_KEEP: 58,
	AC_MSG_DROP: 59,
	AC_MSG_SEARCH: 60,
	AC_MSG_COMMENT: 61,
	AC_TOPIC_SEARCH: 81,
	AC_TOPIC_KEEP: 82,
	AC_TOPIC_DROP: 83,
	AC_KEYWORD_KEEP: 84,
	AC_KEYWORD_DROP: 85,
	AC_FEEDBACK: 99,
	AC_LOGOUT: 100,
	AC_MORE_HOME_MSG: 101,
	AC_NEW_DATA: 102,
	AC_FOLLOWER_LIST: 103,
	AC_FOLLOWING_LIST: 104,
	AC_HOME_DATA: 105,
	AC_MORE_MSG: 106,
	AC_INBOX: 107,
	AC_OUTBOX: 108,
	AC_GET_MORE_ACTION: 109,
	AC_GET_FOLLOWER: 110,
	AC_GET_KEPT_MSG: 111,
	AC_GET_PROVINCE: 112,
	AC_GET_CITY: 113,
	AC_GET_KEPT_TOPIC: 114,
	AC_LOOK_AROUND: 115,
	AC_USER_INFO: 116,
	AC_CLEAR_MENTIONED: 117,
	AC_CLEAR_DIRECT: 118,
	AC_CLEAR_FOLLOWER: 119,
	AC_CLEAR_UNREAD: 120,
	AC_QUERY_SHORT_URL: 121,
	AC_HOT_USER: 122,
	AC_HOT_MSG: 123,
	AC_HOT_TOPIC: 124,
	AC_FAMOUS_USER_CLASS: 125,
	AC_FAMOUS_USER_LIST: 126,
	AC_MSG_FORWARD_HISTORY: 127,
	AC_GET_BLACK_USER_LIST: 128,
	AC_ADD_BLACK_USER_LIST: 129,
	AC_REMOVE_BLACK_USER_LIST: 130,
	AC_GET_USER_SETTING_PAGE_NUM: 131,
	AC_GET_USER_GROUP_LIST: 132,
	AC_ADD_USER_GROUP_LIST: 133,
	AC_REMOVE_USER_GROUP_LIST: 134,
	AC_USER_UPDATE_PRIVACY: 135,
	AC_GET_USER_PRIVACY: 136,
	AC_LBS_QUERY_ADDR_TEXT: 137,
	AC_IMAGE_BASE64_PROXY: 138,
	AC_ID_AUTO_COMPLETE: 139,
	AC_GET_VERIFY_IMG: 140,
	AC_DO_VERIFY: 141,
	AC_GET_COUNTRY: 142,
	AC_TELECOM: 214,
	AC_CHANNEL: 215,
	AC_CHANNEL_DETAIL: 216,
	AC_NEARBYMSG: 220,
	AC_HEADNAVFLAG: 221,
	AC_FAMOUSSAY: 218,
	AC_NEARBYUSER: 219,
	AC_GET_KEPT_KEYWORD: 222,
	AC_PRIVATEMSG_LIST: 223,
	AC_DIALOGHISTORY: 224,
	AC_CLOSEFRIEND: 225,
	AC_GET_PRIVATEMSG_PERMISSION: 226,
	AC_SET_PRIVATEMSG_PERMISSION: 227,
	AC_BIDIRECTION_FOLLOWS: 228,
	AC_FAMOUS_INDEX: 229,
	AC_RECOMMEND_FAMOUS: 230,
	AC_JOINTFOLLOW: 231,
	AC_APPLIST: 233,
	AC_FAMOUS_USERANDSAY: 235,
	AC_CLICKCOUNT: 236,
	AC_APPOPENID: 234,
	AC_GET_PRIVATESET: 239,
	AC_SET_PRIVATESET: 240,
	AC_GET_MSGSET: 241,
	AC_SET_MSGSET: 242,
	AC_GETVOTE: 237,
	AC_VOTE: 238,
	AC_OLYMPIC_HOME: 260,
	AC_SCHEDULES_BY_PAGE: 261,
	AC_SCHEDULES: 262,
	AC_SUBSCRIBE: 267,
	AC_UNSUBSCRIBE: 268,
	AC_LIST_SUBSCRIPTIONS: 270,
	AC_OLYMPIC_FIRST_PAGE: 271,
	AC_OLYMPIC_LAST_PAGE: 272,
	AC_OLYMPIC_SPORTS: 273,
	AC_LIST_GAME_INFO: 274,
	AC_LIST_GAME_INFO_PAGE: 275,
	AC_LIST_COMMENT_PAGE: 276,
	AC_LIST_OLYMPIC_ACROSS: 279,
	AC_OLYMPICCOUNTDOUNT: 250,
	AC_SKINSET: 251,
	AC_SKINGET: 252,
	AC_BETTING_INDEX_PAGE: 277,
	AC_ACTIVITY_HOME: 280,
	AC_ACTIVITY_PAGE: 281,
	AC_USER_AVATAR_SYNC: 288,
	AC_USER_INFO_EDU_WORK: 289,
	AC_GET_SCHOOL_DEPART_NAME: 290,
	AC_ADD_EDUCATION: 291,
	AC_ADD_WORK: 292,
	AC_DELETE_WORK: 293,
	AC_DELETE_EDUCATION: 294,
	AC_GET_USER_INFO: 295,
	AC_ACTIVITY_BIND: 296,
	AC_ACTIVITY_QUERY_BIND: 298,
	AC_ADD_USER_TAG: 300,
	AC_DEL_USER_TAG: 301,
	AC_LIST_USER_TAG: 302,
	AC_LIST_HOT_TAG: 303,
	AC_LIST_TAG: 304,
	AC_HOME_HEAD: 305
},
g_search_type = {
	COMMENT: 64,
	RT: 2
},
g_msgtype = {
	POST: 1,
	FORWARD: 2,
	DIRECT: 3,
	REPLY: 4,
	COMMENT: 7
},
g_loadings = [],
g_imgtip_shown = 0,
g_text_editing,
g_text_check_interval = 300;
g_from_android && (g_text_check_interval = 3e3);
var g_overlay, g_backwards = ! 1;
g_bigImgDeg = 0,
function() {
	$(document).ready(function() {
		var e = $("#rotImg");
		$("#rotLeft").bind("click", function() {
			g_bigImgDeg -= 90,
			e.css("-webkit-transform", "rotate(" + g_bigImgDeg + "deg)")
		}),
		$("#rotRight").bind("click", function() {
			g_bigImgDeg += 90,
			e.css("-webkit-transform", "rotate(" + g_bigImgDeg + "deg)")
		})
	})
} (),
function(e) {
	var t = function(e) {
		var t = this;
		for (var n in e) t[n] = e[n]
	};
	t.prototype = {
		__tid: null,
		__link: null,
		__counter: 0,
		__createLinkElement: function() {
			var e = this;
			e.__link = document.createElement("link"),
			e.__link.type = "text/css",
			e.__link.rel = "stylesheet",
			e.__link.id = e.id,
			e.__link.href = e.href
		},
		__appendLinkToHead: function() {
			var e = this,
			t = document.querySelector("head link[id]");
			document.getElementsByTagName("head")[0].insertBefore(e.__link, t)
		},
		__check: function() {
			var e = this,
			t = document.styleSheets;
			for (var n = 0, r = t.length; n < r; n++) {
				var i = t[n],
				s = i.ownerNode || i.owningElement;
				if (s && s.id == e.id) {
					e.onReady && e.onReady.call(this),
					clearTimeout(e.__tid);
					return
				}
			}
			if (e.__counter >= e.timeout) {
				e.onError && e.onError.call(this),
				clearTimeout(e.__tid);
				return
			}
			e.__counter += 400,
			e.__tid && clearTimeout(e.__tid),
			e.__tid = setTimeout(function() {
				e.__check.call(e)
			},
			400)
		},
		id: ["css", "preloader", (new Date).getTime()].join("-"),
		href: null,
		timeout: 4e3,
		onError: null,
		onReady: null,
		start: function() {
			var e = this;
			e.__createLinkElement(),
			e.__appendLinkToHead(),
			e.__check()
		}
	},
	e.cssPreloader = t
} (window),
function() {
	function t() {
		loginPop.setIsFromClick(!0),
		window.g_isLogin && localStorageObj.set("sid", window.g_sid),
		$("footer a#t_top").bind("click", function() {
			MoveableNav.scrollToTop()
		}),
		$("#footer_suggestion").bind("click", function() {
			util.pushHashParams({
				pageId: "compose",
				urlParams: {
					sendType: "post",
					topic: "手机微博触屏版"
				}
			})
		}),
		cookieObj.domain = ".3g.qq.com",
		cookieObj.get("mb_imgshow") || cookieObj.set("mb_imgshow", "show"),
		cookieObj.get("mblog_listimg") || cookieObj.set("mblog_listimg", "true"),
		isGrayOlyView && $("#t_navlast").attr("href", "#olympic_view"),
		$(".logowrapper > a[href], .main-nav > a[href]").each(function(e, t) {
			var n = $(t);
			n.bind("click", function() {
				return window.location.hash = n.attr("href"),
				! 1
			})
		}),
		loginPop.setIsFromClick(!1),
		window.g_f && window.g_f == 18106 && redirectLayer.show(),
		NavControl.init(),
		loginPop.init()
	}
	g_isqqbrowser37 ? $(document).ready(function() {
		function e(e) {
			function t(e) {
				var t = e.substring(e.indexOf("sid=") + 4);
				return t.substring(0, t.indexOf(";"))
			}
			function n(e) {
				var t = window.location.href;
				t.indexOf("?") == - 1 ? window.location.href = t + "?sid=" + e: (/sid=\w+&/gi.test(t) && (t = t.replace(/sid=\w+&/g, "")), /sid=\w+/gi.test(t) && (t = t.replace(/sid=\w+/g, "")), t = t.replace(/.jsp\?/gi, ".jsp?sid=" + e + "&"), t.lastIndexOf("&") == t.length - 1 && (t = t.substr(0, t.length - 2)), window.location.href = t)
			}
			var r = e,
			i = t(r.sid);
			i ? n(i) : loginPop.goToLogin()
		}
		function n() {
			loginPop.goToLogin()
		}
		g_sid ? t() : T5Kit.user.getQCookie(e, n)
	}) : $(document).ready(t)
} ();
var FaceMapping = {
	texts: ["/调皮", "/呲牙", "/惊讶", "/难过", "/酷", "/冷汗", "/抓狂", "/吐", "/偷笑", "/可爱", "/白眼", "/傲慢", "/微笑", "/撇嘴", "/色", "/发呆", "/得意", "/流泪", "/害羞", "/嘘", "/困", "/尴尬", "/发怒", "/大哭", "/流汗", "/再见", "/敲打", "/擦汗", "/委屈", "/疑问", "/睡", "/亲亲", "/憨笑", "/衰", "/阴险", "/奋斗", "/右哼哼", "/拥抱", "/坏笑", "/鄙视", "/晕", "/大兵", "/可怜", "/饥饿", "/咒骂", "/抠鼻", "/鼓掌", "/糗大了", "/左哼哼", "/哈欠", "/快哭了", "/吓", "/闭嘴", "/惊恐", "/折磨", "/示爱", "/爱心", "/心碎", "/蛋糕", "/闪电", "/炸弹", "/刀", "/足球", "/瓢虫", "/便便", "/咖啡", "/饭", "/猪头", "/玫瑰", "/凋谢", "/月亮", "/太阳", "/礼物", "/强", "/弱", "/握手", "/胜利", "/抱拳", "/勾引", "/拳头", "/差劲", "/爱你", "/NO", "/OK", "/爱情", "/飞吻", "/跳跳", "/发抖", "/怄火", "/转圈", "/磕头", "/回头", "/跳绳", "/挥手", "/激动", "/街舞", "/献吻", "/左太极", "/右太极", "/菜刀", "/西瓜", "/啤酒", "/骷髅", "/篮球", "/兵乓"],
	getText: function(e) {
		return FaceMapping.texts[e]
	}
};
(function() {
	var e = Math,
	t = function(e) {
		return e >> 0
	},
	n = /webkit/i.test(navigator.appVersion) ? "webkit": /firefox/i.test(navigator.userAgent) ? "Moz": "opera" in window ? "O": "",
	r = /android/gi.test(navigator.appVersion),
	i = /iphone|ipad/gi.test(navigator.appVersion),
	s = /playbook/gi.test(navigator.appVersion),
	o = /hp-tablet/gi.test(navigator.appVersion),
	u = "WebKitCSSMatrix" in window && "m11" in new WebKitCSSMatrix,
	a = "ontouchstart" in window && ! o,
	f = n + "Transform" in document.documentElement.style,
	l = i || s,
	c = function() {
		return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(e) {
			return setTimeout(e, 1)
		}
	} (),
	h = function() {
		return window.cancelRequestAnimationFrame || window.webkitCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || clearTimeout
	} (),
	p = "onorientationchange" in window ? "orientationchange": "resize",
	d = a ? "touchstart": "mousedown",
	v = a ? "touchmove": "mousemove",
	m = a ? "touchend": "mouseup",
	g = a ? "touchcancel": "mouseup",
	y = n == "Moz" ? "DOMMouseScroll": "mousewheel",
	b = "translate" + (u ? "3d(": "("),
	w = u ? ",0)": ")",
	E = function(e, t) {
		var s = this,
		o = document,
		c;
		s.wrapper = typeof e == "object" ? e: o.getElementById(e),
		s.wrapper.style.overflow = "hidden",
		s.scroller = s.wrapper.children[0],
		s.options = {
			hScroll: ! 0,
			vScroll: ! 0,
			x: 0,
			y: 0,
			bounce: ! 0,
			bounceLock: ! 1,
			momentum: ! 0,
			lockDirection: ! 0,
			useTransform: ! 0,
			useTransition: ! 1,
			topOffset: 0,
			checkDOMChanges: ! 1,
			hScrollbar: ! 0,
			vScrollbar: ! 0,
			fixedScrollbar: r,
			hideScrollbar: i,
			fadeScrollbar: i && u,
			scrollbarClass: "",
			zoom: ! 1,
			zoomMin: 1,
			zoomMax: 4,
			doubleTapZoom: 2,
			wheelAction: "scroll",
			snap: ! 1,
			snapThreshold: 1,
			onRefresh: null,
			onBeforeScrollStart: function(e) {
				var t = e.target;
				while (t.nodeType != 1) t = t.parentNode;
				t.tagName != "SELECT" && t.tagName != "INPUT" && t.tagName != "TEXTAREA",
				e.preventDefault()
			},
			onScrollStart: null,
			onBeforeScrollMove: null,
			onScrollMove: null,
			onBeforeScrollEnd: null,
			onScrollEnd: null,
			onTouchEnd: null,
			onDestroy: null,
			onZoomStart: null,
			onZoom: null,
			onZoomEnd: null
		},
		s.zoom && r && (b = "translate(", w = ")");
		for (c in t) s.options[c] = t[c];
		s.x = s.options.x,
		s.y = s.options.y,
		s.options.useTransform = f ? s.options.useTransform: ! 1,
		s.options.hScrollbar = s.options.hScroll && s.options.hScrollbar,
		s.options.vScrollbar = s.options.vScroll && s.options.vScrollbar,
		s.options.zoom = s.options.useTransform && s.options.zoom,
		s.options.useTransition = l && s.options.useTransition,
		s.scroller.style[n + "TransitionProperty"] = s.options.useTransform ? "-" + n.toLowerCase() + "-transform": "top left",
		s.scroller.style[n + "TransitionDuration"] = "0",
		s.scroller.style[n + "TransformOrigin"] = "0 0",
		s.options.useTransition && (s.scroller.style[n + "TransitionTimingFunction"] = "cubic-bezier(0.33,0.66,0.66,1)"),
		s.options.useTransform ? s.scroller.style[n + "Transform"] = b + s.x + "px," + s.y + "px" + w: s.scroller.style.cssText += ";position:absolute;top:" + s.y + "px;left:" + s.x + "px",
		s.options.useTransition && (s.options.fixedScrollbar = ! 0),
		s.refresh(),
		s._bind(p, window),
		s._bind(d),
		a || (s._bind("mouseout", s.wrapper), s.options.wheelAction != "none" && s._bind(y)),
		s.options.checkDOMChanges && (s.checkDOMTime = setInterval(function() {
			s._checkDOMChanges()
		},
		500))
	};
	E.prototype = {
		enabled: ! 0,
		x: 0,
		y: 0,
		steps: [],
		scale: 1,
		currPageX: 0,
		currPageY: 0,
		pagesX: [],
		pagesY: [],
		aniTime: null,
		wheelZoomCount: 0,
		handleEvent: function(e) {
			var t = this;
			switch (e.type) {
			case d:
				if (!a && e.button !== 0) return;
				t._start(e);
				break;
			case v:
				t._move(e);
				break;
			case m:
			case g:
				t._end(e);
				break;
			case p:
				t._resize();
				break;
			case y:
				t._wheel(e);
				break;
			case "mouseout":
				t._mouseout(e);
				break;
			case "webkitTransitionEnd":
				t._transitionEnd(e)
			}
		},
		_checkDOMChanges: function() {
			if (this.moved || this.zoomed || this.animating || this.scrollerW == this.scroller.offsetWidth * this.scale && this.scrollerH == this.scroller.offsetHeight * this.scale) return;
			this.refresh()
		},
		_scrollbar: function(r) {
			var i = this,
			s = document,
			o;
			if (!i[r + "Scrollbar"]) {
				i[r + "ScrollbarWrapper"] && (f && (i[r + "ScrollbarIndicator"].style[n + "Transform"] = ""), i[r + "ScrollbarWrapper"].parentNode.removeChild(i[r + "ScrollbarWrapper"]), i[r + "ScrollbarWrapper"] = null, i[r + "ScrollbarIndicator"] = null);
				return
			}
			i[r + "ScrollbarWrapper"] || (o = s.createElement("div"), i.options.scrollbarClass ? o.className = i.options.scrollbarClass + r.toUpperCase() : o.style.cssText = "position:absolute;z-index:100;" + (r == "h" ? "height:7px;bottom:1px;left:2px;right:" + (i.vScrollbar ? "7": "2") + "px": "width:7px;bottom:" + (i.hScrollbar ? "7": "2") + "px;top:2px;right:1px"), o.style.cssText += ";pointer-events:none;-" + n + "-transition-property:opacity;-" + n + "-transition-duration:" + (i.options.fadeScrollbar ? "350ms": "0") + ";overflow:hidden;opacity:" + (i.options.hideScrollbar ? "0": "1"), i.wrapper.appendChild(o), i[r + "ScrollbarWrapper"] = o, o = s.createElement("div"), i.options.scrollbarClass || (o.style.cssText = "position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-" + n + "-background-clip:padding-box;-" + n + "-box-sizing:border-box;" + (r == "h" ? "height:100%": "width:100%") + ";-" + n + "-border-radius:3px;border-radius:3px"), o.style.cssText += ";pointer-events:none;-" + n + "-transition-property:-" + n + "-transform;-" + n + "-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-" + n + "-transition-duration:0;-" + n + "-transform:" + b + "0,0" + w, i.options.useTransition && (o.style.cssText += ";-" + n + "-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"), i[r + "ScrollbarWrapper"].appendChild(o), i[r + "ScrollbarIndicator"] = o),
			r == "h" ? (i.hScrollbarSize = i.hScrollbarWrapper.clientWidth, i.hScrollbarIndicatorSize = e.max(t(i.hScrollbarSize * i.hScrollbarSize / i.scrollerW), 8), i.hScrollbarIndicator.style.width = i.hScrollbarIndicatorSize + "px", i.hScrollbarMaxScroll = i.hScrollbarSize - i.hScrollbarIndicatorSize, i.hScrollbarProp = i.hScrollbarMaxScroll / i.maxScrollX) : (i.vScrollbarSize = i.vScrollbarWrapper.clientHeight, i.vScrollbarIndicatorSize = e.max(t(i.vScrollbarSize * i.vScrollbarSize / i.scrollerH), 8), i.vScrollbarIndicator.style.height = i.vScrollbarIndicatorSize + "px", i.vScrollbarMaxScroll = i.vScrollbarSize - i.vScrollbarIndicatorSize, i.vScrollbarProp = i.vScrollbarMaxScroll / i.maxScrollY),
			i._scrollbarPos(r, ! 0)
		},
		_resize: function() {
			var e = this;
			setTimeout(function() {
				e.refresh()
			},
			r ? 200: 0)
		},
		_pos: function(e, r) {
			e = this.hScroll ? e: 0,
			r = this.vScroll ? r: 0,
			this.options.useTransform ? this.scroller.style[n + "Transform"] = b + e + "px," + r + "px" + w + " scale(" + this.scale + ")": (e = t(e), r = t(r), this.scroller.style.left = e + "px", this.scroller.style.top = r + "px"),
			this.x = e,
			this.y = r,
			this._scrollbarPos("h"),
			this._scrollbarPos("v")
		},
		_scrollbarPos: function(e, r) {
			var i = this,
			s = e == "h" ? i.x: i.y,
			o;
			if (!i[e + "Scrollbar"]) return;
			s = i[e + "ScrollbarProp"] * s,
			s < 0 ? (i.options.fixedScrollbar || (o = i[e + "ScrollbarIndicatorSize"] + t(s * 3), o < 8 && (o = 8), i[e + "ScrollbarIndicator"].style[e == "h" ? "width": "height"] = o + "px"), s = 0) : s > i[e + "ScrollbarMaxScroll"] && (i.options.fixedScrollbar ? s = i[e + "ScrollbarMaxScroll"] : (o = i[e + "ScrollbarIndicatorSize"] - t((s - i[e + "ScrollbarMaxScroll"]) * 3), o < 8 && (o = 8), i[e + "ScrollbarIndicator"].style[e == "h" ? "width": "height"] = o + "px", s = i[e + "ScrollbarMaxScroll"] + (i[e + "ScrollbarIndicatorSize"] - o))),
			i[e + "ScrollbarWrapper"].style[n + "TransitionDelay"] = "0",
			i[e + "ScrollbarWrapper"].style.opacity = r && i.options.hideScrollbar ? "0": "1",
			i[e + "ScrollbarIndicator"].style[n + "Transform"] = b + (e == "h" ? s + "px,0": "0," + s + "px") + w
		},
		_start: function(t) {
			var r = this,
			i = a ? t.touches[0] : t,
			s,
			o,
			u,
			f,
			l;
			if (!r.enabled) return;
			r.options.onBeforeScrollStart && r.options.onBeforeScrollStart.call(r, t),
			(r.options.useTransition || r.options.zoom) && r._transitionTime(0),
			r.moved = ! 1,
			r.animating = ! 1,
			r.zoomed = ! 1,
			r.distX = 0,
			r.distY = 0,
			r.absDistX = 0,
			r.absDistY = 0,
			r.dirX = 0,
			r.dirY = 0,
			r.options.zoom && a && t.touches.length > 1 && (f = e.abs(t.touches[0].pageX - t.touches[1].pageX), l = e.abs(t.touches[0].pageY - t.touches[1].pageY), r.touchesDistStart = e.sqrt(f * f + l * l), r.originX = e.abs(t.touches[0].pageX + t.touches[1].pageX - r.wrapperOffsetLeft * 2) / 2 - r.x, r.originY = e.abs(t.touches[0].pageY + t.touches[1].pageY - r.wrapperOffsetTop * 2) / 2 - r.y, r.options.onZoomStart && r.options.onZoomStart.call(r, t));
			if (r.options.momentum) {
				r.options.useTransform ? (s = getComputedStyle(r.scroller, null)[n + "Transform"].replace(/[^0-9-.,]/g, "").split(","), o = s[4] * 1, u = s[5] * 1) : (o = getComputedStyle(r.scroller, null).left.replace(/[^0-9-]/g, "") * 1, u = getComputedStyle(r.scroller, null).top.replace(/[^0-9-]/g, "") * 1);
				if (o != r.x || u != r.y) r.options.useTransition ? r._unbind("webkitTransitionEnd") : h(r.aniTime),
				r.steps = [],
				r._pos(o, u)
			}
			r.absStartX = r.x,
			r.absStartY = r.y,
			r.startX = r.x,
			r.startY = r.y,
			r.pointX = i.pageX,
			r.pointY = i.pageY,
			r.startTime = t.timeStamp || Date.now(),
			r.options.onScrollStart && r.options.onScrollStart.call(r, t),
			r._bind(v),
			r._bind(m),
			r._bind(g)
		},
		_move: function(t) {
			var r = this,
			i = a ? t.touches[0] : t,
			s = i.pageX - r.pointX,
			o = i.pageY - r.pointY,
			u = r.x + s,
			f = r.y + o,
			l,
			c,
			h,
			p = t.timeStamp || Date.now();
			r.options.onBeforeScrollMove && r.options.onBeforeScrollMove.call(r, t);
			if (r.options.zoom && a && t.touches.length > 1) {
				l = e.abs(t.touches[0].pageX - t.touches[1].pageX),
				c = e.abs(t.touches[0].pageY - t.touches[1].pageY),
				r.touchesDist = e.sqrt(l * l + c * c),
				r.zoomed = ! 0,
				h = 1 / r.touchesDistStart * r.touchesDist * this.scale,
				h < r.options.zoomMin ? h = .5 * r.options.zoomMin * Math.pow(2, h / r.options.zoomMin) : h > r.options.zoomMax && (h = 2 * r.options.zoomMax * Math.pow(.5, r.options.zoomMax / h)),
				r.lastScale = h / this.scale,
				u = this.originX - this.originX * r.lastScale + this.x,
				f = this.originY - this.originY * r.lastScale + this.y,
				this.scroller.style[n + "Transform"] = b + u + "px," + f + "px" + w + " scale(" + h + ")",
				r.options.onZoom && r.options.onZoom.call(r, t);
				return
			}
			r.pointX = i.pageX,
			r.pointY = i.pageY;
			if (u > 0 || u < r.maxScrollX) u = r.options.bounce ? r.x + s / 2: u >= 0 || r.maxScrollX >= 0 ? 0: r.maxScrollX;
			if (f > r.minScrollY || f < r.maxScrollY) f = r.options.bounce ? r.y + o / 2: f >= r.minScrollY || r.maxScrollY >= 0 ? r.minScrollY: r.maxScrollY;
			if (r.absDistX < 6 && r.absDistY < 6) {
				r.distX += s,
				r.distY += o,
				r.absDistX = e.abs(r.distX),
				r.absDistY = e.abs(r.distY);
				return
			}
			r.options.lockDirection && (r.absDistX > r.absDistY + 5 ? (f = r.y, o = 0) : r.absDistY > r.absDistX + 5 && (u = r.x, s = 0)),
			r.moved = ! 0,
			r._pos(u, f),
			r.dirX = s > 0 ? - 1: s < 0 ? 1: 0,
			r.dirY = o > 0 ? - 1: o < 0 ? 1: 0,
			p - r.startTime > 300 && (r.startTime = p, r.startX = r.x, r.startY = r.y),
			r.options.onScrollMove && r.options.onScrollMove.call(r, t)
		},
		_end: function(r) {
			if (a && r.touches.length != 0) return;
			var i = this,
			s = a ? r.changedTouches[0] : r,
			o,
			u,
			f = {
				dist: 0,
				time: 0
			},
			l = {
				dist: 0,
				time: 0
			},
			c = (r.timeStamp || Date.now()) - i.startTime,
			h = i.x,
			p = i.y,
			d,
			y,
			E,
			S,
			x;
			i._unbind(v),
			i._unbind(m),
			i._unbind(g),
			i.options.onBeforeScrollEnd && i.options.onBeforeScrollEnd.call(i, r);
			if (i.zoomed) {
				x = i.scale * i.lastScale,
				x = Math.max(i.options.zoomMin, x),
				x = Math.min(i.options.zoomMax, x),
				i.lastScale = x / i.scale,
				i.scale = x,
				i.x = i.originX - i.originX * i.lastScale + i.x,
				i.y = i.originY - i.originY * i.lastScale + i.y,
				i.scroller.style[n + "TransitionDuration"] = "200ms",
				i.scroller.style[n + "Transform"] = b + i.x + "px," + i.y + "px" + w + " scale(" + i.scale + ")",
				i.zoomed = ! 1,
				i.refresh(),
				i.options.onZoomEnd && i.options.onZoomEnd.call(i, r);
				return
			}
			if (!i.moved) {
				a && (i.doubleTapTimer && i.options.zoom ? (clearTimeout(i.doubleTapTimer), i.doubleTapTimer = null, i.options.onZoomStart && i.options.onZoomStart.call(i, r), i.zoom(i.pointX, i.pointY, i.scale == 1 ? i.options.doubleTapZoom: 1), i.options.onZoomEnd && setTimeout(function() {
					i.options.onZoomEnd.call(i, r)
				},
				200)) : i.doubleTapTimer = setTimeout(function() {
					i.doubleTapTimer = null,
					o = s.target;
					while (o.nodeType != 1) o = o.parentNode;
					o.tagName != "SELECT" && o.tagName != "INPUT" && o.tagName != "TEXTAREA" && (u = document.createEvent("MouseEvents"), u.initMouseEvent("click", ! 0, ! 0, r.view, 1, s.screenX, s.screenY, s.clientX, s.clientY, r.ctrlKey, r.altKey, r.shiftKey, r.metaKey, 0, null), u._fake = ! 0, o.dispatchEvent(u))
				},
				i.options.zoom ? 250: 0)),
				i._resetPos(200),
				i.options.onTouchEnd && i.options.onTouchEnd.call(i, r);
				return
			}
			if (c < 300 && i.options.momentum) {
				f = h ? i._momentum(h - i.startX, c, - i.x, i.scrollerW - i.wrapperW + i.x, i.options.bounce ? i.wrapperW: 0) : f,
				l = p ? i._momentum(p - i.startY, c, - i.y, i.maxScrollY < 0 ? i.scrollerH - i.wrapperH + i.y - i.minScrollY: 0, i.options.bounce ? i.wrapperH: 0) : l,
				h = i.x + f.dist,
				p = i.y + l.dist;
				if (i.x > 0 && h > 0 || i.x < i.maxScrollX && h < i.maxScrollX) f = {
					dist: 0,
					time: 0
				};
				if (i.y > i.minScrollY && p > i.minScrollY || i.y < i.maxScrollY && p < i.maxScrollY) l = {
					dist: 0,
					time: 0
				}
			}
			if (f.dist || l.dist) {
				E = e.max(e.max(f.time, l.time), 10),
				i.options.snap && (d = h - i.absStartX, y = p - i.absStartY, e.abs(d) < i.options.snapThreshold && e.abs(y) < i.options.snapThreshold ? i.scrollTo(i.absStartX, i.absStartY, 200) : (S = i._snap(h, p), h = S.x, p = S.y, E = e.max(S.time, E))),
				i.scrollTo(t(h), t(p), E),
				i.options.onTouchEnd && i.options.onTouchEnd.call(i, r);
				return
			}
			if (i.options.snap) {
				d = h - i.absStartX,
				y = p - i.absStartY,
				e.abs(d) < i.options.snapThreshold && e.abs(y) < i.options.snapThreshold ? i.scrollTo(i.absStartX, i.absStartY, 200) : (S = i._snap(i.x, i.y), (S.x != i.x || S.y != i.y) && i.scrollTo(S.x, S.y, S.time)),
				i.options.onTouchEnd && i.options.onTouchEnd.call(i, r);
				return
			}
			i._resetPos(200),
			i.options.onTouchEnd && i.options.onTouchEnd.call(i, r)
		},
		_resetPos: function(e) {
			var t = this,
			r = t.x >= 0 ? 0: t.x < t.maxScrollX ? t.maxScrollX: t.x,
			i = t.y >= t.minScrollY || t.maxScrollY > 0 ? t.minScrollY: t.y < t.maxScrollY ? t.maxScrollY: t.y;
			if (r == t.x && i == t.y) {
				t.moved && (t.moved = ! 1, t.options.onScrollEnd && t.options.onScrollEnd.call(t)),
				t.hScrollbar && t.options.hideScrollbar && (n == "webkit" && (t.hScrollbarWrapper.style[n + "TransitionDelay"] = "300ms"), t.hScrollbarWrapper.style.opacity = "0"),
				t.vScrollbar && t.options.hideScrollbar && (n == "webkit" && (t.vScrollbarWrapper.style[n + "TransitionDelay"] = "300ms"), t.vScrollbarWrapper.style.opacity = "0");
				return
			}
			t.scrollTo(r, i, e || 0)
		},
		_wheel: function(e) {
			var t = this,
			n, r, i, s, o;
			"wheelDeltaX" in e ? (n = e.wheelDeltaX / 12, r = e.wheelDeltaY / 12) : "detail" in e ? n = r = - e.detail * 3: n = r = - e.wheelDelta;
			if (t.options.wheelAction == "zoom") {
				o = t.scale * Math.pow(2, 1 / 3 * (r ? r / Math.abs(r) : 0)),
				o < t.options.zoomMin && (o = t.options.zoomMin),
				o > t.options.zoomMax && (o = t.options.zoomMax),
				o != t.scale && (!t.wheelZoomCount && t.options.onZoomStart && t.options.onZoomStart.call(t, e), t.wheelZoomCount++, t.zoom(e.pageX, e.pageY, o, 400), setTimeout(function() {
					t.wheelZoomCount--,
					! t.wheelZoomCount && t.options.onZoomEnd && t.options.onZoomEnd.call(t, e)
				},
				400));
				return
			}
			i = t.x + n,
			s = t.y + r,
			i > 0 ? i = 0: i < t.maxScrollX && (i = t.maxScrollX),
			s > t.minScrollY ? s = t.minScrollY: s < t.maxScrollY && (s = t.maxScrollY),
			t.scrollTo(i, s, 0)
		},
		_mouseout: function(e) {
			var t = e.relatedTarget;
			if (!t) {
				this._end(e);
				return
			}
			while (t = t.parentNode) if (t == this.wrapper) return;
			this._end(e)
		},
		_transitionEnd: function(e) {
			var t = this;
			if (e.target != t.scroller) return;
			t._unbind("webkitTransitionEnd"),
			t._startAni()
		},
		_startAni: function() {
			var t = this,
			n = t.x,
			r = t.y,
			i = Date.now(),
			s,
			o,
			u;
			if (t.animating) return;
			if (!t.steps.length) {
				t._resetPos(400);
				return
			}
			s = t.steps.shift(),
			s.x == n && s.y == r && (s.time = 0),
			t.animating = ! 0,
			t.moved = ! 0;
			if (t.options.useTransition) {
				t._transitionTime(s.time),
				t._pos(s.x, s.y),
				t.animating = ! 1,
				s.time ? t._bind("webkitTransitionEnd") : t._resetPos(0);
				return
			}
			u = function() {
				var a = Date.now(),
				f,
				l;
				if (a >= i + s.time) {
					t._pos(s.x, s.y),
					t.animating = ! 1,
					t.options.onAnimationEnd && t.options.onAnimationEnd.call(t),
					t._startAni();
					return
				}
				a = (a - i) / s.time - 1,
				o = e.sqrt(1 - a * a),
				f = (s.x - n) * o + n,
				l = (s.y - r) * o + r,
				t._pos(f, l),
				t.animating && (t.aniTime = c(u))
			},
			u()
		},
		_transitionTime: function(e) {
			e += "ms",
			this.scroller.style[n + "TransitionDuration"] = e,
			this.hScrollbar && (this.hScrollbarIndicator.style[n + "TransitionDuration"] = e),
			this.vScrollbar && (this.vScrollbarIndicator.style[n + "TransitionDuration"] = e)
		},
		_momentum: function(n, r, i, s, o) {
			var u = 6e - 4,
			a = e.abs(n) / r,
			f = a * a / (2 * u),
			l = 0,
			c = 0;
			return n > 0 && f > i ? (c = o / (6 / (f / a * u)), i += c, a = a * i / f, f = i) : n < 0 && f > s && (c = o / (6 / (f / a * u)), s += c, a = a * s / f, f = s),
			f *= n < 0 ? - 1: 1,
			l = a / u,
			{
				dist: f,
				time: t(l)
			}
		},
		_offset: function(e) {
			var t = - e.offsetLeft,
			n = - e.offsetTop;
			while (e = e.offsetParent) t -= e.offsetLeft,
			n -= e.offsetTop;
			return e != this.wrapper && (t *= this.scale, n *= this.scale),
			{
				left: t,
				top: n
			}
		},
		_snap: function(n, r) {
			var i = this,
			s, o, u, a, f, l;
			u = i.pagesX.length - 1;
			for (s = 0, o = i.pagesX.length; s < o; s++) if (n >= i.pagesX[s]) {
				u = s;
				break
			}
			u == i.currPageX && u > 0 && i.dirX < 0 && u--,
			n = i.pagesX[u],
			f = e.abs(n - i.pagesX[i.currPageX]),
			f = f ? e.abs(i.x - n) / f * 500: 0,
			i.currPageX = u,
			u = i.pagesY.length - 1;
			for (s = 0; s < u; s++) if (r >= i.pagesY[s]) {
				u = s;
				break
			}
			return u == i.currPageY && u > 0 && i.dirY < 0 && u--,
			r = i.pagesY[u],
			l = e.abs(r - i.pagesY[i.currPageY]),
			l = l ? e.abs(i.y - r) / l * 500: 0,
			i.currPageY = u,
			a = t(e.max(f, l)) || 200,
			{
				x: n,
				y: r,
				time: a
			}
		},
		_bind: function(e, t, n) { (t || this.scroller).addEventListener(e, this, !! n)
		},
		_unbind: function(e, t, n) { (t || this.scroller).removeEventListener(e, this, !! n)
		},
		destroy: function() {
			var e = this;
			e.scroller.style[n + "Transform"] = "",
			e.hScrollbar = ! 1,
			e.vScrollbar = ! 1,
			e._scrollbar("h"),
			e._scrollbar("v"),
			e._unbind(p, window),
			e._unbind(d),
			e._unbind(v),
			e._unbind(m),
			e._unbind(g),
			e.options.hasTouch && (e._unbind("mouseout", e.wrapper), e._unbind(y)),
			e.options.useTransition && e._unbind("webkitTransitionEnd"),
			e.options.checkDOMChanges && clearInterval(e.checkDOMTime),
			e.options.onDestroy && e.options.onDestroy.call(e)
		},
		refresh: function() {
			var e = this,
			r, i, s, o, u = 0,
			a = 0;
			e.scale < e.options.zoomMin && (e.scale = e.options.zoomMin),
			e.wrapperW = e.wrapper.clientWidth || 1,
			e.wrapperH = e.wrapper.clientHeight || 1,
			e.minScrollY = - e.options.topOffset || 0,
			e.scrollerW = t(e.scroller.offsetWidth * e.scale),
			e.scrollerH = t((e.scroller.offsetHeight + e.minScrollY) * e.scale),
			e.maxScrollX = e.wrapperW - e.scrollerW,
			e.maxScrollY = e.wrapperH - e.scrollerH + e.minScrollY,
			e.dirX = 0,
			e.dirY = 0,
			e.options.onRefresh && e.options.onRefresh.call(e),
			e.hScroll = e.options.hScroll && e.maxScrollX < 0,
			e.vScroll = e.options.vScroll && (!e.options.bounceLock && ! e.hScroll || e.scrollerH > e.wrapperH),
			e.hScrollbar = e.hScroll && e.options.hScrollbar,
			e.vScrollbar = e.vScroll && e.options.vScrollbar && e.scrollerH > e.wrapperH,
			r = e._offset(e.wrapper),
			e.wrapperOffsetLeft = - r.left,
			e.wrapperOffsetTop = - r.top;
			if (typeof e.options.snap == "string") {
				e.pagesX = [],
				e.pagesY = [],
				o = e.scroller.querySelectorAll(e.options.snap);
				for (i = 0, s = o.length; i < s; i++) u = e._offset(o[i]),
				u.left += e.wrapperOffsetLeft,
				u.top += e.wrapperOffsetTop,
				e.pagesX[i] = u.left < e.maxScrollX ? e.maxScrollX: u.left * e.scale,
				e.pagesY[i] = u.top < e.maxScrollY ? e.maxScrollY: u.top * e.scale
			} else if (e.options.snap) {
				e.pagesX = [];
				while (u >= e.maxScrollX) e.pagesX[a] = u,
				u -= e.wrapperW,
				a++;
				e.maxScrollX % e.wrapperW && (e.pagesX[e.pagesX.length] = e.maxScrollX - e.pagesX[e.pagesX.length - 1] + e.pagesX[e.pagesX.length - 1]),
				u = 0,
				a = 0,
				e.pagesY = [];
				while (u >= e.maxScrollY) e.pagesY[a] = u,
				u -= e.wrapperH,
				a++;
				e.maxScrollY % e.wrapperH && (e.pagesY[e.pagesY.length] = e.maxScrollY - e.pagesY[e.pagesY.length - 1] + e.pagesY[e.pagesY.length - 1])
			}
			e._scrollbar("h"),
			e._scrollbar("v"),
			e.zoomed || (e.scroller.style[n + "TransitionDuration"] = "0", e._resetPos(200))
		},
		scrollTo: function(e, t, n, r) {
			var i = this,
			s = e,
			o, u;
			i.stop(),
			s.length || (s = [{
				x: e,
				y: t,
				time: n,
				relative: r
			}]);
			for (o = 0, u = s.length; o < u; o++) s[o].relative && (s[o].x = i.x - s[o].x, s[o].y = i.y - s[o].y),
			i.steps.push({
				x: s[o].x,
				y: s[o].y,
				time: s[o].time || 0
			});
			i._startAni()
		},
		scrollToElement: function(t, n) {
			var r = this,
			i;
			t = t.nodeType ? t: r.scroller.querySelector(t);
			if (!t) return;
			i = r._offset(t),
			i.left += r.wrapperOffsetLeft,
			i.top += r.wrapperOffsetTop,
			i.left = i.left > 0 ? 0: i.left < r.maxScrollX ? r.maxScrollX: i.left,
			i.top = i.top > r.minScrollY ? r.minScrollY: i.top < r.maxScrollY ? r.maxScrollY: i.top,
			n = n === undefined ? e.max(e.abs(i.left) * 2, e.abs(i.top) * 2) : n,
			r.scrollTo(i.left, i.top, n)
		},
		scrollToPage: function(e, t, n) {
			var r = this,
			i, s;
			r.options.onScrollStart && r.options.onScrollStart.call(r),
			r.options.snap ? (e = e == "next" ? r.currPageX + 1: e == "prev" ? r.currPageX - 1: e, t = t == "next" ? r.currPageY + 1: t == "prev" ? r.currPageY - 1: t, e = e < 0 ? 0: e > r.pagesX.length - 1 ? r.pagesX.length - 1: e, t = t < 0 ? 0: t > r.pagesY.length - 1 ? r.pagesY.length - 1: t, r.currPageX = e, r.currPageY = t, i = r.pagesX[e], s = r.pagesY[t]) : (i = - r.wrapperW * e, s = - r.wrapperH * t, i < r.maxScrollX && (i = r.maxScrollX), s < r.maxScrollY && (s = r.maxScrollY)),
			r.scrollTo(i, s, n || 400)
		},
		disable: function() {
			this.stop(),
			this._resetPos(0),
			this.enabled = ! 1,
			this._unbind(v),
			this._unbind(m),
			this._unbind(g)
		},
		enable: function() {
			this.enabled = ! 0
		},
		stop: function() {
			this.options.useTransition ? this._unbind("webkitTransitionEnd") : h(this.aniTime),
			this.steps = [],
			this.moved = ! 1,
			this.animating = ! 1
		},
		zoom: function(e, t, r, i) {
			var s = this,
			o = r / s.scale;
			if (!s.options.useTransform) return;
			s.zoomed = ! 0,
			i = i === undefined ? 200: i,
			e = e - s.wrapperOffsetLeft - s.x,
			t = t - s.wrapperOffsetTop - s.y,
			s.x = e - e * o + s.x,
			s.y = t - t * o + s.y,
			s.scale = r,
			s.refresh(),
			s.x = s.x > 0 ? 0: s.x < s.maxScrollX ? s.maxScrollX: s.x,
			s.y = s.y > s.minScrollY ? s.minScrollY: s.y < s.maxScrollY ? s.maxScrollY: s.y,
			s.scroller.style[n + "TransitionDuration"] = i + "ms",
			s.scroller.style[n + "Transform"] = b + s.x + "px," + s.y + "px" + w + " scale(" + r + ")",
			s.zoomed = ! 1
		},
		isReady: function() {
			return ! this.moved && ! this.zoomed && ! this.animating
		}
	},
	typeof exports != "undefined" ? exports.iScroll = E: window.iScroll = E
})(),
function(e) {
	var t = "ontouchstart" in e,
	n = t ? "touchstart": "mousedown",
	r = t ? "touchmove": "mousemove",
	i = t ? "touchend": "mouseup",
	s = t ? "touchcancel": "mouseup";
	avatarScroll = function(e) {
		var t = this;
		for (var n in e) t[n] = e[n]
	},
	avatarScroll.prototype = {
		handleEvent: function(e) {
			var o = this;
			switch (e.type) {
			case n:
				if (!t && e.button !== 0) return;
				o.__start(e);
				break;
			case r:
				o.
				__move(e);
				break;
			case i:
			case s:
				o.__end(e)
			}
		},
		VALID_DISTANCE: 50,
		__validation: ! 0,
		__reference: {
			dom: null,
			x: null,
			y: null
		},
		__current: {
			avatar: null,
			tool: null
		},
		__bind: function(e, t, n) {
			var r = this,
			i = document;
			i.addEventListener(e, r, !! n)
		},
		__unbind: function(e, t, n) {
			var r = this,
			i = document;
			i.removeEventListener(e, r, !! n)
		},
		__start: function(e) {
			var t = this;
			t.__reference = t.__getReference(e),
			t.__validation = t.__valid(t.__reference.dom)
		},
		__move: function(e) {
			var n = this;
			if (n.__validation) {
				var r = {
					x: t ? e.touches[0].pageX: e.pageX,
					y: t ? e.touches[0].pageY: e.pageY
				};
				n.__validation = Math.abs(n.__reference.x - r.x) > n.VALID_DISTANCE || Math.abs(n.__reference.y - r.y) > n.VALID_DISTANCE ? ! 1: ! 0
			}
		},
		__end: function(e) {
			var t = this;
			if (t.__validation) t.__open();
			else if (t.__current.tool && t.__reference.dom) {
				var n = ! 0;
				t.__current.tool.each(function(e, r) {
					r !== t.__reference.dom && (n = ! 1, $(r).children().each(function(e, r) {
						r === t.__reference.dom && ! $(r).hasClass("headimg-scroll-ctrl") && (n = ! 0)
					}))
				}),
				n || (t.__close(), e.preventDefault())
			}
		},
		__getReference: function(e) {
			var n = this,
			r = {};
			return r.dom = e.target,
			r.x = t ? e.touches[0].pageX: e.pageX,
			r.y = t ? e.touches[0].pageY: e.pageY,
			r
		},
		__getCurrent: function() {
			var e = this,
			t = {};
			return t.avatar = e.__reference.dom,
			t.tool = e.__getTool(),
			t
		},
		__getTool: function() {
			var e = this,
			t = null,
			n = $(e.__reference.dom);
			while ((t = n.find("." + e.toolCls)).length === 0 && n.get(0).tagName.toUpperCase() !== "UL") n = n.parent();
			return t && t.length > 0 && t.get(0).tagName.toUpperCase() !== "UL" ? t: null
		},
		__valid: function(e) {
			var t = this;
			return $(e).hasClass(t.avatarCls) ? ! 0: ! 1
		},
		__open: function() {
			var e = this,
			t = e.__reference.dom !== e.__current.avatar;
			e.__actived && e.__close();
			if (t) {
				e.__current = e.__getCurrent();
				if (!e.__current.tool) return;
				var n = $(e.__current.tool);
				n.removeClass(e.closeCls),
				n.addClass(e.openCls),
				n.attr("selected", ! 0),
				e.__actived = ! 0
			}
		},
		__close: function() {
			var e = this;
			if (e.__actived) {
				var t = $(e.__current.tool);
				t.removeClass(e.openCls),
				t.addClass(e.closeCls),
				t.removeAttr("selected")
			}
			e.__actived = ! 1,
			e.__validation = ! 0,
			e.__current = {
				avatar: null,
				tool: null
			}
		},
		avatarCls: "t_avatar",
		toolCls: "t_tool",
		openCls: "t_open",
		closeCls: "t_close",
		startup: function() {
			var e = this;
			e.__bind(n),
			e.__bind(r),
			e.__bind(i),
			e.__bind(s)
		},
		destroy: function() {
			var e = this;
			e.__close(),
			e.__reference = {
				dom: null,
				x: null,
				y: null
			},
			e.__unbind(n),
			e.__unbind(r),
			e.__unbind(i),
			e.__unbind(s)
		}
	},
	e.avatarScroll = avatarScroll
} (window),
document.addEventListener("DOMContentLoaded", function() {
	var e = new avatarScroll({
		openCls: "headimg-scroll-tool-open",
		closeCls: "headimg-scroll-tool-close"
	});
	g_isLogin && e.startup()
},
! 1),
function(e) {
	var t = "ontouchstart" in e,
	n = t ? "touchstart": "mousedown",
	r = t ? "touchmove": "mousemove",
	i = t ? "touchend": "mouseup",
	s = t ? "touchcancel": "mouseup";
	bannerScroll = function(e) {
		var t = this;
		for (var n in e) t[n] = e[n]
	},
	bannerScroll.prototype = {
		handleEvent: function(e) {
			var o = this;
			switch (e.type) {
			case n:
				if (!t && e.button !== 0) return;
				o.__start(e);
				break;
			case r:
				o.__move(e);
				break;
			case i:
			case s:
				o.__end(e)
			}
		},
		VALID_DISTANCE: 50,
		DEFAULT_DURATION: 400,
		DIRECTION_CLICK: "click",
		DIRECTION_LEFT: "left",
		DIRECTION_RIGHT: "right",
		__validation: ! 0,
		__startPoint: null,
		__startTransformPoint: null,
		__currentIndex: null,
		__banner: null,
		__sliding: ! 1,
		__bind: function(e, t, n) {
			var r = this,
			i = t || document;
			i.addEventListener(e, r, !! n)
		},
		__unbind: function(e, t, n) {
			var r = this,
			i = t || document;
			i.removeEventListener(e, r, !! n)
		},
		__start: function(e) {
			var n = this;
			n.__startPointTime = (new Date).getTime(),
			n.__startPoint = {
				x: t ? e.touches[0].pageX: event.pageX,
				y: t ? e.touches[0].pageY: event.pageY
			},
			n.__startTransformPoint = n.__getTransformPosition(),
			n.__bind(r, n.banner),
			n.__bind(i, n.banner),
			n.__bind(s, n.banner)
		},
		__move: function(e) {
			var n = this,
			r = {
				x: t ? e.touches[0].pageX: event.pageX,
				y: t ? e.touches[0].pageY: event.pageY
			};
			n.__sliding = n.__isSlide(r, n.__startPoint),
			n.__sliding && (n.__setTransformPosition(n.banner, {
				x: r.x - n.__startPoint.x + n.__startTransformPoint.x,
				y: 0,
				z: 0
			},
			0), e.preventDefault())
		},
		__end: function(e) {
			var n = this,
			o = (new Date).getTime(),
			u = {
				x: t ? e.changedTouches[0].pageX: event.pageX,
				y: t ? e.changedTouches[0].pageY: event.pageY
			},
			a = n.__startPoint.x - u.x,
			f = n.__getDirection(n.__startPoint.x - u.x);
			n.__timeDistance = o - n.__startPointTime,
			n.isPaging && Math.abs(a) <= n.VALID_DISTANCE && f != n.DIRECTION_CLICK ? n.__setTransformPosition(n.banner, n.__startTransformPoint, n.DEFAULT_DURATION) : f == n.DIRECTION_CLICK ? n.onClick && n.onClick.call(this, e) : f == n.DIRECTION_LEFT ? n.next() : f == n.DIRECTION_RIGHT && n.previous(),
			n.__startPoint = null,
			n.__startTransformPoint = null,
			n.__unbind(r, n.banner),
			n.__unbind(i, n.banner),
			n.__unbind(s, n.banner),
			n.__sliding = ! 1
		},
		__isSlide: function(e, t) {
			return Math.abs(t.x - e.x) > Math.abs(t.y - e.y) ? ! 0: ! 1
		},
		__getDirection: function(e) {
			var t = this;
			if (e == 0 || e > 0 && e < 5) return t.DIRECTION_CLICK;
			if (e > 0) return t.DIRECTION_LEFT;
			if (e < 0) return t.DIRECTION_RIGHT
		},
		__getTransformPosition: function() {
			var e = this,
			t = e.banner.style.webkitTransform;
			return t = t.replace("translate3d(", ""),
			t = t.substr(0, t.indexOf(")")),
			t = t.split(","),
			{
				x: t[0] ? parseInt(t[0]) : 0,
				y: t[1] ? parseInt(t[1]) : 0,
				z: t[2] ? parseInt(t[2]) : 0
			}
		},
		__setTransformPosition: function(e, t, n) {
			e && (e.style.webkitTransform = "translate3d(" + t.x + "px, " + t.y + "px, " + t.z + "px)", e.style.webkitTransitionDuration = n + "ms")
		},
		unit: 320,
		initPosition: {
			x: 0,
			y: 0,
			z: 0
		},
		number: 0,
		width: 0,
		isPaging: ! 0,
		banner: null,
		onClick: null,
		onPrevious: null,
		onNext: null,
		onLoad: null,
		getCurrentIndex: function() {
			var e = this;
			return e.__currentIndex
		},
		next: function() {
			var e = this,
			t = e.__getTransformPosition(),
			n,
			r,
			i = e.DEFAULT_DURATION;
			e.isPaging ? (r = (e.number - 1) * e.unit * - 1, n = t.x <= r ? r: t.x % e.unit != 0 ? Math.floor(t.x / e.unit) * e.unit: t.x - e.unit, e.__currentIndex = Math.abs(n / e.unit)) : (r = e.width * - 1, n = t.x <= r ? r: t.x, n = e.__timeDistance <= 300 ? n - 200: n, n = n <= r ? r: n),
			e.__setTransformPosition(e.banner, {
				x: n,
				y: 0,
				z: 0
			},
			i),
			e.onNext && e.onNext.call(this, e.__currentIndex)
		},
		previous: function() {
			var e = this,
			t = e.__getTransformPosition(),
			n = 0,
			r = e.DEFAULT_DURATION;
			e.isPaging ? (x = t.x >= n ? n: t.x % e.unit != 0 ? Math.ceil(t.x / e.unit) * e.unit: t.x + e.unit, e.__currentIndex = Math.abs(x / e.unit)) : (x = t.x >= n ? n: t.x, x = e.__timeDistance <= 300 ? x + 200: x, x = x >= n ? n: x),
			e.__setTransformPosition(e.banner, {
				x: x,
				y: 0,
				z: 0
			},
			r),
			e.onPrevious && e.onPrevious.call(this, e.__currentIndex)
		},
		startup: function() {
			var e = this;
			e.__setTransformPosition(e.banner, e.initPosition, e.DEFAULT_DURATION),
			e.__bind(n, e.banner),
			e.onLoad && e.onLoad.call(this)
		},
		destroy: function() {
			var e = this;
			e.__startPoint = {
				x: null,
				y: null
			},
			e.__unbind(n, e.banner),
			e.__unbind(r, e.banner),
			e.__unbind(i, e.banner),
			e.__unbind(s, e.banner),
			e.banner = null,
			e.onClick = null,
			e.onPrevious = null,
			e.onNext = null
		}
	},
	e.bannerScroll = bannerScroll
} (window),
DeviceFeature = function() {
	function e() {
		return navigator.userAgent
	}
	function t() {
		var t = e();
		if (t.match(/webkit.+chrome/i) != null) return ! 0;
		if (t.match(/os\s+5_.+mac os/i) != null) return ! 0;
		if (t.match(/os\s+6_.+mac os/i) != null) return ! 0
	}
	function n() {
		var t = e();
		return t.match(/android\s+4\./i) != null ? ! 0: ! 1
	}
	return {
		isSupportFixed: t,
		isAndroid4: n
	}
} (),
function(e) {
	var t = "ontouchstart" in e,
	n = t ? "touchstart": "mousedown",
	r = t ? "touchmove": "mousemove",
	i = t ? "touchend": "mouseup",
	s = t ? "touchcancel": "mouseup",
	o = [];
	ClickCount = function(e) {
		var t = this;
		for (var n in e) t[n] = e[n]
	},
	ClickCount.prototype = {
		handleEvent: function(e) {
			var t = this;
			switch (e.type) {
			case i:
				t.__end(e)
			}
		},
		__bind: function(e, t, n) {
			var r = this,
			i = document;
			i.addEventListener(e, r, !! n)
		},
		__end: function(e) {
			var t = this,
			n = localStorageObj.get("writehis"),
			r = t.__getReference(e),
			i = $(r.dom),
			s = i.attr("href"),
			o,
			u = null,
			a = null,
			f = null;
			if (i.hasClass("t_listen_class")) {
				var l = i.attr("clickid");
				i.hasClass("t_tab_listen_class") ? localStorageObj.remove("writehis") : (u = 0, a = l, f = 0);
				var c = null;
				c = localStorageObj.get("clickhis"),
				c ? (c.num += 1, c.clickid = c.clickid + "|" + l) : (c = {},
				c.num = 1, c.clickid = l),
				localStorageObj.set("clickhis", c)
			} else if (i.data("advid")) u = i.data("advid"),
			a = i.data("posid"),
			f = i.data("type");
			else if (s) {
				o = util.strToObj(s);
				for (var h in o) switch (h) {
				case "advid":
					u = o[h];
					break;
				case "posid":
					a = o[h];
					break;
				case "adtype":
					f = o[h];
					break;
				default:
				}
			}
			u !== null && a !== null && (n = a + "," + u + ",1," + f + ",0", localStorageObj.set("writehis", n))
		},
		__getReference: function(e) {
			var t = this,
			n = {};
			return n.dom = e.target,
			n
		},
		init: function() {
			var e = this;
			e.__bind(i)
		},
		destroy: function() {
			var e = this;
			e.__unbind(i)
		}
	}
} (window),
document.addEventListener("DOMContentLoaded", function() {
	var e = new ClickCount({
		listenCls: "t_listen_class"
	});
	e.init()
},
! 1),
function(e) {
	WriteFromCount = function() {
		this.hashChangeCount = 0,
		this.advId = null,
		this.navPageArray = ["myhome", "notification", "hot", "channels", "app", "famous"]
	},
	WriteFromCount.prototype = {
		getWriteFrom: function() {
			return this.hashChangeCount < 5 && this.advId != null ? this.advId: null
		},
		resetWriteFrom: function() {
			this.hashChangeCount = 0,
			this.advId = null
		},
		setFWCount: function(e, t) {
			for (var n = 0; n < this.navPageArray.length; n++) if (t == this.navPageArray[n]) {
				this.hashChangeCount = 0,
				this.advId = null;
				return
			}
			e == null ? this.advId != null && this.hashChangeCount++ : e == this.advId ? this.hashChangeCount++ : (this.hashChangeCount = 0, this.advId = e)
		},
		getParams: function(e, t) {
			var n = this;
			if (e == g_ac.AC_MSG_POST || e == g_ac.AC_MSG_REPLY || e == g_ac.AC_MSG_FORWARD || e == g_ac.AC_MSG_DIRECT || e == g_ac.AC_MSG_DIRECT_REPLY || e == g_ac.AC_MSG_DIRECT_MANUAL) {
				var r = n.getWriteFrom();
				r != null && (t.advid = r, n.resetWriteFrom())
			}
			return t
		}
	}
} (window);
var wfCount = new WriteFromCount,
NavControl = function() {
	function p(e, t, n) {
		s[e] = s[e] || {},
		s[e][t] = s[e][t] || [],
		s[e][t].push(n)
	}
	function d(e, t, n) {
		var r;
		s[e] && s[e][t] && (r = s[e][t].indexOf(n), s[e][t].splice(r, 1), s[e][t].length || delete s[e][t], $.isEmptyObject(s[e]) && delete s[e])
	}
	function v(e, t, n) {
		l.indexOf(e) < 0 && l.push(e),
		p(e, t, n)
	}
	function m() {
		a = location.hash,
		f = u[0],
		u.unshift(a),
		u.length = t * 2,
		l.indexOf(a) < 0 && a != o[0] && o.unshift(a ? a: i),
		o.length = t;
		if (l.indexOf(a) >= 0) {
			if (!s[a]) {
				history.go( - 1);
				return
			}
			return
		}
		if (s[a] && s[a]. In ) {
			var e = s[a]. In ;
			if (l.indexOf(a) >= 0) {
				for (var n = 0; n < e.length; n++) e[n](),
				d(a, "In", e[n]);
				return
			}
			for (var n = 0; n < e.length; n++) e[n]()
		}
		if (s[f] && s[f].Out) {
			var e = s[f].Out;
			if (l.indexOf(f) >= 0) for (var n = 0; n < e.length; n++) e[n](),
			d(f, "Out", e[n]);
			else for (var n = 0; n < e.length; n++) e[n]()
		}
		E()
	}
	function g() {
		n = "onhashchange" in window,
		o.unshift(location.hash),
		n ? $(window).bind("hashchange", m) : w(),
		location.hash && (o.unshift(location.hash), u.unshift(location.hash))
	}
	function y() {
		var e = util.getHashParams(f),
		t = util.getHashParams(a);
		r = e.pageId == t.pageId,
		history.back()
	}
	function b(e, t) {
		var n = $.isEmptyObject(t) ? "#" + e: "#" + e + "/" + util.objToStr(t);
		decodeURIComponent(n) != decodeURIComponent(location.hash) && e != i && util.pushHashParams({
			pageId: e,
			urlParams: t
		})
	}
	function w() {
		if (NavControl.prevHash != location.hash) {
			for (var e = 0, t = s.length; e < t; e++) s[e](),
			s.unshift(e);
			E()
		}
		setTimeout(w, 500)
	}
	function E() {
		if (!loginPop.isSupportNotLogin() && ! g_isLogin && ! loginPop.getIsFromClick()) {
			loginPop.goToLogin();
			return
		}
		var t = util.getHashParams(),
		n = t.pageId,
		s = t.urlParams ? t.urlParams: {},
		o,
		a = util.getUrlParams().coid;
		a && cookieObj.set("coid", a),
		wfCount.setFWCount(s.advid, n),
		h[a] ? h[a]["nav1"]["hidepages"].indexOf(n) != - 1 || h[a]["nav1"]["hidepages"].indexOf("all") != - 1 ? (NavControl.navConf = h[a].nav1.navconf, NavControl.isSpecial = ! 0) : (NavControl.navConf = h[a].nav2.navconf, NavControl.isSpecial = ! 0) : NavControl.isSpecial = ! 1,
		r !== undefined ? o = {
			urlParams: s,
			forceRefresh: r
		}: o = {
			urlParams: s
		},
		n == "" ? location.hash = i: PageManager.require(n, function() {
			var e;
			touch_console_log && console.log((new Date).getTime() - window.startTime + "nav enter " + t.pageId);
			if (f) if (l.indexOf(f) == - 1) e = PageManager.getObj(util.getHashParams(f).pageId);
			else {
				var r = u.indexOf(f) + 1;
				e = PageManager.getObj(util.getHashParams(u[r]).pageId)
			}
			e && e.leave && e.leave();
			var i = PageManager.getObj(n);
			i.lastHash && i.lastHash != location.hash && (o.forceRefresh = ! 0, i.forceRefresh = ! 0),
			i.enter(o),
			MoveableNav.shift()
		},
		this, function() {
			location.hash = i
		}),
		r = undefined,
		e++
	}
	function S() {
		var e = $("nav.main-nav > span");
		$("nav.main-nav a").each(function(t) {
			var n = t * e.width();
			$(this).tap(function(t) {
				var r = t.target,
				i;
				while (r.tagName != "A") r = r.parentNode;
				$("nav.main-nav a").removeClass("main-nav-current"),
				$(r).addClass("main-nav-current"),
				i = r.getAttribute("href"),
				i && (e.css("display") == "none" ? (e.css("top", "0"), e.css("-webkit-transform", "translate3d(" + n + "px, 0, 0)"), e.css("-webkit-transition-duration", "0"), setTimeout(function() {
					e.css("display", "block"),
					e.css("-webkit-transition-duration", "400ms")
				},
				0)) : (e.css("display", "block"), e.css("-webkit-transform", "translate3d(" + n + "px, 0, 0)")), location.hash = i)
			})
		})
	}
	function x() {
		g(),
		E(),
		S()
	}
	var e = 0,
	t = 6,
	n, r, i = window.g_isLogin ? "myhome": "hot",
	s = {},
	o = [],
	u = [],
	a,
	f,
	l = [],
	c = ["compose"],
	h = window.fromCfgNew;
	return {
		assignHash: b,
		init: x,
		back: y,
		hashList: o,
		addHashListener: p,
		addException: v
	}
} ();
window.firstload = ! 0,
window.animationlock = ! 1,
window.lastshowDom = {};
var pageQueue = [];
window.transition = {
	slide: {
		sin: {
			forward: {
				start: "translate(100%,0%)",
				end: "translate(0%,0%)"
			},
			reverse: {
				start: "translate(-100%,0%)",
				end: "translate(0%,0%)"
			}
		},
		out: {
			forward: {
				start: "translate(0%,0%)",
				end: "translate(-100%,0%)"
			},
			reverse: {
				start: "translate(0%,0%)",
				end: "translate(100%,0%)"
			}
		}
	},
	slideup: {
		sin: {
			forward: {
				start: "translate(0%,100%)",
				end: "translate(0%,0%)"
			},
			reverse: {
				start: "translate(0%,-100%)",
				end: "translate(0%,100%)"
			}
		},
		out: {
			forward: {
				start: "translate(0%,0%)",
				end: "translate(0%,0%)"
			},
			reverse: {
				start: "translate(0%,0%)",
				end: "translate(0%,0%)"
			}
		}
	}
};
var PageManager = function() {
	function s(t, n, r) {
		$.isArray(r) || (r = [r]),
		n.prototype instanceof Page ? e[t] = {
			"class": n,
			args: r
		}: console.error("must register with Page subclass")
	}
	function o(e) {
		var t = util.getUrlParams("coid"),
		n = {
			foot1: $("#t_foot1"),
			foot2: $("#t_foot2"),
			head1: $("#t_head1"),
			head2: $("#t_head2")
		};
		$("#placeholder").length && $("#placeholder").remove(),
		r && r.jObj && (r.jObj.attr("selected", ""), r.jObjSubNav && r.jObjSubNav.attr("selected", ""));
		var i = f(e);
		i.jObj.attr("selected", "true"),
		i.jObjSubNav && i.jObjSubNav[0] && i.jObjSubNav.attr("selected", "true");
		if (NavControl.isSpecial) {
			setTimeout(function() {
				MoveableNav.revoke()
			},
			200);
			if (NavControl.navConf) for (var s in NavControl.navConf) {
				var o = NavControl.navConf[s];
				o == "hide" ? n[s].hide() : n[s].show()
			}
		} else for (var u in n) n[u].show()
	}
	function u(e) {
		var t = (new Date).getTime();
		for (;;) if ((new Date).getTime() - t > e) break
	}
	function a(t) {
		function s() {
			return this.id = t,
			n.apply(this, r)
		}
		var n = e[t]["class"],
		r = e[t].args,
		i;
		return s.prototype = n.prototype,
		i = new s,
		i
	}
	function f(n) {
		var r;
		return t[n] ? t[n] : e[n] ? (r = a(n), t[n] = r, r) : null
	}
	function l(t) {
		if (e[t]) return e[t]["class"]
	}
	function c(e, t) {
		n[e] = t
	}
	function h(e) {
		var t = n[e];
		return t ? t: 0
	}
	function p() {
		var e = r ? r.id: "myhome",
		t = i ? util.objToStr(i, ! 0) : "";
		return e + t
	}
	function d(e, t) {
		var n = f(e) ? f(e) : f("myhome");
		NavControl.assignHash(e, t);
		var s = p(),
		u = $(document).scrollTop();
		c(s, u);
		var a = e + (t ? util.objToStr(t, ! 0) : ""),
		l = n.scrollTop ? n.scrollTop: h(a);
		o(e),
		r && e != r.id && (PageManager.scrollTimer = setTimeout(function() {
			if (n.isRefresh) {
				document.body.scrollTop = 0,
				n.isRefresh = ! 1;
				return
			}
			$(document).scrollTop(l)
		},
		200)),
		r = n,
		i = t
	}
	function v() {
		var e = util.getHashParams().pageId,
		t = NavControl.hashList.length,
		n = NavControl.hashList[t - 2];
		return PageManager.getObj(e) ? PageManager.getObj(e) : PageManager.getObj(n)
	}
	function m() {
		return PageManager.getObj(util.getHashParams(NavControl.prevHash).pageId)
	}
	function g(t, n, r, i) {
		n = n ? n: function() {},
		r = r ? r: this;
		if (!e[t]) {
			Canvas.loading();
			var s = lazy_load_module_path + t + module_postfix;
			util.scriptLoader(s, function() {
				Canvas.unloading(),
				e[t] ? n.call(r) : i.call(r)
			})
		} else n.call(r)
	}
	var e = {},
	t = {},
	n = {},
	r = null,
	i = null;
	return {
		setPagePosition: c,
		getPagePosition: h,
		getLastPage: m,
		register: s,
		getObj: f,
		go: d,
		showDOM: o,
		getCurrentPage: v,
		getClass: l,
		require: g
	}
} (),
loginPop = function() {
	function u() {
		var e = $("#t_nav1"),
		t = $("#t_nav2"),
		n = $("#t_exit"); ! loginPop.isLogin() || g_userUnReg ? (e.length > 0 && e.text("登录").addClass("t_login").removeAttr("href"), t.length > 0 && t.text("注册").addClass("t_reg").removeAttr("href"), n.text("登录").addClass("t_login"), $("footer .auth_only").hide(), $("#t_user-name").text("腾讯微博触屏版"), loginPop.registerLoginCheck(".t_auth")) : $("footer #t_user-name").text(window.g_usrName),
		p()
	}
	function a() {
		var e = window.publicPage,
		t = util.getHashParams().pageId;
		return e.indexOf(t) != - 1
	}
	function f() {
		var e = location.search,
		t = location.hash,
		n = util.getHashParams(),
		r = location.protocol + "//" + location.host + location.pathname,
		i;
		l(),
		a() ? (loginPop.haveShowExit = ! 1, i = e, e = e.replace("sid=" + g_sid, ""), n.urlParams.logout = 1, t = "#" + util.objToHash(n), window.location.href = e + t, setTimeout(function() {
			i == e && window.location.reload()
		},
		25)) : c()
	}
	function l() {
		if (g_isqqbrowser37) {
			function e(e, t, n, r, i) {
				var s = i.split(" ");
				return s = s[0] + " " + s[1] + "-" + s[2] + "-" + s[3] + " " + s[4] + " " + s[5],
				[e + "=" + t, "domain=" + n, "path=" + r, "expires=" + s].join("; ")
			}
			T5Kit.user.setQCookie(function() {},
			function() {},
			{
				QCookie: e("sid", g_sid, ".qq.com", "/", (new Date).toGMTString())
			})
		}
		localStorageObj.remove("sid")
	}
	function c() {
		var e = "",
		n = "",
		r = util.getUrlParams(),
		i = location.protocol + "//" + location.host + location.pathname;
		r.sid = "00",
		e = "?" + util.objToStr(r),
		n = encodeURIComponent(i + e + location.hash),
		window.location.href = t + n
	}
	function h() {
		window.location.assign(n)
	}
	function p() {
		var e = $("#t_nav1"),
		t = $("#t_nav2"),
		n = $("#t_exit");
		e.bind("click", function() {
			if (!e.hasClass("t_login")) return ! 1;
			c()
		}),
		t.bind("click", function() {
			if (!t.hasClass("t_reg")) return ! 1;
			h()
		}),
		n.bind("click", function() {
			n.hasClass("t_login") ? c() : f()
		})
	}
	function d(e) {
		function a() {
			var e = PageManager.getCurrentPage(),
			i = cssFormal ? cssPath + "wb-" + currentSkin + ".min.css": cssPath + "wb-" + currentSkin + ".css";
			window.g_userUnReg ? h() : (localStorageObj.set("sid", u), $("footer #t_user-name").text(window.g_usrName), e.refresh()),
			getText(i, function(e) {
				localStorageObj.get("touchCssText" + currentSkin, e),
				localStorageObj.get("touchCssVersion", currentVersion);
				if (bManifest) $("#cssskin")[0].href = i;
				else {
					var t = $('<style id="cssskin" data-src="' + i + '">' + localStorageObj.get("touchCssText" + currentSkin) + "</style>")[0];
					$("head")[0].replaceChild(t, $("#cssskin")[0])
				}
			}),
			t.length > 0 && t.unbind("click").attr("href", "#myhome").text("主页"),
			n.length > 0 && n.unbind("click").text("消息").attr("href", "#notification"),
			$("footer .auth_only").show(),
			$("#t_exit").text("退出").removeClass("login");
			for (var a = 0; a < r.length; a++) r[a].href = r[a].href.replace(/sid=\w*&/, "sid=" + u + "&");
			var f = new avatarScroll({
				openCls: "headimg-scroll-tool-open",
				closeCls: "headimg-scroll-tool-close"
			});
			f.startup(),
			s && ! window.g_userUnReg && (o = ! 0, window.location.href = s, s = "")
		}
		var t = $("#t_nav1"),
		n = $("#t_nav2"),
		r = $("a[href*='sid']"),
		i,
		u = e.info.sid;
		i = "/touch/iphone/jsvariable.jsp?msgid=null&sid=" + u + "&tmstp=-1&jto=-1&g_f=&allow=true",
		util.scriptLoader(i, a)
	}
	function v() {
		return o
	}
	function m(e) {
		o = e
	}
	function g() {
		var e = ($(window).height() - r.height()) / 2;
		r.css("top", e + $(window).scrollTop() + "px")
	}
	function y() {
		r.hide(),
		i.hide()
	}
	function b() {
		return window.g_isLogin
	}
	function w() {
		s = event.srcElement.href || event.srcElement.parentElement.href,
		Mqq.util.commLogin.init({
			bidCode: "microblogLogin",
			callback: d
		}),
		setTimeout(function() {
			$("#ptlogin-lock").height(document.body.scrollHeight + "px")
		},
		200)
	}
	function E(e, t) {
		if (loginPop.isLogin() && ! g_userUnReg) return;
		t || (t = $(document.documentElement)),
		t.data("loginCheckItems") || t.data("loginCheckItems", []);
		var n = t.data("loginCheckItems");
		if (!t.get(0) || ! n) return;
		$.isArray(e) ? n = n.concat(e) : n.push(e),
		t.data("loginCheckItems", n);
		var r = "ontouchstart" in window;
		$(t).bind("touchstart mousedown click", function(e) {
			var t = $(e.currentTarget).data("loginCheckItems"),
			n = $(e.target),
			r = t.join(","); ! window.g_isLogin && (n.filter(r) && n.filter(r).length > 0 || n.parents(r) && n.parents(r).length > 0) && (e.preventDefault(), e.stopImmediatePropagation ? e.stopImmediatePropagation() : e.stopPropagation(), loginPop.show())
		},
		! 0)
	}
	var e = "http://ti.3g.qq.com/touch/iphone/index.jsp",
	t = "http://pt.3g.qq.com/s?aid=touchLogin&t=weibo&bid_code=microblogLogin&g_ut=3&go_url=",
	n = "http://pt.3g.qq.com/s?g_ut=2&aid=nLoginmb&cd_f=-&q_from=weiboreg&g_f=6859",
	r = null,
	i = null,
	s = null,
	o = ! 1;
	return {
		init: u,
		isSupportNotLogin: a,
		isLogin: b,
		getIsFromClick: v,
		setIsFromClick: m,
		registerLoginCheck: E,
		goToReg: h,
		goToLogin: c,
		logout: f,
		show: w,
		close: y
	}
} ();
MessageLayer.prototype = new Layer,
MessageLayer.prototype.constructor = MessageLayer,
$.extend(MessageLayer.prototype, {
	init: function(e) {
		function n(e) {
			t.opts = e
		}
		var t = this;
		this.opts = e,
		this.bindAction(),
		this.init = n
	},
	bindAction: function() {
		var e = this,
		t = e.jObj;
		t.delegate("a[action-data='close']", "click", function() {
			e.hide()
		}),
		t.delegate("a.t_go_superqq", "click", function() {
			location.href = "http://kf.3g.qq.com/g/s?sid=" + g_sid + "&aid=kftemplate&tid=faqlist&pid=2&fid=3"
		}),
		t.delegate("a.t_cancel", "click", function() {
			e.hide()
		})
	},
	setContent: function(e) {
		this.jObj.find("#t_msg_content").text(e)
	},
	show: function(e) {
		Layer.prototype.show.call(this, e),
		window.activedLayObj = this
	},
	setCenter: function(e) {
		var t;
		window.navigator.userAgent.indexOf("MQQBrowser") != "-1" ? t = 0: t = window.navigator.standalone == 1 ? 0: 30;
		var n = this;
		if (!e) {
			var r = ($(window).height() - n.jObj.height()) / 2,
			i = r + $(window).scrollTop() + t - 140;
			window.navigator.userAgent.indexOf("MQQBrowser") != "-1" && (i += 80),
			n.jObj.css("top", i < 0 ? 0: i + 80 + "px")
		}
		n.jObj.css("visibility", "visible")
	}
});
var messageLayer = null;
$(document).ready(function() {
	messageLayer = new MessageLayer
}),
ShareLayer.prototype = new Layer,
ShareLayer.prototype.constructor = ShareLayer,
$.extend(ShareLayer.prototype, {
	isLayer: ! 1,
	init: function(e) {
		function n(e) {
			t.opts = e
		}
		var t = this;
		this.opts = e,
		this.bindAction(),
		this.init = n
	},
	bindAction: function() {
		var e = this,
		t = e.jObj;
		e.count = new WritePlus.Count(e.writeTextArea, e.numTip),
		this.jObj.find("a.t_writepop_clear").click(function(n) {
			t.find("#t_wirte_textarea").val(""),
			e.count.updateDisplay(140)
		}),
		t.delegate("a[action-data='close']", "click", function() {
			e.hide()
		}),
		this.jObj.find("a.t_wirte_send-btn").click(function(t) {
			if (e.isPosting) return;
			if (e.count.getNum() < 0) {
				Tips.blink("fail", "字数超过140字限制");
				return
			}
			e.isPosting = ! 0;
			var n = {
				msg: e.jObj.find("#t_wirte_textarea").val(),
				ac: g_ac.AC_MSG_POST
			};
			e.submit(n)
		})
	},
	submit: function(e) {
		var t = e.ac;
		LoadingController.pubLoading();
		if ($.trim(e.msg) == "" && t != g_ac.AC_MSG_FORWARD) {
			LoadingController.unloading(),
			Tips.blink("fail", "请输入内容"),
			this.isPosting = ! 1;
			return
		}
		NetWork.sendMsg(this, e)
	},
	setContent: function(e) {
		this.jObj.find("#t_wirte_textarea").val(e)
	},
	show: function(e) {
		Layer.prototype.show.call(this, e),
		shareLayer.writeTextArea.focus(),
		window.activedLayObj = this
	},
	errorReaction: function(e) {
		shareLayer.isPosting = ! 1,
		LoadingController.unloading(),
		shareLayer.hide()
	},
	sendReaction: function(e) {
		this.isPosting = ! 1;
		var t = this.jObj,
		n = $("#d_myhome");
		LoadingController.unloading(),
		e.result == 0 ? (shareLayer.hide(), Tips.blink("success", "分享成功"), Page.prototype.insertNewMessage.call(this, n, e)) : Tips.blink("fail")
	}
});
var shareLayer = null;
$(document).ready(function() {
	shareLayer = new ShareLayer
}),
MorePopLayer.prototype = new Layer,
MorePopLayer.prototype.constructor = MorePopLayer,
$.extend(MorePopLayer.prototype, {
	isLayer: ! 1,
	init: function(e) {
		function n(e) {
			t.opts = e,
			t.changeOptions()
		}
		var t = this;
		this.opts = e,
		this.bindAction(),
		this.changeOptions(),
		this.init = n
	},
	bindAction: function() {
		var e = this,
		t = e.jObj,
		n = {
			reply: {
				ac: g_ac.AC_MSG_REPLY
			},
			delmsg: {
				ac: g_ac.AC_MSG_DEL
			},
			addblack: {
				ac: g_ac.AC_ADD_BLACK_USER_LIST
			},
			forward: {
				ac: g_ac.AC_MSG_FORWARD
			},
			addfav: {
				ac: g_ac.AC_MSG_KEEP,
				params: g_ac.AC_MSG_KEEP
			},
			delfav: {
				ac: g_ac.AC_MSG_DROP,
				params: g_ac.AC_MSG_DROP
			}
		};
		for (var r in n) t.delegate("[data-ac='" + n[r].ac + "']", "click", function(t) {
			return function() {
				var r = e.opts;
				e.hide(),
				r.point = r.point ? r.point: r.optsObj,
				r.point && r.optsObj[t].call(r.point, n[t].params)
			}
		} (r));
		t.delegate("a[action-data='close']", "click", function() {
			e.hide()
		})
	},
	changeOptions: function() {
		var e = {
			addfav: '<a data-ac="' + g_ac.AC_MSG_KEEP + '">收藏</a>',
			delfav: '<li><a data-ac="' + g_ac.AC_MSG_DROP + '">取消收藏</a></li>',
			reply: '<a data-ac="' + g_ac.AC_MSG_REPLY + '">对话</a>',
			delmsg: '<a data-ac="' + g_ac.AC_MSG_DEL + '">删除</a>'
		},
		t = this.opts,
		n = t.optsObj,
		r,
		i = [];
		for (r in n) i.push(e[r]);
		this.jObj.find("div.t_wb-dialog-list").html(i.join(""))
	}
});
var morePopLayer = null;
$(document).ready(function() {
	morePopLayer = new MorePopLayer
}),
PicMorePopLayer.prototype = new Layer,
PicMorePopLayer.prototype.constructor = PicMorePopLayer,
$.extend(PicMorePopLayer.prototype, {
	isLayer: ! 1,
	init: function() {
		var e = this;
		this.bindAction()
	},
	bindAction: function() {
		var e = PageManager.getCurrentPage(),
		t = e.jObj,
		n = this,
		r = n.jObj;
		this.jObj.find("a.t_modify_pic").click(function(r) {
			e.tabOne(3, r),
			t.find("div.t_wb-upload-pic").show(),
			t.find("div.t_wb-input-cont").hide(),
			n.hide()
		}),
		this.jObj.find("a.t_delete_pic").click(function(e) {
			g_msgImage = "",
			t.find("div.t_img-display").hide(),
			t.find("img.t_ico-img")[0].src = "",
			n.hide()
		}),
		r.delegate("a[action-data='close']", "click", function() {
			n.hide()
		})
	}
});
var picMorePopLayer = null;
$(document).ready(function() {
	picMorePopLayer = new PicMorePopLayer
}),
WritePopLayer.prototype = new Layer,
WritePopLayer.prototype.constructor = WritePopLayer,
$.extend(WritePopLayer.prototype, {
	isLayer: ! 1,
	init: function() {
		var e = this;
		this.bindAction()
	},
	bindAction: function() {
		var e = this,
		t = e.jObj;
		e.count = new WritePlus.Count(e.writeTextArea, e.numTip),
		this.jObj.find("a.t_writepop_clear").click(function(n) {
			t.find("#t_wirte_textarea").val(""),
			e.count.updateDisplay(140)
		}),
		this.jObj.find("a.t_writepop_ico-bq").click(function(t) {
			e.hide(),
			e.page = PageManager.getCurrentPage(),
			e.showFace()
		}),
		this.jObj.find("a.t_writepop_ico-at").click(function(t) {
			e.hide(),
			e.page = PageManager.getCurrentPage(),
			e.showAt()
		}),
		this.jObj.find("a.t_wirte_send-btn").click(function(t) {
			if (e.isPosting) return;
			if (e.count.getNum() < 0) {
				Tips.blink("fail", "字数超过140字限制");
				return
			}
			e.isPosting = ! 0;
			var n = e.writeParams,
			r = n.uid ? n.uid: n.msg.jObj.attr("usrid"),
			i = "";
			n.msg && (i = n.msgid || n.msg.jObj.attr("msgid"));
			var s = {
				msg: e.jObj.find("#t_wirte_textarea").val(),
				ac: n.ac,
				onlyComment: n.onlyComment,
				mid: i,
				fu: r,
				tu: r
			};
			n.msg ? e.writeParams.msg.submit(s) : (s.msg = "@" + r + " " + s.msg, e.submit(s))
		}),
		t.delegate("a[action-data='close']", "click", function() {
			NavControl.isSpecial || MoveableNav.show(),
			e.hide()
		})
	},
	submit: function(e) {
		var t = e.ac;
		LoadingController.pubLoading();
		if ($.trim(e.msg) == "" && t != g_ac.AC_MSG_FORWARD) {
			LoadingController.unloading(),
			Tips.blink("fail", "请输入内容"),
			this.isPosting = ! 1;
			return
		}
		NetWork.sendMsg(this, e)
	},
	errorReaction: function(e) {
		writePopLayer.isPosting = ! 1,
		LoadingController.unloading(),
		writePopLayer.hide()
	},
	sendReaction: function(e) {
		this.isPosting = ! 1;
		var t = this.jObj,
		n = $("#d_myhome");
		LoadingController.unloading(),
		writePopLayer.hide(),
		e.result == 0 ? (Tips.blink("success", "已发布"), Page.prototype.insertNewMessage.call(this, n, e)) : Tips.blink("fail")
	},
	hideCurrentPageDom: function() {
		var e = writePopLayer.page;
		e && e.jObj && (e.jObj.removeAttr("selected"), e.jObjSubNav && e.jObjSubNav.removeAttr("selected"))
	},
	showCurrentPageDom: function() {
		var e = writePopLayer.page;
		e && e.jObj.attr("selected", "true"),
		e && e.jObjSubNav && e.jObjSubNav[0] && e.jObjSubNav.attr("selected", "true")
	},
	show: function(e) {
		Layer.prototype.show.call(this, e),
		writePopLayer.writeTextArea.focus(),
		writePopLayer.writeTextArea.setSelectionRange(0, 0),
		window.activedLayObj = this
	},
	showAt: function() {
		MoveableNav.hide();
		var e = $("#forward_at"),
		t = $("#forward_face"),
		n = this;
		t.hide();
		var r = writePopLayer.jObj.css("top"),
		i = $(document).scrollTop(),
		s = writePopLayer.writeTextArea.selectionStart;
		n.lastPos = s,
		n.topValue = r,
		n.scrollValue = i,
		writePopLayer.hideCurrentPageDom(),
		window.activedLayer = e,
		e.show();
		var o = e.find("input.t_text-input-forwardAt")[0],
		u = e.find("div.t_wrapper_input-cont")[0],
		a = {
			type: "at",
			elInput: writePopLayer.writeTextArea,
			elWrapper: u,
			lastPostion: n.lastPos,
			onInputEnd: function(r) {
				NavControl.isSpecial || MoveableNav.show(),
				t.hide(),
				e.hide(),
				MoveableNav.show(),
				writePopLayer.showCurrentPageDom(),
				writePopLayer.show(!0),
				writePopLayer.writeTextArea.focus(),
				writePopLayer.writeTextArea.setSelectionRange(n.lastPos + r, n.lastPos + r)
			},
			onCancel: function() {
				NavControl.isSpecial || MoveableNav.show(),
				MoveableNav.show(),
				t.hide(),
				e.hide(),
				writePopLayer.showCurrentPageDom(),
				writePopLayer.show(!0),
				writePopLayer.writeTextArea.focus(),
				writePopLayer.writeTextArea.setSelectionRange(n.lastPos, n.lastPos)
			}
		};
		o.value = "",
		this.atPage == null ? this.atPage = new WritePlus.UserList(a) : this.atPage.refreshData(),
		e.find("button.t_forwardAt_enter").click(function(n) {
			t.hide(),
			e.hide(),
			writePopLayer.showCurrentPageDom(),
			writePopLayer.showLast(),
			writePopLayer.writeTextArea.focus()
		}),
		setTimeout(function() {
			window.scrollTo(0, 1)
		},
		0)
	},
	showFace: function() {
		MoveableNav.hide();
		var e = $("#forward_face"),
		t = $("#forward_at"),
		n = this;
		t.hide();
		var r = writePopLayer.jObj.css("top"),
		i = $(document).scrollTop();
		n.topValue = r,
		n.scrollValue = i,
		writePopLayer.hideCurrentPageDom(),
		window.activedLayer = e,
		e.show();
		var s = function() {
			NavControl.isSpecial || MoveableNav.show(),
			e.hide(),
			t.hide(),
			writePopLayer.showCurrentPageDom(),
			writePopLayer.showLast(),
			writePopLayer.writeTextArea.focus(),
			MoveableNav.show()
		};
		e.find("a.t_forwardFace_back").click(function(e) {
			s()
		}),
		this.facePage == null && (this.facePage = new WritePlus.Face({
			elemTextArea: writePopLayer.writeTextArea,
			elemWrapper: e.find("div.t_input_faces_div")[0],
			onInputEnd: s
		})),
		setTimeout(function() {
			window.scrollTo(0, 1)
		},
		0)
	},
	dialogOpen: function(e, t) {
		this.init();
		var n = "对" + t + "说:",
		r = {
			srcContent: "",
			fContent: "",
			strTip: n,
			buttonTxt: "发送",
			ac: g_ac.AC_MSG_AT,
			onlyComment: 0,
			image: ! 1,
			uid: e
		},
		i = this;
		this.jObj.find("h2.t_wirte_wb-dialog-title").html(r.strTip),
		this.jObj.find("#t_wirte_textarea").val(r.fContent),
		this.jObj.find("div.t_wirte_wb-info").hide(),
		this.jObj.find("a.t_wirte_send-btn").html(r.buttonTxt),
		this.writeParams = r,
		setTimeout(function() {
			i.writeTextArea.focus()
		},
		200),
		this.show()
	},
	setParams: function(e) {
		this.jObj.find("div.t_wirte_wb-info").show();
		var t = this;
		this.jObj.find("h2.t_wirte_wb-dialog-title").html(e.strTip),
		this.jObj.find("#t_wirte_textarea").val(e.fContent),
		this.jObj.find("div.t_wirte_wb-info").html(e.srcContent),
		this.jObj.find("a.t_wirte_send-btn").html(e.buttonTxt),
		this.writeParams = e,
		setTimeout(function() {
			t.writeTextArea.focus()
		},
		200)
	}
});
var writePopLayer = null,
privateLayer = null;
$(document).ready(function() {
	writePopLayer = new WritePopLayer,
	privateLayer = new PrivateLayer
}),
PrivateLayer.prototype = new Layer,
PrivateLayer.prototype.constructor = PrivateLayer,
$.extend(PrivateLayer.prototype, {
	isLayer: ! 1,
	open: function(e) {
		e = e ? e: {},
		this.currentPage = PageManager.getCurrentPage(),
		e.lastContent && (this.last.html(e.lastContent), this.last.show()),
		e.toUser && (this.userInput.value = e.toUser),
		this.sendReaction = e.sendReaction ? e.sendReaction: this.sendReaction,
		window.activedLayObj = this,
		Layer.prototype.show.call(this)
	},
	close: function() {
		this.last.hide(),
		this.userInput.value = "",
		this.textarea.value = "",
		Layer.prototype.hide.call(this)
	},
	send: function() {
		var e = this.textarea.value.replace(/\s/ig, ""),
		t = this.userInput.value,
		n = {};
		if (!t) return alert("您还没有输入用户id"),
		! 1;
		if (!e) return alert("您还没有输入内容"),
		! 1;
		n.tu = t,
		n.msg = e,
		n.ac = g_ac.AC_MSG_DIRECT,
		LoadingController.pubLoading(),
		NetWork.sendMsg(this, n)
	},
	tagglePage: function() {
		var e = this.currentPage,
		t;
		this.taggle ? (t = "true", this.taggle = ! 1) : (t = "", this.taggle = ! 0),
		e && e.jObj && e.jObj.attr("selected", t),
		e && e.jObjSubNav && e.jObjSubNav.attr("selected", t)
	},
	bindAction: function() {
		var e = this,
		t = function() {
			MoveableNav.hide(),
			window.activedLayer = $(e.faceLayer),
			e.faceLayer.style.display = "",
			e.face.scroller.refresh(),
			e.hide(),
			e.tagglePage(),
			e.topValue = writePopLayer.jObj.css("top"),
			e.scrollValue = $(document).scrollTop()
		},
		n = function() {
			MoveableNav.show(),
			e.faceLayer.style.display = "none",
			e.tagglePage(),
			e.showLast(),
			NavControl.isSpecial || MoveableNav.show()
		},
		r = function() {
			MoveableNav.show(),
			e.privateToLayer.style.display = "none",
			e.tagglePage(),
			e.showLast(),
			NavControl.isSpecial || MoveableNav.show()
		},
		i = function() {
			MoveableNav.hide(),
			window.activedLayer = $(e.privateToLayer),
			e.privateToLayer.style.display = "",
			e.hide(),
			e.tagglePage(),
			e.topValue = writePopLayer.jObj.css("top"),
			e.scrollValue = $(document).scrollTop(),
			e.privateTo ? e.privateTo.scroller.refresh.call(e.privateTo.scroller) : e.privateTo = new WritePlus.UserList({
				type: "pri",
				elInput: e.userInput,
				elWrapper: e.privateToLayer,
				onCancel: r,
				onInputEnd: r
			})
		};
		e.faceLayer = document.getElementById("private_face"),
		e.privateToLayer = document.getElementById("private_t_list");
		var s = e.faceLayer.querySelector(".t_forwardFace_back");
		new WritePlus.Count(this.textarea, this.disNum),
		this.face = new WritePlus.Face({
			elemTextArea: this.textarea,
			elemWrapper: e.faceLayer.querySelector("div.t_input_faces_div"),
			onInputEnd: n
		}),
		s.addEventListener("click", n),
		e.closeBtn.addEventListener("click", function() {
			e.close()
		}),
		e.postBtn.addEventListener("click", function() {
			e.send()
		}),
		e.clearBtn.addEventListener("click", function() {
			e.textarea.value = "",
			setTimeout(function() {
				e.textarea.focus()
			},
			0)
		}),
		e.faceBtn.bind("click", t),
		e.listBtn.bind("click", i)
	},
	sendReaction: function(e) {
		LoadingController.unloading(),
		e.result == "0" ? (Tips.blink("success", "已发送"), this.close(), setTimeout(function() {
			PageManager.require("notification", function() {
				PageManager.getObj("notification").refreshPri = ! 0
			}),
			PageManager.getCurrentPage().refresh()
		},
		500)) : Tips.blink("fail", "发送失败")
	}
}),
UserInfoLayer.prototype = new Layer,
UserInfoLayer.prototype.constructor = UserInfoLayer,
$.extend(UserInfoLayer.prototype, {
	isLayer: ! 1,
	init: function(e) {
		function n(e) {
			t.opts = e
		}
		var t = this;
		this.opts = e,
		this.bindAction(),
		this.init = n
	},
	bindAction: function() {
		var e = this;
		e.jObj.find(".t_close_pop_info").click(function(t) {
			e.hide()
		}),
		e.jObj.find(".t_home_avatar").click(function(t) {
			t.stopPropagation(),
			e.hide()
		})
	},
	hide: function() {
		Layer.prototype.hide.call(this)
	},
	setCenter: function(e) {
		var t;
		window.navigator.userAgent.indexOf("MQQBrowser") != "-1" ? t = 0: t = window.navigator.standalone == 1 ? 0: 30;
		var n = this;
		if (!e && n.jObj) {
			var r = 0;
			MoveableNav.isDisplayed() ? r = $(window).scrollTop() + 95: r = 95,
			currentSkin == 1 && (r -= 4),
			n.jObj.css("top", (r < 0 ? 0: r) + "px")
		}
		n.jObj && n.jObj.css("visibility", "visible")
	},
	show: function(e) {
		Layer.prototype.show.call(this, e);
		var t = this,
		n = t.jObj;
		n.show(),
		NetWork.commonRequest(t, {
			ac: g_ac.AC_HOME_HEAD
		},
		function(e) {
			e.result == 0 && (window.activedLayObj = this, n.find(".t_home_avatar").css("background", "url(" + g_usrimg + ")"), n.find(".t_username").text(e.jsonDump.nickName), g_isVip ? n.find(".t_vip").show() : n.find(".t_vip").hide(), n.find(".t_level").text(e.jsonDump.level), n.find(".t_user-followerNum").text(e.jsonDump.followerAmount), n.find(".t_user-followingNum").text(e.jsonDump.followingAmount), n.find(".t_user-postNum").text(e.jsonDump.publishAmount), n.find(".t_todayExp").text(e.jsonDump.todayExp))
		})
	}
});
var userInfoLayer = null;
$(document).ready(function() {
	userInfoLayer = new UserInfoLayer
}),
$.extend(Layer.prototype, {
	isLayer: ! 0,
	hide: function() {
		this.scrollPosAtShow = null,
		this.jObj && this.jObj.hide(),
		this.scroll && this.scrollunBind(),
		this.blackLayer.hide()
	},
	show: function(e) {
		var t = this;
		g_from_android && (t.scrollPosAtShow = $(document).scrollTop(), $(document).bind("scroll", function() {
			var e = function() {
				$(document).scrollTop(t.scrollPosAtShow),
				$(document).unbind("touchend", e)
			};
			$(document).bind("touchend", e)
		})),
		this.blackLayer.css("height", document.body.scrollHeight + "px"),
		this.blackLayer.show(),
		this.jObj && (this.jObj.show(), this.jObj.css("visibility", "visible")),
		! e && t.setCenter(e),
		setTimeout(function() {
			e && $(document).scrollTop(t.scrollValue)
		},
		400)
	},
	showLast: function() {
		this.show(this.topValue)
	},
	setCenter: function(e) {
		var t;
		window.navigator.userAgent.indexOf("MQQBrowser") != "-1" ? t = 0: t = window.navigator.standalone == 1 ? 0: 30;
		var n = this;
		if (!e && n.jObj) {
			var r = ($(window).height() - n.jObj.height()) / 2,
			i = r + $(window).scrollTop() + t - 140;
			window.navigator.userAgent.indexOf("MQQBrowser") != "-1" && (i += 80),
			n.jObj.css("top", (i < 0 ? 0: i) + "px")
		}
		n.jObj && n.jObj.css("visibility", "visible")
	}
});
var redirectLayer = function() {
	var e = {},
	t = '<div class="url-jump" id="url-jump" style="bottom:auto;display:none"><p>我们为您适配了更适合您手机屏幕并更节省流量的手机版，若您依然想访问PC版，请点击进入。</p><p><a href="http://t.qq.com?touch">进入PC版</a><a class="t_noPop" onclick="">不再提示</a></p></div>',
	n = function() {
		e.jObj.hide()
	};
	return e.jObj = $(t),
	$(document.body).append(e.jObj),
	e.show = function() {
		var t = cookieObj.get("nojump");
		setTimeout(function() {
			var t = $(window).scrollTop() + window.innerHeight - 20 - e.jObj.height();
			e.jObj.css("top", t + "px")
		},
		100),
		t != "false" ? e.jObj.show() : e.jObj.hide(),
		e.jObj.delegate("a.t_noPop", "click", e.hide),
		$(document).bind("touchmove", n)
	},
	e.hide = function() {
		cookieObj.set("nojump", "false"),
		e.jObj.hide(),
		$(document).unbind("touchmove", n)
	},
	e
} ();
MessageContainer.prototype = function() {
	function e(e) {
		var t = this.pageObj,
		n = "renderOptions" in t ? t.renderOptions: null,
		r = MessagePage.refreshRenderProxy(e, n);
		r.addClass("t_open"),
		t.instanceListContent(r, this.mst),
		t.bindGetMore(r);
		var i = t.jObj.find('ul[mst="' + this.mst + '"]');
		if (i.length > 0) i.replaceWith(r);
		else {
			t.jObj.find("ul[mst]").removeClass("t_open").hide();
			var o = t.jObj.find("div[content]");
			o.length > 0 ? o.append(r) : t.jObj.append(r)
		} ! 0 === this.pageObj.saveLastRefreshData && s.call(this, e)
	}
	function t(e) {
		var t = e.jsonDump.mst,
		n = this.pageObj.jObj.find("ul[mst='" + t + "'] > li.wb-more");
		if (!n || n.length < 1) {
			console.error("error, can't find get more li");
			return
		}
		var i = this.pageObj,
		s = "renderOptions" in i ? i.renderOptions: null,
		o = ejsRender(e.jsonDump, s),
		u = $(o);
		this.pageObj.instanceListContent(u, this.mst),
		this.pageObj.bindGetMore(u),
		u.get(0).nodeName === "UL" ? n.replaceWith(u.children("li")) : n.replaceWith(u),
		u = this.pageObj.jObj.find("ul[mst='" + t + "']"),
		! 0 === this.pageObj.prefetchGetMoreData && r.call(this, u)
	}
	function n(e) {
		var t = e.find(".t_btn-getmore");
		if (t.length < 1) {
			console.error("can't find getMore Btn");
			return
		}
		var n = t.attr("data-mid"),
		r = t.attr("data-mrt");
		if (typeof n == "undefined" || typeof r == "undefined") {
			console.error("get more btn havn't mid or mrt");
			return
		}
		if (!this.pageObj.updateArgument) {
			console.error("this.pageObj.updateArgument no exist!");
			return
		}
		var i = {
			mid: n,
			mrt: r
		};
		return i = $.extend({
			more: 1
		},
		this.pageObj.updateArgument, i),
		i
	}
	function r(e) {
		var t = this.getMoreParam = n.call(this, e);
		NetWork.commonRequest(this, t, function(e) {
			this.getMoreData = e
		})
	}
	function i() {
		var e = this.pageObj.id,
		t = this.mst;
		if (typeof e == "undefined") {
			console.error("pageId or mst undefined");
			return
		}
		var n = "last_refresh_data_" + e + "_" + t;
		return n
	}
	function s(e) {
		var t = i.call(this)
	}
	function o() {
		var e = i.call(this);
		return localStorageObj.get(e)
	}
	return {
		refreshWithData: e,
		showMoreWithData: t,
		getRefreshData: o
	}
} ();
var NotifiStatus = function() {
	function h() {
		a = {},
		n({
			url: e,
			dataType: "json",
			data: {
				ac: g_ac.AC_NEW_DATA,
				nocache: new Date * 1
			},
			success: function(e) {
				i++,
				d(e),
				m()
			},
			error: m
		})
	}
	function p(e) {
		var n = c[e].ac;
		if (!t) return;
		a[e] = ! 0,
		r -= u[e],
		u[e] = 0,
		i = 0,
		v(),
		m(),
		MoveableNav.setMentionStatus(r > 0)
	}
	function d(e) {
		var t = e.info;
		r = 0;
		if (e.result !== 0) {
			console.error("can not get new unread data");
			return
		}
		for (var n in t) {
			if (a[n]) continue;
			u[n] = t[n],
			r += t[n]
		}
		v(),
		i = r == 0 ? 0: i,
		MoveableNav.setMentionStatus(r > 0)
	}
	function v() {
		var e = [u.unread, u.mention + u.follower + u.direct],
		t = [$("nav > a.t_status_myhome > span"), $("nav > a.t_status_notification > span")],
		n = {
			1: "tips-1",
			2: "tips-2",
			3: "tips-more"
		},
		r = function(e) {
			var t = e.toString().length;
			return t >= 3 ? n[3] : n[t]
		};
		for (var i = 0; i < e.length; i++) e[i] > 0 ? t[i].length && (e[i] > 99 && (e[i] = "99+"), t[i][0].outerHTML = '<span class="' + r(e[i]) + '">' + e[i] + "</span>") : t[i].length && t[i].hide();
		if (location.hash.indexOf("notification") != - 1) {
			var s = $("#d_notification li a > span");
			s[0].innerHTML = u.direct ? u.direct: "",
			s[1].innerHTML = u.mention ? u.mention: "",
			s[2].innerHTML = u.follower ? u.follower: ""
		}
	}
	function m() {
		var e = s + i * s * 2;
		clearTimeout(o),
		o = setTimeout(function() {
			h()
		},
		e)
	}
	var e = g_action,
	t = g_isLogin | ! 1,
	n = $.ajax,
	r = 0,
	i = 0,
	s = 3e4,
	o, u = {},
	a = {},
	f = $("nav > a.t_status_myhome > span"),
	l = $("nav > a.t_status_notification > span"),
	c = {
		unread: {
			ac: g_ac.AC_CLEAR_UNREAD,
			jObj: f
		},
		direct: {
			ac: g_ac.AC_CLEAR_DIRECT,
			jObj: l
		},
		mention: {
			ac: g_ac.AC_CLEAR_MENTIONED,
			jObj: l
		},
		follower: {
			ac: g_ac.AC_CLEAR_FOLLOWER,
			jObj: l
		}
	};
	return t && setTimeout(h, 3e3),
	{
		clearData: p,
		getData: function() {
			return u
		},
		getMemStatus: function() {
			var e = u;
			return e.myhome = u.unread,
			e["private"] = u.direct,
			e.follower = u.follower,
			e.mentioned = u.mention,
			e
		}
	}
} (),
Tips = function() {
	var e = 2e3,
	t = 700,
	n = 36,
	r = "touchstart" in window ? "touchstart": "click",
	i = function(e) {
		this.DOM = e,
		this._ajustDefaultPos(),
		this._BindtouchAction(),
		this._BindDefaultAction()
	};
	i.prototype._ajustDefaultPos = function() {
		var e = $("body").scrollTop(),
		t = window.navigator.userAgent.indexOf("MQQBrowser") != "-1" && e != 0 ? 45: 0;
		this.DOM.css("position", "absolute").css("display", "block").css("top", e - n - t + "px")
	},
	i.prototype._BindtouchAction = function() {
		var e = this,
		t = function() {
			$(document).unbind(r, t).unbind("scroll", t),
			e.remove()
		};
		$(document).bind(r, t).bind("scroll", t),
		event && (event.preventDefault(), event.stopPropagation())
	},
	i.prototype._BindDefaultAction = function() {
		var t = this;
		if (!this.DOM) return ! 1;
		setTimeout(function() {
			t.hide.call(t)
		},
		e)
	},
	i.prototype.show = function() {
		var e = this.DOM;
		$(document.body).append(e),
		setTimeout(function() {
			e.css("-webkit-transform", "translate(0px, " + n + "px)"),
			e.css("-webkit-transition", "-webkit-transform 0.3s ease-in-out")
		},
		0)
	},
	i.prototype.remove = function() {
		var e = this.DOM;
		e.fadeOut(t, function() {
			e.remove()
		})
	},
	i.prototype.hide = function() {
		var e = this.DOM;
		e.bind("webkitTransitionEnd", function() {
			e.remove()
		}),
		e.css("-webkit-transform", "")
	};
	var s = function(e, t) {
		var n = {
			success: '<div class="txt-tips"><div class="seccess-tips"><span>发送成功</span></div></div>',
			fail: '<div class="txt-tips"><div class="error-tips"><span>发送失败</span></div></div>',
			offline: '<div class="txt-tips"><div class="error-tips"><span>无法连接 请检查网络</span></div></div>'
		},
		r = $(n[e]),
		s = new i(r);
		t && r.find("span").text(t),
		s.show()
	};
	return {
		blink: s
	}
} (),
MoveableNav = function() {
	function y(e) {
		clearTimeout(d),
		d = setTimeout(function() {
			r = ! 1,
			e()
		},
		250)
	}
	function b() {
		F(),
		e.find("script").remove(),
		v = e.clone(!0),
		h = t.height(),
		p = e.height(),
		v.css({
			"z-index": 100,
			display: "none"
		}),
		t.css("top", - h + "px"),
		E(),
		c.append(v),
		C(t),
		C(v),
		n = ! 0
	}
	function w() {
		return document.body.scrollTop < p
	}
	function E() {
		v && v.css("position", l),
		t.css("position", l)
	}
	function S(e) {
		e.stopImmediatePropagation(),
		r = ! 0,
		i && H(),
		n || b(),
		a ? s || (w() ? P() : D()) : w() ? P() : D()
	}
	function x() { ! f && ! o && (o = ! 0, window.addEventListener("touchmove", S, ! 1), window.addEventListener("scroll", S, ! 1))
	}
	function T() {
		F(),
		o = ! 1,
		window.removeEventListener("touchmove", S, ! 1),
		window.removeEventListener("scroll", S, ! 1)
	}
	function N(e, t, n) {
		e.hide(),
		n != undefined && e.css({
			"-webkit-transform": "translate3d(0," + n + "px,0)"
		}),
		e.show(),
		e.css({
			"-webkit-transform": "translate3d(0," + t + "px,0)",
			"-webkit-transition-duration": "0.3s"
		})
	}
	function C(e) {
		e.css({
			"-webkit-transition-property": "top,-webkit-transform",
			"-webkit-transition-timing-function": "ease-in-out",
			"-webkit-transform-style": "preserve-3d",
			"-webkit-backface-visibility": "hidden"
		})
	}
	function k(e) {
		e.css("-webkit-transition-duration", "0")
	}
	function L() {
		t.unbind("webkitTransitionEnd", L),
		t[0].style["-webkit-transform"].indexOf(h) == - 1 && (t.hide(), k(t))
	}
	function A() {
		s = ! 1,
		v.unbind("webkitTransitionEnd", L),
		v[0].style["-webkit-transform"].indexOf(p) == - 1 && (v.hide(), k(v), M())
	}
	function O() {
		v.append(t),
		t.css("position", "absolute"),
		t.css("top", "auto"),
		t.css("-webkit-transform", "translate3d(0,0,0)"),
		p = v.height()
	}
	function M() {
		E();
		if (a) {
			var e = w() ? 0: h;
			t.css({
				top: - h + "px",
				"-webkit-transition-duration": "0",
				"-webkit-transform": "translate3d(0," + e + "px,0)"
			})
		} else t.css("top", document.body.scrollTop + "px");
		t.hide(),
		c.append(t),
		w() ? P() : t.show()
	}
	function _(e) {
		e ? t.children("a").attr("class", "topbar-newtips-btn") : t.children("a").attr("class", "topbar-btn")
	}
	function j() {
		n = ! 1;
		var e = util.getHashParams().pageId;
		m.indexOf(e) != - 1 ? T() : x()
	}
	function F() {
		k(t),
		t.hide(),
		t.css({
			"-webkit-transition-duration": "0",
			"-webkit-transform": "translate3d(0,0,0)"
		}),
		c.append(t),
		v && v.remove(),
		n = ! 1,
		r = ! 1,
		i = ! 1,
		s = ! 1
	}
	function I() {
		t.click(function() {
			i ? H() : B()
		}),
		$(window).bind("hashchange", function(e) {
			F()
		}),
		$(document).delegate("header > nav > a", "click", function() {
			v && v.remove(),
			F()
		}),
		$(document).delegate("header > nav > a", "click", function(e) {
			var t = e.target,
			n = PageManager.getCurrentPage(),
			r;
			while (t.tagName != "A") t = t.parentNode;
			if (!n) return;
			t.href.indexOf(n.id) != - 1 && (NotifiStatus.getMemStatus().tempPageId > 0 && (r = n.forceRefresh, n.forceRefresh = ! 0), n.enter({}), n.forceRefresh = r),
			window.scrollTo(0, 0)
		})
	}
	function q() {
		e.hide(),
		T()
	}
	function R() {
		$("#t_moveable_bar > header > #t_head1").hide(),
		T()
	}
	function U() {
		$("#t_moveable_bar > header > #t_head1").show(),
		x()
	}
	function z() {
		e.show(),
		x()
	}
	function W() {
		document.body.scrollTop = 0
	}
	function X() {
		return u
	}
	var e = $("#t_moveable_bar > header"),
	t = $("#t_bar"),
	n = ! 1,
	r = ! 1,
	i = ! 1,
	s = ! 1,
	o = ! 1,
	u = ! 1,
	a = DeviceFeature.isSupportFixed(),
	f = window.navigator.userAgent.indexOf("MQQBrowser") != "-1",
	l = a ? "fixed": "absolute",
	c = $("body"),
	h,
	p,
	d,
	v,
	m = ["compose", "setting_entrance", "setting_msg", "privacy_modify", "display_setting", "profile_modify", "personal_info", "olympic_guest_home", "channels", "zoom_img"];
	g_isqqbrowser37 && (f = ! 1);
	var g = {
		HOME: "myhome",
		NOTIFICATION: "notification",
		HOT: "hot",
		CHANNELS: "channels",
		ACTIVITY: "activity",
		NONE: "none",
		KEEP: "keep"
	},
	D = function() {
		return a ? function() {
			n || b(),
			t.hide(),
			N(t, h),
			t.bind("webkitTransitionEnd", L)
		}: function() {
			n || b(),
			t.hide(),
			C(t),
			y(function() {
				t.css("top", document.body.scrollTop - h + "px"),
				N(t, h, 0),
				t.bind("webkitTransitionEnd", L)
			})
		}
	} (),
	P = function() {
		return a ? function() {
			t[0].style["-webkit-transform"].indexOf(h) != - 1 && t.css("display") != "none" && (N(t, 0), t.bind("webkitTransitionEnd", L))
		}: function() {
			clearTimeout(d),
			k(t),
			t.hide(),
			t.css("-webkit-transform", "translate3d(0,0,0)")
		}
	} (),
	H = function() {
		return a ? function() {
			u = ! 1,
			i = ! 1,
			s = ! 0,
			N(v, 0),
			v.bind("webkitTransitionEnd", A)
		}: function() {
			u = ! 1,
			i = ! 1,
			r ? (v.hide(), M()) : (N(v, 0), v.bind("webkitTransitionEnd", A))
		}
	} (),
	B = function() {
		return a ? function() {
			u = ! 0,
			i = ! 0,
			s = ! 0,
			O(),
			v.css("top", - p + "px"),
			N(v, p),
			v.bind("webkitTransitionEnd", A)
		}: function() {
			u = ! 0,
			i = ! 0,
			s = ! 0,
			O(),
			v.css("top", document.body.scrollTop - p + "px"),
			N(v, p, 0),
			v.bind("webkitTransitionEnd", A)
		}
	} ();
	return I(),
	{
		navTabs: g,
		isDisplayed: X,
		shift: j,
		activate: x,
		revoke: T,
		hide: q,
		hideMainNav: R,
		showMainNav: U,
		show: z,
		scrollToTop: W,
		setMentionStatus: _,
		disalowMove: function() {},
		allowMove: function() {},
		destoryDummy: function() {}
	}
} ();
(function(e) {
	var t = "ontouchstart" in window,
	n = t ? "touchstart": "mousedown",
	r = t ? "touchmove": "mousemove",
	i = t ? "touchend": "mouseup";
	e.fn.tap = function(s, o, u) {
		function v(n) {
			a = ! 1,
			p = e(n.target),
			u && p.addClass(u),
			f = t ? n.touches[0].clientX: n.pageX,
			l = t ? n.touches[0].clientY: n.pageY
		}
		function m(e) {
			c = t ? e.touches[0].clientX: e.pageX,
			h = t ? e.touches[0].clientY: e.pageY;
			if (Math.abs(c - f) > 10 || Math.abs(c - l) > 10) a = ! 0;
			e.preventDefault()
		}
		function g(e) {
			u && p.removeClass(u),
			a || (e.data = o, s(e))
		}
		var a = ! 1,
		f, l, c, h, p, d = this[0];
		if (!d) return;
		d.addEventListener(n, v),
		d.addEventListener(r, m),
		d.addEventListener(i, g)
	}
})($);
var WritePlus = {};
(function() {
	var $ = jq,
	tStrLength = function(e) {
		var t = 0;
		for (var n = e.length; n--;) e.charCodeAt(n) > 128 ? t += 1: t += .5;
		return Math.ceil(t)
	},
	doInput = function(e, t, n) {
		var r = e.value,
		i = e.selectionStart,
		s = t.length;
		if (!t) return;
		n ? e.value = t: e.value = r.substring(0, i) + t + r.substring(i, r.length),
		e.selectionStart = i + s
	},
	UserList = function(e) {
		this.type = e.type,
		this.input = e.elInput,
		this.wrapper = e.elWrapper,
		this.onCancel = e.onCancel,
		this.onInputEnd = e.onInputEnd,
		this.sure = this.wrapper.querySelector("button.t_sure_input"),
		this.cancel = this.wrapper.querySelector("button.t_cancel_input"),
		this.search = this.wrapper.querySelector(".t_search_input") || this.wrapper.querySelector("input"),
		this.sWrapper = this.wrapper.querySelector(".t_scroll_wrapper"),
		this.screen = this.sWrapper.getElementsByTagName("div")[0],
		this.ac = e.type == "at" ? g_ac.AC_ID_AUTO_COMPLETE: g_ac.AC_BIDIRECTION_FOLLOWS,
		this.type == "at" ? this.tpl = '[% for(var i=0;i<msg.length;i++) { %]<a data-content="@[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%=msg[i][3] %][%}else{%][%= msg[i][0] %][%}%]"><img src="http://t1.qlogo.cn/mbloghead/default/30" data-src="[%= msg[i][2] %]/30" height="20" width="20">[%= msg[i][1] %](@[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%= msg[i][3] %][%}else{%][%= msg[i][0] %][%}%])</a>[% } %]': this.tpl = '[% for(var i=0;i<msg.length;i++) { %]<a data-content="[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%=msg[i][3] %][%}else{%][%= msg[i][0] %][%}%]"><img src="http://t1.qlogo.cn/mbloghead/default/30" data-src="[%= msg[i][2] %]/30" height="20" width="20">[%= msg[i][1] %](@[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%= msg[i][3] %][%}else{%][%= msg[i][0] %][%}%])</a>[% } %]',
		this.sWrapper.style.position = "relative",
		this.listn = 1,
		this.pageNums = 40,
		this.arrAllData = [],
		this.bindMethod(),
		this.getData()
	};
	UserList.prototype = function() {
		var bindMethod = function() {
			var e = this,
			t = e.input,
			n = e.search,
			r = e.sure,
			i = e.cancel,
			s = e.sWrapper,
			o = function() {
				n.value = "",
				e.renderList()
			};
			e.scroller = new iScroll(s, {
				onScrollStart: function() {
					n.blur()
				},
				onScrollEnd: function() {
					Math.abs(e.scroller.y - e.scroller.maxScrollY) < 20 && ! e.userInput && e.renderList()
				},
				bounce: ! 1
			}),
			$(r).click(function(r) {
				r.preventDefault();
				var i = "",
				s = 0;
				n.value && (e.type == "at" ? (i = "@" + n.value + " ", doInput(t, "@" + n.value + " ")) : (i = n.value, doInput(t, n.value, ! 0)), s = i.length),
				o(),
				e.onInputEnd && e.onInputEnd(s)
			}),
			$(s).tap(function(n) {
				var r = n.target;
				while (r.tagName != "A") r = r.parentNode;
				var i = $(r),
				s = "",
				u = 0;
				e.type == "at" ? (s = $(i).data("content") + " ", u = s.length, doInput(t, s)) : (s = $(i).data("content"), u = s.length, doInput(t, s, ! 0)),
				o(),
				e.onInputEnd && e.onInputEnd(u)
			},
			null, "active"),
			$(i).bind("ontouchstart" in window ? "touchstart": "mousedown", function(t) {
				t.preventDefault(),
				o(),
				e.onCancel && e.onCancel()
			}),
			n.addEventListener("focus", function() {
				window.scrollTo(0, $(e.wrapper).offset().top)
			}),
			n.addEventListener("input", function() {
				clearTimeout(e.timer),
				this.timer = setTimeout(function() {
					e.userInput = n.value.replace(/['\\\/"\{\}\[\]:\., ]/ig, ""),
					e.listn = 1,
					e.userInput === "" ? e.renderList() : e.renderSearch(e.userInput),
					e.scroller.scrollTo(0, 0, 200)
				},
				20)
			})
		},
		getData = function() {
			var self = this,
			screen = self.screen,
			type = self.type,
			params = {
				ac: this.ac,
				touch: 1
			},
			updateScale = 6048e5,
			localData = {};
			try {
				localData = localStorageObj.get(type)
			} catch(e) {}
			g_isLogin && (!localData || localData.sid != g_sid || localData.msg.length === 0 || (new Date).getTime() - localData.timestamp > updateScale || ! localData.info.value) ? (screen.innerHTML = "<div>loading...</div>", $.ajax({
				url: g_action,
				data: params,
				dataType: "json",
				success: function(data) {
					data.sid = g_sid,
					data.timestamp = (new Date).getTime(),
					data.msg = eval(data.msg);
					if (data && data.info && data.info.value && params.md5 !== data.info.value) {
						console.log("get new " + type + " data from server!");
						try {
							localStorageObj.set(type, data)
						} catch(e) {}
					}
					self.arrAllData = eval(data.msg),
					self.renderList()
				}
			})) : localData && (self.arrAllData = eval(localData.msg), this.renderList())
		},
		refreshData = function() {
			var e = localStorageObj.get("at");
			this.arrAllData = e ? e.msg: null,
			this.listn = 1,
			this.arrAllData && this.renderList()
		},
		renderList = function() {
			var e = this,
			t = e.listn,
			n = e.pageNums,
			r = e.arrAllData,
			i = e.screen,
			s = this.tpl,
			o = t * n,
			u = o - n,
			a = r.slice(u, o),
			f = o <= r.length,
			l = (new EJS({
				text: s,
				type: "["
			})).render({
				msg: a
			});
			if (t !== 1) {
				var c = i.querySelector("a.t_at_holder");
				c && c.parentNode.removeChild(c),
				i.innerHTML += l
			} else i.innerHTML = l;
			f ? (i.innerHTML += '<a class="t_at_holder">正在加载...</a>', e.scroller.options.bounce = ! 1) : e.scroller.options.bounce = ! 0,
			imgLoader($(i)),
			e.scroller.refresh(),
			e.listn++
		},
		renderSearch = function(e) {
			var t = this,
			n = t.pageNums,
			r = t.arrAllData,
			i = t.userInput,
			s = t.screen,
			o = t.scroller,
			u = "http://t1.qlogo.cn/mbloghead/default/30",
			a = "",
			f = t.arrAllData.length,
			l = f > n ? n: f,
			c = new RegExp(e, "i"),
			h = "",
			p = [];
			this.type == "at" ? a = '[% for(var i=0;i<msg.length;i++) { %]<a data-content="@[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%=msg[i][3]%][%}else{%][%= msg[i][0] %][%}%]"><img src="http://t1.qlogo.cn/mbloghead/default/30" data-src="[%= msg[i][2] %]/30" height="20" width="20">[%= msg[i][1] %]</a>[% } %]': a = '[% for(var i=0;i<msg.length;i++) { %]<a data-content="[%if(typeof msg[i][3] != "undefined" && msg[i][3]!=""){%][%=msg[i][3]%][%}else{%][%= msg[i][0] %][%}%]"><img src="http://t1.qlogo.cn/mbloghead/default/30" data-src="[%= msg[i][2] %]/30" height="20" width="20">[%= msg[i][1] %]</a>[% } %]';
			for (var d = 0; d < f; d++) {
				var v = r[d][1],
				m = r[d][0];
				r[d][3] != null && r[d][3] != "" && (m = r[d][3]),
				c.test(v) ? p.push([m, v.replace(c, '<span class="wb-highlight-text">$&</span>') + "(@" + m + ")", r[d][2]]) : c.test(m) && p.push([m, v + "(@" + m.replace(c, '<span class="wb-highlight-text">$&</span>') + ")", r[d][2]]);
				if (p.length === l) break
			}
			i !== "" && p.length === 0 && (t.type == "at" ? p.push([i, "@<span>" + i + "</span>", u]) : p.push([i, "<span>" + i + "</span>", u])),
			h = (new EJS({
				text: a,
				type: "["
			})).render({
				msg: p
			}),
			s.innerHTML = h,
			imgLoader($(s)),
			t.scroller.options.bounce = ! 0,
			o && o.refresh()
		};
		return {
			renderSearch: renderSearch,
			renderList: renderList,
			getData: getData,
			bindMethod: bindMethod,
			refreshData: refreshData
		}
	} ();
	var Topic = function(e) {
		this.textarea = e.elemTextArea,
		this.input = e.elemInput,
		this.wrapper = e.elemWrapper,
		this.cancelcb = e.cancelCallBack,
		this.onInputEnd = e.onInputEnd,
		this.sWrapper = this.wrapper.querySelector(".t_scroll_wrapper"),
		this.sure = this.wrapper.querySelector(".t_sure_input"),
		this.cancel = this.wrapper.querySelector(".t_cancel_input"),
		this.screen = this.sWrapper.getElementsByTagName("div")[0],
		this.scroller = null,
		this.sWrapper.style.position = "relative",
		this.getData()
	};
	Topic.prototype = function() {
		var e = function() {
			var e = this;
			e.screen.innerHTML = "<div>loading...</div>",
			$.ajax({
				url: g_action,
				data: {
					ac: g_ac.AC_HOT_TOPIC,
					mst: g_mst.HOT_TOPIC_LIST
				},
				dataType: "json",
				success: function(t) {
					e.data = t,
					e.arrAllData = t.jsonDump.topics,
					e.renderList(),
					e.bindMethod()
				}
			})
		},
		t = function() {
			var e = this,
			t = $(e.input),
			n = e.sWrapper,
			r = e.textarea;
			e.scroller = new iScroll(n, {
				onScrollStart: function() {
					t[0].blur()
				}
			}),
			e.sure.addEventListener("click", function(n) {
				n.preventDefault();
				if (!t[0].value) return;
				doInput(r, "#" + t[0].value + "#"),
				e.input.value = "",
				e.renderList(),
				e.onInputEnd && e.onInputEnd(),
				r.focus()
			}),
			$(e.cancel).bind("ontouchstart" in window ? "touchstart": "mousedown", function(t) {
				t.preventDefault(),
				window.scrollTo(0, 0),
				e.input.value = "",
				e.renderList(),
				e.cancelcb()
			}),
			$(n).tap(function(t) {
				var n = t.target;
				while (n.tagName != "A") n = n.parentNode;
				var i = $(n);
				doInput(r, $(i).data("content") + " "),
				e.input.value = "",
				e.renderList(),
				e.onInputEnd && e.onInputEnd()
			},
			null, "active"),
			t.bind("focus", function() {
				window.scrollTo(0, $(e.wrapper).offset().top)
			}),
			t.bind("input", function() {
				clearTimeout(e.timer),
				e.timer = setTimeout(function() {
					e.userInput = t.val().replace(/['\\\/"\{\}\[\]:\., ]/ig, ""),
					e.userInput === "" ? e.renderList() : e.renderSearch(e.userInput)
				},
				20)
			})
		},
		n = function() {
			var e = this,
			t = '[% for(var i=0;i<topics.length;i++) { %]<a data-content="#[%= topics[i].keyword %]#">#[%= topics[i].keyword %]#</a>[% } %]',
			n = e.data.jsonDump,
			r = (new EJS({
				text: t,
				type: "["
			})).render(n);
			e.screen.innerHTML = r
		},
		r = function(e) {
			var t = this.arrAllData,
			n = this.userInput,
			r = this.screen,
			i = t.length,
			s = new RegExp(e, "i"),
			o = '[% for(var i=0;i<data.length;i++) { %]<a data-content="#[%= data[i][0] %]#">#[%= data[i][1] %]#</a>[% } %]',
			u = "",
			a = "",
			f = [];
			for (var l = 0; l < i; l++) u = t[l].keyword,
			u.indexOf(e) > - 1 && f.push([u, u.replace(s, '<span class="wb-highlight-text">' + e + "</span>")]);
			n !== "" && f.length === 0 && f.push([n, '<span class="wb-highlight-text">' + n + "</span>"]),
			a = (new EJS({
				text: o,
				type: "["
			})).render({
				data: f
			}),
			r.innerHTML = a,
			this.scroller && this.scroller.scrollTo(0, 0, 100)
		};
		return {
			renderSearch: r,
			renderList: n,
			bindMethod: t,
			getData: e
		}
	} ();
	var Face = function(e) {
		var t = this;
		return this.textArea = e.elemTextArea,
		this.wrapper = e.elemWrapper,
		this.screen = e.elemWrapper.getElementsByTagName("div")[0],
		this.onInputEnd = e.onInputEnd,
		this.scale = 40,
		this.listn = 8,
		this.wrapper.style.position = "relative",
		this.wrapper.style.height = "202px",
		this.scroller = new iScroll(this.wrapper),
		$(this.wrapper).click(function(e) {
			t.chooseFace.call(t, e)
		}),
		t
	};
	Face.prototype = function() {
		var e = ["/调皮", "/呲牙", "/惊讶", "/难过", "/酷", "/冷汗", "/抓狂", "/吐", "/偷笑", "/可爱", "/白眼", "/傲慢", "/微笑", "/撇嘴", "/色", "/发呆", "/得意", "/流泪", "/害羞", "/嘘", "/困", "/尴尬", "/发怒", "/大哭", "/流汗", "/再见", "/敲打", "/擦汗", "/委屈", "/疑问", "/睡", "/亲亲", "/憨笑", "/衰", "/阴险", "/奋斗", "/右哼哼", "/拥抱", "/坏笑", "/鄙视", "/晕", "/大兵", "/可怜", "/饥饿", "/咒骂", "/抠鼻", "/鼓掌", "/糗大了", "/左哼哼", "/哈欠", "/快哭了", "/吓", "/闭嘴", "/惊恐", "/折磨", "/示爱", "/爱心", "/心碎", "/蛋糕", "/闪电", "/炸弹", "/刀", "/足球", "/瓢虫", "/便便", "/咖啡", "/饭", "/猪头", "/玫瑰", "/凋谢", "/月亮", "/太阳", "/礼物", "/强", "/弱", "/握手", "/胜利", "/抱拳", "/勾引", "/拳头", "/差劲", "/爱你", "/NO", "/OK", "/爱情", "/飞吻", "/跳跳", "/发抖", "/怄火", "/转圈", "/磕头", "/回头", "/跳绳", "/挥手", "/激动", "/街舞", "/献吻", "/左太极", "/右太极", "/菜刀", "/西瓜", "/啤酒", "/骷髅", "/篮球", "/兵乓"],
		t = function(e) {
			var t = this,
			n = e.target,
			r = function(e, n) {
				var r = t.scale,
				i = t.listn;
				return e % r != 0 && n % r != 0 ? t.EMOCODE[Math.floor(n / r) * i + Math.floor(e / r)] : ""
			};
			if (n.className == "wb-input-faces") {
				var i = e.offsetX,
				s = e.offsetY;
				doInput(t.textArea, r(i, s)),
				t.onInputEnd && t.onInputEnd()
			}
		};
		return {
			EMOCODE: e,
			chooseFace: t
		}
	} ();
	var Count = function(e, t) {
		this.checktime = 300,
		this.textArea = e,
		this.display = t,
		this.bindMethod()
	};
	Count.prototype = function() {
		var e = function() {
			var e = this,
			t = e.textArea;
			t.addEventListener("focus", function() {
				e.timer = setInterval(function() {
					var t = e.textArea,
					n = tStrLength(t.value);
					e.num = 140 - n,
					e.updateDisplay(e.num)
				},
				e.checktime)
			},
			! 1),
			t.addEventListener("blur", function() {
				clearInterval(e.timer)
			},
			! 1)
		},
		t = function(e) {
			var t = this.display;
			t.innerHTML = e,
			e > 0 ? $(t).removeClass("wb-num-mis") : $(t).addClass("wb-num-mis")
		},
		n = function() {
			return this.num
		};
		return {
			bindMethod: e,
			updateDisplay: t,
			getNum: n
		}
	} ();
	var LBS = function(e, t, n) {
		this.triger = e,
		this.textArea = t,
		this.display = n,
		this.bindMethod()
	};
	LBS.prototype = function() {
		var e = function(e, t) {
			var n = $.ajax({
				url: g_action,
				dataType: "json",
				data: {
					ac: g_ac.AC_LBS_QUERY_ADDR_TEXT,
					latitude: e.latitude,
					longitude: e.longitude
				},
				async: ! 1,
				success: function(e) {
					t(e)
				}
			})
		},
		t = function() {
			var t = this,
			r = t.display,
			i = t.textArea;
			r.style.display = "none",
			r.innerHTML = '<em class="ico-area"></em><span class="t_ct"></span><em class="ico-del t_del" id="lbs-ico-del"></em>',
			this.content = r.querySelector(".t_ct"),
			this.deleteBtn = r.querySelector(".t_del");
			var s = function(n) {
				LoadingController.unloading();
				var s = {
					latitude: n.coords.latitude,
					longitude: n.coords.longitude,
					accuracy: n.coords.accuracy,
					timestamp: n.timestamp
				},
				o = function(e) {
					var n = e.msg;
					n.length > 0 ? (i.setAttribute("latitude", s.latitude), i.setAttribute("longitude", s.longitude), i.setAttribute("geoAddr", n), t.content.innerHTML = n, r.style.display = "") : Tips.blink("fail", "获取地址失败")
				};
				e(s, o)
			},
			o = function(e) {
				LoadingController.unloading();
				switch (e.code) {
				case e.PERMISSION_DENIED:
					alert("您已关闭此网页获取您的位置，请到设置的定位服务中更改设置");
					break;
				case e.TIMEOUT:
				case e.POSITION_UNAVAILABLE:
					t.updateArgument.lat = - 2,
					t.updateArgument.lon = - 2,
					alert("获取位置超时或位置不可用");
					break;
				default:
				}
				r.style.display = "",
				t.content.innerHTML = "获取位置失败..",
				i.setAttribute("geoAddr", "")
			};
			$(this.triger).tap(function() {
				LoadingController.getLoading(),
				t.display.style.display = "",
				t.content.innerHTML = "正在获取位置信息..";
				var e = navigator.geolocation,
				n = {
					enableHighAccuracy: ! 0,
					timeout: 3e4,
					maximumAge: 0
				};
				e && setTimeout(function() {
					e.getCurrentPosition(s, o, n)
				},
				25)
			}),
			this.deleteBtn.addEventListener("click", function() {
				n.call(t)
			})
		},
		n = function() {
			var e = this,
			t = e.display,
			n = e.textArea;
			n.setAttribute("latitude", ""),
			n.setAttribute("longitude", ""),
			n.setAttribute("geoAddr", ""),
			e.content.innerHTML = "",
			t.style.display = "none"
		};
		return {
			bindMethod: t,
			clear: n
		}
	} (),
	WritePlus.UserList = UserList,
	WritePlus.LBS = LBS,
	WritePlus.Face = Face,
	WritePlus.Topic = Topic,
	WritePlus.Count = Count
})(),
function(e) {
	function h(s) {
		s.preventDefault(),
		s.stopPropagation(),
		n = ! 1,
		u = e(s.target),
		r = t ? s.touches[0].clientX: s.pageX,
		i = t ? s.touches[0].clientY: s.pageY
	}
	function p(e) {
		s = t ? e.touches[0].clientX: e.pageX,
		o = t ? e.touches[0].clientY: e.pageY;
		if (Math.abs(s - r) > 10 || Math.abs(s - i) > 10) n = ! 0
	}
	function d(e) {
		n || a(e)
	}
	var t = "ontouchstart" in window,
	n = ! 1,
	r, i, s, o, u, a = null,
	f = t ? "touchstart": "mousedown",
	l = t ? "touchmove": "mousemove",
	c = t ? "touchend": "mouseup";
	e.fn.unImgTap = function() {
		var e = this[0];
		if (!e) return;
		e.removeEventListener(f, h),
		e.removeEventListener(l, p),
		e.removeEventListener(c, d)
	},
	e.fn.imgTap = function(e) {
		var t = this[0];
		a = e;
		if (!t) return;
		t.addEventListener(f, h),
		t.addEventListener(l, p),
		t.addEventListener(c, d)
	}
} ($);
var ImageLayerController = function() {
	function l(e, t) {
		var n = new Image;
		n.src = e,
		n.onload = t
	}
	function c(f, c, h, v, b) {
		var w = PageManager.getCurrentPage();
		w.forceRefresh = ! 1,
		NavControl.addException("#showImg", "Out", p),
		location.hash = "showImg",
		i = 0,
		o = c,
		t || (t = $("#t_dialog_pop")),
		t && t.imgTap(u),
		n || (n = $("#t_image_show"), n.bind("click", u)),
		t.css("height", document.body.scrollHeight + "px"),
		t.show(),
		r || y();
		if (f) {
			var E = /\/320$/.test(f),
			S = f.replace(/\/[0-9]+$/, "/320");
			s.removeAttr("width").removeAttr("height"),
			b ? E && s.attr("width", v).attr("height", h) : s.attr("src", f),
			b ? s.hide() : s.show(),
			$("#t_img_loading").show(),
			a.startup(),
			l(S, function() {
				b = o == "gif" ? ! 0: b,
				s.attr("src", S),
				a.stop(),
				$("#t_img_loading").hide(),
				b && s.show();
				var t = s.height(),
				n = s.width();
				b || s.attr("width", v).attr("height", h),
				e = b ? 1: (n / v).toFixed(1);
				var i = b ? t: (h * e - h) / 2 + h;
				m(i),
				r.find("div.wb-pic-tool").show(),
				d(h),
				g(e, b)
			})
		}
		r.show(),
		d(h),
		r.find("div.wb-pic-tool").hide(),
		s.css("-webkit-transform", "rotate(0deg)").css("-webkit-transition", "")
	}
	function h(c, h) {
		var v = PageManager.getCurrentPage(),
		c = $(c),
		b = c.height(),
		w = c.width(),
		E = c.attr("src"),
		S = h.isLink,
		x = h.picType,
		T = h.displayDes,
		N = h.displayBig,
		C = c.attr("dataaccount"),
		k = c.attr("datausername"),
		L = c.attr("datacontent"),
		A = c.attr("datamsgId"),
		O = '<a href="#guest_home/u=' + C + '">' + k + "</a> ：" + L + '<a href="#detail/msgid=' + A + '">  详情</a>';
		NavControl.addException("#showImg", "Out", p),
		location.hash = "showImg",
		i = 0,
		o = x,
		t ? t.imgTap(u) : t = $("#t_dialog_pop"),
		n || (n = $("#t_image_show"), n.bind("click", u)),
		t.css("height", document.body.scrollHeight + "px"),
		t.show(),
		r || y();
		if (E) {
			var M = /\/320$/.test(E),
			_ = E.replace(/\/[0-9]+$/, "/320");
			s.removeAttr("width").removeAttr("height"),
			S ? M && s.attr("width", w).attr("height", b) : s.attr("src", E),
			S ? s.hide() : s.show(),
			$("#t_img_loading").show(),
			a.startup(),
			l(_, function() {
				S = o == "gif" ? ! 0: S,
				s.attr("src", _),
				a.stop(),
				$("#t_img_loading").hide(),
				S && s.show();
				var t = s.height(),
				n = s.width();
				S || s.attr("width", w).attr("height", b),
				e = S ? 1: (n / w).toFixed(1);
				var i = S ? t: (b * e - b) / 2 + b;
				m(i),
				r.find("div.wb-pic-tool").show();
				if (T) {
					f || (f = $('<div class="pic-des t_des"></div>'), r.append(f)),
					r.find(".wb-picview").height(b * (e / 2 + .5) + "px"),
					f.html(O),
					f.find("a").bind("click", function(e) {
						e.stopPropagation()
					});
					var u = f.find(".pic-des");
					f.bind("click", function(e) {
						e.stopPropagation()
					})
				}
				N || r.find(".zoom-btn").hide(),
				d(b),
				g(e, S)
			})
		}
		r.show(),
		d(b),
		r.find("div.wb-pic-tool").hide(),
		s.css("-webkit-transform", "rotate(0deg)").css("-webkit-transition", ""),
		v.forceRefresh = ! 1
	}
	function p() {
		s.attr("src", ""),
		r.hide(),
		t.hide(),
		t.unImgTap(),
		f && f.html(""),
		r.find(".zoom-btn").show()
	}
	function d(e) {
		var t = (window.innerHeight - e) / 2;
		r.css("top", t + $(window).scrollTop() + "px")
	}
	function v() {
		r.find("a.rotation-btn").click(function(t) {
			t.stopPropagation(),
			i += 90,
			s.css("-webkit-transform", "rotate(" + i + "deg) scale(" + e + ")")
		}),
		r.find("a.zoom-btn").click(function(e) {
			e.stopPropagation(),
			util.pushHashParams({
				pageId: "zoom_img",
				urlParams: {
					src: s.attr("src")
				}
			})
		})
	}
	function m(e) {
		var t = s.width(),
		n = r.find("div.wb-picview").width(),
		i = r.find("div.wb-pic-tool").width();
		if (t > i && t < n) {
			var o = (n - t) / 2;
			r.find("div.wb-pic-tool").css("right", o + "px")
		}
		r.find("div.wb-pic-tool").css("right", "10px"),
		r.find("div.wb-pic-tool").css("top", e - 30 + "px"),
		r.find("div.wb-pic-tool").css("height", "35px")
	}
	function g(e, t) {
		if (o == "gif") return ! 1;
		s.css("-webkit-transform", "scale(" + (t ? 0: 1) + ")"),
		setTimeout(function() {
			s.css("-webkit-transition", "-webkit-transform 0.7s ease-in-out"),
			s.css("-webkit-transform", "scale(" + (t ? 1: e) + ")")
		},
		0)
	}
	function y() {
		a || (a = new loadingBar),
		r = $("#t_image_show"),
		s = r.find("img.big-pic"),
		s.css("max-height", window.innerHeight + "px").css("max-width", window.innerWidth + "px"),
		v()
	}
	var e = null,
	t = null,
	n = null,
	r = null,
	i = 0,
	s = null,
	o = null,
	u = function(e) {
		p(),
		history.back()
	},
	a = null,
	f;
	return {
		show: c,
		display: h,
		close: p
	}
} (),
LoadingController = function() {
	function s() {
		var e = $(".loading_point:visible"),
		t = 1;
		pointAnimationMark = setInterval(function() {
			e.text(Array(++t).join(".")),
			t >= 4 && (t = 1)
		},
		500)
	}
	function o() {
		var e = PageManager.getCurrentPage(),
		t = e.jObj.find(".t_btn-getmore"),
		n;
		t.each(function(e, t) {
			var r = $(t);
			r.getComputedStyle("display") == "block" && (n = r)
		}),
		n && n.html('正在加载<span class="loading_point">...</span>')
	}
	function u(e) {
		var t;
		window.navigator.userAgent.indexOf("MQQBrowser") != "-1" ? t = 0: t = window.navigator.standalone == 1 ? 0: 30;
		var n = ($(window).height() - e.height()) / 2,
		r = n + $(window).scrollTop() + t;
		window.navigator.userAgent.indexOf("MQQBrowser") != "-1" && (r += 40),
		i || (r = 200),
		e.css("top", r < 0 ? 0: r + "px"),
		e.css("visibility", "visible")
	}
	function a() {
		var e = PageManager.getCurrentPage(),
		i = e.jObj.find('ul[mst="' + e.updateArgument.mst + '"]');
		i.length > 0 && i.hasClass("t_fwdList") && i.children("li").length > 0 ? i.each(function() {
			var e = $(this);
			if (e.children("li.loading").length) return;
			e.children("li").length > 0 && (e.prepend('<li class="timeline-list-item loading">正在加载<span class="loading_point">...</span></li>'), s(), t = e)
		}) : (u(r), r.show(), n = r)
	}
	function f(e) {
		u(r),
		r.show(),
		n = r
	}
	function l() {
		setTimeout(function() {
			t && (t.find("li.loading").remove(), t = null),
			$("ul li.loading").remove(),
			n && (n.hide(), n = null)
		},
		0)
	}
	function c() {
		var e = PageManager.getCurrentPage(),
		t = e.jObj.find(".t_btn-getmore");
		t.remove()
	}
	var e = ! 1,
	t = null,
	n = null,
	r, i = ! /Android 2.3.*/.test(navigator.userAgent);
	return r = i ? $('<div id="loading" class="newloading" style="display:none;"><div class="loading_under"></div><div class="loading_ani"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div><div class="loading_bg"></div><div class="loading_hack"></div></div>') : $('<div class="andriodLoading"></div>'),
	$("body").append(r),
	{
		saveLoading: function() {
			f("save")
		},
		pubLoading: function() {
			f("pub")
		},
		getLoading: function() {
			f("get")
		},
		popLoading: f,
		loading: a,
		unloading: l,
		getMoreIng: o,
		removeGetMore: c
	}
} ();
(function(e) {
	var t, n = 0,
	r = ! 1;
	loadingBar = function(e) {
		var t = this;
		for (var n in e) t[n] = e[n]
	},
	loadingBar.prototype = {
		blockId: "wb-load",
		animationCls: "wb-load-anim",
		originalCls: "wb-load",
		isPlaying: function() {
			return r
		},
		startup: function() {
			var e = this;
			t = setInterval(function() {
				if (r) {
					if (n == 400) for (var t = 1; t <= 5; t++) $("#" + e.blockId + "-" + t).addClass(e.originalCls + "-" + t).removeClass(e.animationCls + "-" + t);
					else n == 1400 && (r = ! 1, n = - 100);
					n += 100
				} else {
					for (var t = 1; t <= 5; t++) $("#" + e.blockId + "-" + t).addClass(e.animationCls + "-" + t).removeClass(e.originalCls + "-" + t);
					r = ! 0
				}
			},
			100)
		},
		stop: function() {
			var e = this;
			clearInterval(t);
			for (var i = 1; i <= 5; i++) $("#" + e.blockId + "-" + i).removeClass(e.animationCls + "-" + i).removeClass(e.originalCls + "-" + i);
			r = ! 1,
			n = 0
		}
	},
	e.loadingBar = loadingBar
})(window);
var cesuTongJi = {
	isOpen: 1,
	isLog: 0,
	log: function(e) {
		this.isLog && console.log(e)
	},
	pageId: "",
	pageTime: "",
	xhrTime: 1,
	isFirstEnter: 1,
	netStatus: navigator.type || 0,
	step1: function() {
		if (!this.isOpen) return;
		var e = this,
		t = PageManager.getCurrentPage();
		e.xhrTime = (new Date).getTime(),
		e.isFirstEnter ? (e.pageTime = pageStartTime, e.log("这是第一次进入，以index.jsp进入为页面时间开始点。pageStartTime=" + e.pageTime)) : (e.pageTime = e.xhrTime, e.log("不是第一次进入，以enter进入为页面时间开始点。pageStartTime=" + e.pageTime));
		if (PageManager.getCurrentPage().updateArgument.ac == g_ac.AC_MORE_HOME_MSG) e.isFirstEnter = 0;
		else {
			var n = localStorageObj.get("l_cesuTongJi");
			n && (t.updateArgument.ulps = n, e.log("发送上一次测速统计记录 : " + n), localStorageObj.remove("l_cesuTongJi"))
		}
	},
	step2: function() {
		if (!this.isOpen) return;
		var e = this,
		t = (new Date).getTime(),
		n = "",
		r = PageManager.getCurrentPage().id,
		i = t - e.pageTime,
		s = t - e.xhrTime;
		n = [r, i, s, e.isFirstEnter, e.netStatus].join(","),
		e.log("页面结束时间：pageEndTime=" + t + "; 保存本次测速统计记录: " + n),
		localStorageObj.set("l_cesuTongJi", n),
		e.isFirstEnter = 0
	}
},
pvTongJi = {
	isOpen: 1,
	isLog: 0,
	log: function(e) {
		this.isLog && console.log(e)
	},
	pageId: "",
	num: 0,
	isFirstEnter: 1,
	count: function(e) {
		function i() {
			var e = localStorageObj.get("l_pvTongJi");
			e && (n.updateArgument.up = e, t.log("发送上次pv统计记录 : " + e), localStorageObj.remove("l_pvTongJi"))
		}
		function s() {
			var e = "",
			r = localStorageObj.get("l_pvTongJi");
			r ? e = r + "|" + n.id + "," + (t.num + 1) : e = n.id + "," + (t.num + 1),
			localStorageObj.set("l_pvTongJi", e)
		}
		if (!this.isOpen) return;
		var t = this,
		n = PageManager.getCurrentPage(),
		r = Boolean(e && n.updateArgument.ac);
		n.updateArgument.ac == g_ac.AC_MORE_HOME_MSG && (t.isFirstEnter ? (r = ! 1, t.isFirstEnter = 0) : (e = ! 0, r = ! 0)),
		this.log("isGoRefresh:" + e),
		t.log("isSendRequest:" + r),
		r ? (i(), s()) : s()
	}
};
Message.prototype = function() {
	function e() {
		var e = this.jObj.attr("selected");
		if (e) {
			var t = this.jObj.attr("edited");
			if (t) return;
			this.jObj.removeAttr("selected")
		} else {
			var n = this.jObj.parent();
			n.find("li[selected='true']").each(function(e, t) {
				$(t).removeAttr("selected")
			}),
			this.jObj.attr("selected", ! 0)
		}
	}
	function t() {
		var t = this;
		this.jObj.click(function(n) {
			if (n.target.localName == "a" || n.target.localName == "textarea") return;
			e.call(t)
		})
	}
	return {
		bindAction: t
	}
} (),
MBUser.prototype = function() {
	function e(e) {
		this.jObj = $(e),
		this.target_user_id = this.jObj.attr("data-uid"),
		this.name = this.jObj.data("name"),
		this.img = this.jObj.find("img.t_head").data("src")
	}
	function t(e) {
		var t = {
			tu: this.target_user_id,
			ac: e
		};
		NetWork.commonRequest(this, t, this.followReaction, ! 0)
	}
	function n() {
		var e = this;
		this.jObj.find(".t_follow-operation").click(function(t) {
			if (!loginPop.isLogin()) {
				loginPop.show();
				return
			}
			LoadingController.saveLoading();
			var n = t.currentTarget.getAttribute("data-ac");
			e.followManage(n)
		})
	}
	function r(e, t) {
		if (!t) return;
		var n = {
			remove: "你确定将" + e + "移出黑名单?\n移出黑名单之后,你会重新收到来自他的私信和其它通知.",
			add: "你确定将" + e + "加入黑名单?\n加入黑名单之后,你将取消收听他的所有广播,不再收到来自他的私信与任何通知,如果你哪天原谅了他,可以将他移出黑名单."
		},
		r = t == g_ac.AC_REMOVE_BLACK_USER_LIST ? "remove": "add";
		confirm(n[r]) && (LoadingController.saveLoading(), NetWork.commonRequest(this, {
			ac: t,
			tu: e
		},
		function(e) {
			LoadingController.unloading(),
			parseInt(e.result, 10) === 0 ? (t == g_ac.AC_REMOVE_BLACK_USER_LIST ? (Tips.blink("success", "已取消拉黑"), $("#d_guest_home a[data-action='black']").text("拉黑").attr("data-ac", g_ac.AC_ADD_BLACK_USER_LIST), $("#d_guest_home a[data-action='follow']").html("<span>收听</span>").attr("data-ac", g_ac.AC_USER_FOLLOW).removeClass("unfollow-btn").addClass("follow-btn").show()) : (Tips.blink("success", "已拉黑"), $("#d_guest_home a[data-action='black']").text("取消拉黑").attr("data-ac", g_ac.AC_REMOVE_BLACK_USER_LIST), $("#d_guest_home a[data-action='follow']").hide(), $("#d_guest_home a[data-action='special_follow']").hide()), location.hash.indexOf("blackList") > 0 && t == g_ac.AC_REMOVE_BLACK_USER_LIST && $(btnObj).closest("li").remove()) : t == g_ac.AC_REMOVE_BLACK_USER_LIST ? Tips.blink("fail", "取消拉黑失败") : Tips.blink("fail", "拉黑失败")
		}))
	}
	function i(e, t) {
		var n = parseInt(t.ac, 10),
		r = this.jObj.find(".t_follow-operation"),
		i = localStorageObj.get("at"),
		s = i ? i.msg: null;
		LoadingController.unloading();
		if (parseInt(e.result, 10) === 0) switch (n) {
		case g_ac.AC_USER_FOLLOW:
			Tips.blink("success", "已收听");
			if (s) {
				var o = e.jsonDump.userInfo;
				s.unshift([o.id, o.name, o.faceUrl, o.cnId]),
				localStorageObj.set("at", i)
			}
			var u = PageManager.getCurrentPage().id;
			u != "nearbyuser" && this.jObj.find(".t_followeach").show(),
			r.text(this.initCfg && this.initCfg.cancelText ? this.initCfg.cancelText: "取消收听").attr("data-ac", g_ac.AC_USER_UNFOLLOW).removeClass("follow-btn").addClass("unfollow-btn");
			break;
		case g_ac.AC_USER_UNFOLLOW:
			Tips.blink("success", "已取消收听");
			if (s) {
				for (var a = 0; a < s.length; a++) if (s[a][0] == this.target_user_id) {
					s.splice(a, 1);
					break
				}
				localStorageObj.set("at", i)
			}
			this.jObj.find(".t_followeach").hide(),
			r.text("收听").attr("data-ac", g_ac.AC_USER_FOLLOW).removeClass("unfollow-btn").addClass("follow-btn");
			break;
		case g_ac.AC_ADD_USER_GROUP_LIST:
			Tips.blink("success", "已特别收听"),
			$("#specialFollowingTab").show(),
			r.html("取消特别").attr("data-ac", g_ac.AC_REMOVE_USER_GROUP_LIST).removeClass("follow-btn").addClass("unfollow-btn");
			break;
		case g_ac.AC_REMOVE_USER_GROUP_LIST:
			Tips.blink("success", "已取消特别收听"),
			r.html("特别收听").attr("data-ac", g_ac.AC_ADD_USER_GROUP_LIST).removeClass("unfollow-btn").addClass("follow-btn");
			break;
		default:
			console.error("shouldn't be here")
		} else switch (n) {
		case g_ac.AC_USER_FOLLOW:
			Tips.blink("fail", "收听失败");
			break;
		case g_ac.AC_USER_UNFOLLOW:
			Tips.blink("fail", "已取消收听失败");
			break;
		case g_ac.AC_ADD_USER_GROUP_LIST:
			Tips.blink("fail", "特别收听失败");
			break;
		case g_ac.AC_REMOVE_USER_GROUP_LIST:
			Tips.blink("fail", "取消特别收听失败")
		}
	}
	return {
		init: e,
		followManage: t,
		bindAction: n,
		followReaction: i,
		handleBlackList: r
	}
} (),
MBUser.initjObj = function(e, t) {
	e.length > 1 && e[0].tagName == "li" ? e.filter("li[data-uid]").not(".t_getmore").each(function(e, n) {
		new MBUser(n, t)
	}) : e.find("li[data-uid]").not(".t_getmore").each(function(e, n) {
		new MBUser(n, t)
	})
},
Topic.prototype = function() {
	function e(e) {
		this.jObj = $(e),
		this.id = this.jObj.attr("data-topic_id"),
		this.topic_text = this.jObj.attr("data-topic_text"),
		this.keyword = this.jObj.attr("data-topic_keyword"),
		this.iskeyword = this.jObj.attr("data-topic_iskeyword"),
		this.msg_count = this.jObj.attr("data-msg_count")
	}
	function t(e) {
		NetWork.commonRequest(this, e, this.followReactionForTopic)
	}
	function n(e) {
		var t = this.jObj.find("a.t_follow-operation");
		if (e.result == "0") {
			console.log(t.attr("data-ac"));
			var n = t.attr("data-ac") == g_ac.AC_TOPIC_KEEP || t.attr("data-ac") == g_ac.AC_KEYWORD_KEEP ? ! 0: ! 1,
			r = t.attr("data-iskeyword") == "0" ? ! 1: ! 0,
			i;
			r ? n ? i = g_ac.AC_KEYWORD_DROP: i = g_ac.AC_KEYWORD_KEEP: n ? i = g_ac.AC_TOPIC_DROP: i = g_ac.AC_TOPIC_KEEP,
			n ? t.removeClass("follow-btn").addClass("unfollow-btn") : t.removeClass("unfollow-btn").addClass("follow-btn"),
			t.text(n ? "取消订阅": "添加订阅").removeAttr("data-ac").attr("data-ac", i),
			Tips.blink("success", e.msg)
		} else e ? Tips.blink("fail", e.msg) : Tips.blink("offline")
	}
	function r() {
		var e = this;
		this.jObj.find("a.t_join").click(function(e) {
			var t = $(e.target).data("topic");
			PageManager.require("compose", function() {
				var e = PageManager.getObj("compose");
				e.enter({
					urlParams: {
						topic: t
					}
				})
			},
			this)
		}),
		this.jObj.find("a.t_follow-operation").click(function(t) {
			var n = $(t.target);
			e.followManageForTopic({
				ac: n.attr("data-ac"),
				keyword: n.attr("data-keyword"),
				iskeyword: n.attr("data-iskeyword"),
				tid: n.attr("data-topic-id")
			})
		}),
		this.jObj.find("a.t_unsub").click(function(t) {
			var n = $(this);
			if (n.attr("type") === "keyword") {
				if (confirm("您要取消订阅该关键字?")) {
					LoadingController.saveLoading();
					var r = {
						ac: g_ac.AC_KEYWORD_DROP,
						keyword: e.keyword
					};
					NetWork.commonRequest(e, r, e.followReaction)
				}
			} else if (confirm("您要取消订阅该话题?")) {
				LoadingController.saveLoading();
				var r = {
					ac: g_ac.AC_TOPIC_DROP,
					tid: e.id
				};
				NetWork.commonRequest(e, r, e.followReaction)
			}
		}),
		this.jObj.find("a.t_topic-page-entrance").click(function(t) {
			var n = "detailTopic";
			e.iskeyword == "1" && (n = "searchTopic"),
			PageManager.require(n, function() {
				var t = PageManager.getObj(n),
				r = e.keyword;
				e.iskeyword == "1" && (t = PageManager.getObj(n)),
				t.enter({
					urlParams: {
						keyword: r
					}
				})
			},
			this)
		})
	}
	function i(e) {
		var t = this.jObj.find("a.t_follow-operation");
		LoadingController.unloading(),
		parseInt(e.result, 10) === 0 ? this.jObj.remove() : console.error("drop kept topic error")
	}
	return {
		init: e,
		bindAction: r,
		followReaction: i,
		followManageForTopic: t,
		followReactionForTopic: n
	}
} (),
Topic.initjObj = function(e) {
	e.length > 1 ? e.filter("li[data-topic_id]").not(".t_getmore").each(function(e, t) {
		new Topic(t)
	}) : e.children("li[data-topic_id]").not(".t_getmore").each(function(e, t) {
		new Topic(t)
	})
},
Page.prototype = function() {
	function e() {
		this.updateArgument = {},
		this.jObj = $(this.jObjDom),
		this.jObj.insertAfter($("#t_moveable_bar")),
		this.jObjSubNavDom && (this.jObjSubNav = $(this.jObjSubNavDom), $("#t_head2").append(this.jObjSubNav));
		if (this.jObjSubNav && this.jObjSubNav.find("a.t_refresh").length > 0) {
			this.refresh_button = this.jObjSubNav.find("a.t_refresh"),
			this.updateArgument.mst = this.refresh_button.attr("mst"),
			this.updateArgument.ac = this.refresh_button.attr("ac");
			var e = this.refresh_button.attr("shinforen");
			e && (this.updateArgument.shinforen = e);
			var t = this.refresh_button.attr("shinfo");
			t && (this.updateArgument.shinfo = t);
			var n = this.refresh_button.attr("eid");
			n && (this.updateArgument.eid = n)
		}
	}
	function t(e) {
		cesuTongJi.step1(),
		this.lastHash = location.hash,
		window.activedLayer && window.activedLayer.hide(),
		window.activedLayObj && window.activedLayObj.hide(),
		$("nav a.t_open").removeClass("t_open"),
		e = e ? e: {};
		var t = e.urlParams ? e.urlParams: {},
		r = this.id,
		i = this,
		s,
		o,
		u = this.jObj.find("ul[mst='" + this.updateArgument.mst + "'] li").length;
		s = PageManager.getCurrentPage(),
		o = s ? s: PageManager.getObj("myhome");
		var a = e.forceRefresh != undefined ? e.forceRefresh: s.forceRefresh,
		f = ! this.loaded || ! 1 !== a && a != undefined;
		pvTongJi.count(f),
		PageManager.go(r, t),
		n.call(this);
		if (this.loaded) {
			if (!1 === a) return ! 1; ! 0 === a && (clearTimeout(PageManager.scrollTimer), MoveableNav.scrollToTop(), i.refresh())
		} else MoveableNav.scrollToTop(),
		this.refresh()
	}
	function n() {
		var e = {
			myhome: 0,
			notification: 1,
			hot: 2,
			channels: 3,
			activity: 4
		},
		t = $("nav.main-nav > a"),
		n = $("nav.main-nav > span");
		if (this.activeTabName == "keep") return;
		if (!n.length) return;
		var r = e[this.activeTabName] * n.width();
		t.removeClass("main-nav-current"),
		t.eq(e[this.activeTabName]).addClass("main-nav-current"),
		this.activeTabName in e ? n.css("display") == "none" ? (n.css("visibility", "hidden"), n.css("display", "block"), r = e[this.activeTabName] * n.width(), n.css("visibility", "visible"), n.css("display", "none"), n.css("top", "0"), n.css("-webkit-transform", "translate3d(" + r + "px, 0, 0)"), n.css("-webkit-transition-duration", "0"), setTimeout(function() {
			n.css("display", "block"),
			n.css("-webkit-transition-duration", "400ms")
		},
		0)) : (n.css("top", "0"), n.css("-webkit-transform", "translate3d(" + r + "px, 0, 0)")) : (n.css("display", "none"), n.css("-webkit-transition-duration", "0"))
	}
	function r() {
		this.lockPos || setTimeout(function() {
			MoveableNav.scrollToTop()
		},
		200),
		this.id != "qixi_2" && this.id != "qixi_1" && this.id != "qixi_3" && LoadingController.loading(),
		this.loaded = ! 0,
		PageManager.scrollTimer && clearTimeout(PageManager.scrollTimer)
	}
	function i() {
		this.preFresh(),
		this.updateArgument && this.updateArgument.ac ? NetWork.refreshPage(this, this.updateArgument) : this.refreshReaction && this.refreshReaction()
	}
	function s() {
		this.forceRefresh = ! 1,
		this.id != "qixi_2" && this.id != "qixi_1" && LoadingController.unloading()
	}
	function o() {
		window.inited || ($(document.body).delegate("a.t_btn-back", "click", function() {
			var e = PageManager.getCurrentPage();
			e && typeof e.backAction == "function" && e.backAction()
		}), $(document.body).delegate("a.t_refresh", "click", function(e) {
			var t = PageManager.getCurrentPage();
			t.isRefresh = ! 0,
			clearTimeout(PageManager.scrollTimer),
			MoveableNav.scrollToTop(),
			t.refresh()
		}), window.inited = ! 0)
	}
	function u(e, t) {
		var n = e.find("ul[mst='0']");
		if (n.length > 0) {
			var r = ejsCreateMsg(t.jsonDump);
			n.prepend(r),
			new MbMessage(n.children("li")[0]),
			imgLoader(n.children("li").eq(0), "img.t_avatar"),
			imgLoader(n.children("li").eq(0), "img.t_load")
		}
	}
	function a(e) {
		self.forceRefresh = e
	}
	function f() {
		NavControl.back()
	}
	return {
		setForceRefresh: a,
		init: e,
		enter: t,
		bindAction: o,
		refresh: i,
		preFresh: r,
		refreshReaction: s,
		insertNewMessage: u,
		backAction: f
	}
} (),
MessagePage.prototype = new Page,
MessagePage.prototype.constructor = MessagePage,
$.extend(MessagePage.prototype, {
	init: function() {
		Page.prototype.init.call(this),
		this.tabs = this.jObj.find(".t_tab-container a[mst]")
	},
	bindAction: function() {
		Page.prototype.bindAction.call(this);
		var e = this;
		this.tabs && this.tabs.click(function(t) {
			if (e.currentTab == this) e.refresh(!0);
			else {
				var n = this.getAttribute("mst");
				e.tabSwitch(n, t),
				e.currentTab = this
			}
		}),
		this.bindGetMore(this.jObj)
	},
	doGetMore: function() {
		var e = PageManager.getCurrentPage(),
		t = e.jObj.find(".t_btn-getmore")[0],
		n;
		if (e.gettingMore) return;
		e.moreList = e.moreList || {};
		if (e.gettingMore) return;
		if (e.moreList[e.currentMst] != undefined) n = e.moreList[e.currentMst];
		else {
			if (!t) return;
			var r = t.getAttribute("data-mid"),
			i = t.getAttribute("data-mrt"),
			s = t.getAttribute("data-pid");
			n = {
				mid: r,
				mrt: i
			},
			s && (n.pid = s)
		}
		LoadingController.getMoreIng(),
		e.gettingMore = ! 0,
		e.getMore(n)
	},
	bindGetMore: function(e) {
		var t = this;
		e.find(".t_btn-getmore").click(t.doGetMore)
	},
	instanceListContent: function(e, t) {
		switch (Number(t)) {
		case g_mst.SEARCH_USER_LIST:
		case g_mst.FAMOUS_USER_LIST:
		case g_mst.HOT_USER_LIST:
		case g_mst.NEARBY_USER_LIST:
		case g_mst.CLOSE_FRIEND:
		case g_mst.MAYBE_KNOW:
		case g_mst.JOINTFOLLOW:
		case g_mst.SEARCH_USER_FOLLOWER:
		case g_mst.SEARCH_USER_FOLLOW:
		case g_mst.USER_FOLLOWER:
		case g_mst.USER_FOLLOWING:
		case g_mst.USER_SPECIAL_FOLLOWING:
		case g_mst.USER_FOLLOWING_CONF:
		case g_mst.RECOMMEND_FAMOUS:
		case g_mst.FAMOUS_INDEX:
			MBUser.initjObj(e);
			break;
		case g_mst.TOPIC_LIST:
		case g_mst.HOT_TOPIC_LIST:
		case g_mst.KEYWORD_LIST:
			Topic.initjObj(e);
			break;
		case g_mst.PRIVATEMSGHOME:
			PrivateMessage.initMessage(e);
			break;
		case g_mst.KEPT_MSG:
			e.find("li").attr("isfav", "true").attr("favpage", "true"),
			MbMessage.initMessage(e);
			break;
		default:
			MbMessage.initMessage(e)
		}
	},
	initMsgContainerMap: function() {
		this.msgContainerMap = {};
		var e = this;
		this.msgContainerMap.getOrCreate = function(t) {
			var n;
			return this[t] ? n = this[t] : (n = new MessageContainer(t, e), this[t] = n),
			n
		}
	},
	refresh: function() {
		this.jObj.find("ul[mst='" + this.updateArgument.mst + "']").length < 1 && window.homeMsgJson != undefined && this.updateArgument.ac == g_ac.AC_MORE_HOME_MSG ? (Page.prototype.preFresh.call(this), this.refreshReaction(window.homeMsgJson, ! 1), window.homeMsgJson = undefined) : Page.prototype.refresh.call(this)
	},
	refreshReaction: function(e, t) {
		Page.prototype.refreshReaction.call(this, e, t),
		this.currentMst = e.jsonDump.mst,
		this.moreList = this.moreList || {},
		this.moreList[this.currentMst] = e.jsonDump.getMoreData;
		var n = this,
		r = this.jObj.find("div.t_pageloading");
		if (e.result != "0" && e.jsonDump && e.jsonDump.mst != g_mst.NEARBY_MSG_LIST && e.jsonDump.mst != g_mst.NEARBY_USER_LIST) {
			console.error("json return result not 0");
			return
		}
		if (e.jsonDump && typeof e.jsonDump.mst != "undefined") {
			var i = this,
			s = "renderOptions" in i ? i.renderOptions: null,
			o = MessagePage.refreshRenderProxy(e, s);
			o.addClass("t_open"),
			i.instanceListContent(o, e.jsonDump.mst),
			i.bindGetMore(o);
			var u = i.jObj.find('ul[mst="' + e.jsonDump.mst + '"]');
			if (u.length > 0) u.replaceWith(o);
			else {
				i.jObj.find("ul[mst]").removeClass("t_open").hide();
				var a = i.jObj.find("div[content]");
				a.length > 0 ? a.append(o) : i.jObj.append(o)
			}
		}
		this.afterRefresh && typeof this.afterRefresh == "function" && this.afterRefresh(),
		this.bindScroll(),
		setTimeout(function() {
			imgLoader(n.jObj, "img.t_head"),
			imgLoader(n.jObj, "img.t_avatar"),
			imgLoader(n.jObj, "img.t_load"),
			t || n.loadHeadNav(e)
		},
		500)
	},
	afterRefresh: function() {},
	bindScroll: function() {
		window.scrollDetect || ($(document).bind("scroll", this.scrollAct), window.scrollDetect = ! 0),
		this.jObj.find('ul[mst="' + this.updateArgument.mst + '"]').attr("times", "1")
	},
	scrollAct: function() {
		var e = [g_mst.HOME_MSG, g_mst.CHANNEL_DETAIL, g_mst.TIMELINE_ORIGINAL_MSG, g_mst.SPECIAL_MSG, g_mst.IMETION_MSG, g_mst.IMETION_MSG_FOLLOWING, g_mst.USER_TIMELINE, g_mst.SEARCH_TOPIC_LIST, g_mst.SEARCH_TOPIC_JX_LIST, g_mst.SEARCH_TOPIC_ALL_LIST, g_mst.IPOST_MSG, g_mst.ORIGINAL_MSG, g_mst.WITH_IMAGE_MSG, g_mst.TIMELINE_WITH_IMAGE_MSG, g_mst.FORWARD_MSG, g_mst.REPLY_MSG, g_mst.KEPT_MSG, g_mst.SEARCH_MSG_LIST, g_mst.HOT_MSG_LIST, g_mst.RANDOM_MSG_LIST, g_mst.NEARBY_MSG_LIST, g_mst.QQ_FRIENDS_MSG, g_mst.TOPIC_LIST_MYFOLLOW, g_mst.FAMOUS_SAY, g_mst.IMENTION_MSG_STAR, g_mst.BIDIRECTION_FOLLOWS, g_mst.LIST_MSG, g_mst.TOPIC_LIST_GOOD, g_mst.TOPIC_LIST_MYFOLLOW, g_mst.TOPIC_LIST_ALL, g_mst.TOPIC_DETAIL_ALL, g_mst.TOPIC_DETAIL_IMAGE, g_mst.TOPIC_DETAIL_NEW, g_mst.TOPIC_DETAIL_DEFINE],
		t = PageManager.getCurrentPage(),
		n = $(document).scrollTop(),
		r = window.innerHeight,
		i = document.body.scrollHeight,
		s,
		o,
		u,
		a;
		t ? (s = t.updateArgument.mst != undefined ? Number(t.updateArgument.mst) : null, o = t.jObj.find('ul[mst="' + s + '"]'), u = e.indexOf(s) != - 1, a = o.attr("times")) : (u = ! 1, a = 0),
		a = parseInt(a);
		if (a % 2 != 0 && u && i - (n + r) < 1920 && document.body.scrollHeight > r * 2) {
			var f = PageManager.getCurrentPage();
			f.doGetMore && f.doGetMore()
		}
	},
	loadHeadNav: function(e) {
		if (this.headNavLoad && e.jsonDump.msgs) {
			var t = "";
			for (var n = 0; n < e.jsonDump.msgs.length; n++) {
				var r = e.jsonDump.msgs[n];
				t += r.authorId + "|"
			}
			var i = {
				ac: g_ac.AC_HEADNAVFLAG,
				ids: t
			};
			NetWork.commonRequest(this, i, this.loadNavHtml)
		}
	},
	loadNavHtml: function(e) {
		var t = this;
		for (var n = 0; n < e.jsonDump.msgs.length; n++) {
			var r = e.jsonDump.msgs[n];
			if (r.id != g_usrId) {
				if (!this.jObj) return;
				this.jObj.find("div.t_" + r.id + "_headNav").each(function() {
					var e = $(this);
					e.attr("navLoad") || (e.attr("navLoad", ! 0), r.follow == 1 ? e.find("a.t_unfollow_nav").show() : e.find("a.t_follow_nav").show(), (r.pmSet == 2 || r.pmSet == 0 && r.follower == 1 || r.pmSet == 1 && (r.follower == 1 || g_isVip)) && e.find("a.t_privatemsg_nav").show())
				})
			}
		}
	},
	getMore: function(e) {
		pvTongJi.count(),
		NetWork.pageGetMore(this, $.extend({
			more: 1
		},
		this.updateArgument, e))
	},
	errorReaction: function(e) {
		this.gettingMore = ! 1
	},
	getMoreReaction: function(e) {
		var t = this,
		n = t.jObj.find('ul[mst="' + t.updateArgument.mst + '"]'),
		r = n.attr("times"),
		i;
		r == "12" && (n.html('<li class="timeline-list-item wb-more"><a class="t_auth t_btn-getmore" data-mid="157599074015604" data-mrt="1344482942">查看更多</a></li>'), r = 0, MoveableNav.scrollToTop()),
		e || Tips.blink("offline"),
		this.moreList[this.currentMst] = e.jsonDump.getMoreData;
		if (parseInt(e.result, 10) === 0) {
			var s = Number(e.jsonDump.mst),
			o = this.jObj.find("ul[mst='" + s + "'] > li.wb-more");
			if (!o || o.length < 1) {
				console.error("error, can't find get more li");
				return
			}
			var u = this,
			a = "renderOptions" in u ? u.renderOptions: null,
			f = ejsRender(e.jsonDump, a),
			l = $(f);
			u.instanceListContent(l, s),
			u.bindGetMore(l),
			l.get(0).nodeName === "UL" ? o.replaceWith(l.children("li")) : o.replaceWith(l)
		} else console.error("get more json result error"),
		LoadingController.removeGetMore();
		if (this.headNavLoad) {
			var c = "";
			if (e.jsonDump.msgs) {
				for (var h = 0; h < e.jsonDump.msgs.length; h++) {
					var p = e.jsonDump.msgs[h];
					c += p.authorId + "|"
				}
				var d = {
					ac: g_ac.AC_HEADNAVFLAG,
					ids: c
				};
				NetWork.commonRequest(this, d, this.loadNavHtml)
			}
		}
		r++,
		n.attr("times", r),
		t.gettingMore = ! 1,
		imgLoader(this.jObj, "img.t_avatar"),
		imgLoader(this.jObj, "img.t_load"),
		imgLoader(this.jObj, "img.t_head")
	},
	tabSwitch: function(e) {
		this.tabs.each(function(t, n) {
			var r = $(n);
			e == r.attr("mst") ? r.parent("li.timeline-nav-item").addClass("timeline-nav-active") : r.parent("li.timeline-nav-item").removeClass("timeline-nav-active")
		}),
		this.updateArgument.mst = e;
		var t = this.jObj.find("ul[mst='" + e + "']");
		t.length > 0 ? (this.tabrefresh && this.refresh(), this.jObj.find("ul[mst]").removeClass("t_open").hide(), t.addClass("t_open").show()) : this.refresh()
	},
	_showMsgContainer: function(e, t) {
		var n = this.jObj.find("ul[mst='" + e + "']");
		if (n.length > 0) n.replaceWith(t);
		else {
			this.jObj.find("ul[mst]").removeClass("t_open").hide();
			var r = this.jObj.find("div[content]");
			r.length > 0 ? r.append(t) : this.jObj.append(t)
		}
	}
}),
MessagePage.refreshRenderProxy = function(e, t) {
	var n;
	if (e) {
		if (parseInt(e.result, 10) === 0) if (e.info && e.info.value && e.info.value.length > 0 || e.jsonDump) if (e.jsonDump) {
			var r = ejsRender(e.jsonDump, t);
			n = $(r)
		} else n = $(e.info.value)
	} else Tips.blink("offline");
	return n ? n: (console.log("bad refresh res"), null)
};
var firstajax = ! 0,
NetWork = function() {
	function i(i, s, o) {
		var u = util.getHashParams(),
		a = "",
		f = localStorageObj.get("clickhis");
		f != null && f.num > 0 && (s.clickid = f.clickid, localStorageObj.remove("clickhis"));
		var l = s.ac,
		c = localStorageObj.get("writehis");
		(l == g_ac.AC_MSG_POST || l == g_ac.AC_MSG_REPLY || l == g_ac.AC_MSG_FORWARD || l == g_ac.AC_MSG_DIRECT || l == g_ac.AC_MSG_DIRECT_REPLY || l == g_ac.AC_MSG_DIRECT_MANUAL) && c !== null && (s.lp = c, localStorageObj.remove("writehis")),
		s.dl2 = 1,
		s.dumpJSON = 1,
		s.pageid = u.pageId;
		var h = util.getUrlParams().g_f;
		h && (s.g_f = h),
		firstajax && (firstajax = ! 1);
		if (!$.isEmptyObject(u.urlParams)) {
			for (var p in u.urlParams) a += p + "," + u.urlParams[p] + "|";
			a = a.replace(/\|$/, ""),
			s.params = a
		}
		var d = arguments,
		v = function(u) {
			switch (o) {
			case e:
				i && touch_console_log && console.log(i.id + " refresh ajax end:" + ((new Date).getTime() - window.startTime)),
				i.refreshReaction(u),
				cesuTongJi.step2();
				break;
			case t:
				i.getMoreReaction(u);
				break;
			case n:
				if (u.result == - 2) {
					PageManager.require("spam", function() {
						PageManager.getObj("spam").enter({
							pageId: "spam",
							imgUrl: u.jsonDump.imgUrl,
							imgSid: u.jsonDump.imgSid,
							options: {
								requestArgs: s,
								success: v
							}
						})
					});
					return
				}
				i.sendReaction(u);
				break;
			case r:
				if (d.length != 4) {
					console.log("error, common action must specify reaction function");
					return
				}
				d[3].call(i, u, s);
				break;
			default:
				console.error("never shouldn't be here")
			}
		},
		m = function(e) {
			i && i.errorReaction && i.errorReaction(e)
		};
		s = wfCount.getParams(s.ac, s),
		i && o == e && touch_console_log && console.log(i.id + " refresh ajax start:" + ((new Date).getTime() - window.startTime)),
		$.ajax({
			url: g_action,
			data: s,
			dataType: "json",
			timeout: 3e4,
			success: function() {
				try {
					v.apply(this, arguments)
				} catch(e) {
					m.apply(this, arguments)
				}
				LoadingController.unloading()
			},
			error: function(e, t) {
				t === "error" && e.status === 0 && (console.log(s), i && i.id != "myhome" && g_isLogin && Tips.blink("offline")),
				m.apply(this, arguments),
				LoadingController.unloading()
			}
		})
	}
	function s(t, n) {
		i(t, n, e)
	}
	function o(e, n) {
		i(e, n, t)
	}
	function u(e, t) {
		i(e, t, n)
	}
	function a(e, t, n, s) {
		i(e, t, r, n)
	}
	var e = "REFRESH",
	t = "MORE",
	n = "SEND",
	r = "COMMON";
	return {
		refreshPage: s,
		pageGetMore: o,
		sendMsg: u,
		commonRequest: a
	}
} ();
MbMessage.prototype = new Message,
MbMessage.prototype.constructor = MbMessage,
$.extend(MbMessage.prototype, {
	bindAction: function() {
		Message.prototype.bindAction.call(this);
		var e = this;
		loginPop.registerLoginCheck(["a[data-ac]", "a.t_comment-msg", "a.t_show-map", "a.t_more", "a.t_privatemsg_nav", "a.t_dialog_nav"], this.jObj),
		this.jObj.find("a.t_comment-msg").each(function(t, n) {
			var r = $(n);
			r.click(function(t) {
				g_isLogin && e.showActionForm(r.data("ac"))
			})
		}),
		this.jObj.find("a.t_forward-msg").each(function(t, n) {
			var r = $(n);
			r.click(function(t) {
				g_isLogin && e.showActionForm(r.data("ac"))
			})
		}),
		this.jObj.find("a.t_privatemsg_nav").click(function(e) {
			var t = $(this),
			n = "";
			privateLayer.open({
				toUser: t.attr("data-uid"),
				lastContent: n
			})
		}),
		this.jObj.find("a.t_dialog_nav").click(function(t) {
			e.showActionForm(g_ac.AC_MSG_REPLY)
		}),
		this.jObj.find("a.t_follow_nav").click(function(t) {
			e.followManage(g_ac.AC_USER_FOLLOW, $(this).attr("data-uid"))
		}),
		this.jObj.find("a.t_unfollow_nav").click(function(t) {
			e.followManage(g_ac.AC_USER_UNFOLLOW, $(this).attr("data-uid"))
		}),
		this.jObj.find("span.t_num").click(function(t) {
			PageManager.require("detail", function() {
				var t = e.jObj.attr("msgid");
				util.pushHashParams({
					pageId: "detail",
					urlParams: {
						msgid: t
					}
				})
			},
			this)
		}),
		this.jObj.find("a.t_show-map").click(function(t) {
			e.toggleLbsMap()
		}),
		this.jObj.find("a.t_more").click(function(t) {
			if (g_isLogin) {
				var n = {},
				r = e.jObj.attr("isfav") == "true" ? "delfav": "addfav";
				n.point = e,
				n.optsObj = {},
				n.optsObj[r] = e.favManager,
				e.jObj.attr("allowdelete") != 1 && (n.optsObj.reply = e.reply),
				e.jObj.attr("allowDelete") == "1" && (n.optsObj.delmsg = e.delSelf),
				morePopLayer.init(n),
				morePopLayer.show()
			}
		}),
		this.jObj.find("a.t_topic_name").click(function(e) {
			var t = e.currentTarget.textContent.replace(/#/g, "");
			util.pushHashParams({
				pageId: "topic_detail",
				urlParams: {
					title: t,
					keyword: t,
					iskeyword: 0
				}
			})
		}),
		this.jObj.find("a.t_mb_image").click(function(e) {
			var t = $(e.currentTarget).children("[src]"),
			n = t.height(),
			r = t.width(),
			i = $(e.currentTarget).children("[src]").attr("src"),
			s = $(e.currentTarget).children("[img-type]").attr("img-type");
			ImageLayerController.show(i, s, n, r, t && t.get(0).tagName.toUpperCase() == "SPAN" ? ! 0: ! 1)
		})
	},
	followManage: function(e, t) {
		var n = {
			tu: t,
			ac: e
		};
		LoadingController.saveLoading(),
		NetWork.commonRequest(this, n, this.followReaction)
	},
	followReaction: function(e, t) {
		LoadingController.unloading();
		var n = parseInt(t.ac, 10),
		r = localStorageObj.get("at"),
		i = this.jObj.attr("usrid"),
		s = r ? r.msg: null;
		if (parseInt(e.result, 10) === 0) switch (n) {
		case g_ac.AC_USER_FOLLOW:
			Tips.blink("success", "已收听"),
			this.jObj.find("a.t_unfollow_nav").show(),
			this.jObj.find("a.t_follow_nav").hide();
			if (s) {
				var o = e.jsonDump.userInfo;
				s.unshift([o.id, o.name, o.faceUrl, o.cnId]),
				localStorageObj.set("at", r)
			}
			this.cfg && this.cfg.followSuccess && this.cfg.followSuccess.call(this, e, t);
			break;
		case g_ac.AC_USER_UNFOLLOW:
			Tips.blink("success", "已取消收听"),
			this.jObj.find("a.t_follow_nav").show(),
			this.jObj.find("a.t_unfollow_nav").hide();
			if (s) {
				for (var u = 0; u < s.length; u++) if (s[u][0] == i) {
					s.splice(u, 1);
					break
				}
				localStorageObj.set("at", r)
			}
			this.cfg && this.cfg.unfollowSuccess && this.cfg.unfollowSuccess.call(this, e, t);
			break;
		default:
			console.error("shouldn't be here")
		} else n == g_ac.AC_USER_FOLLOW ? Tips.blink("fail", "收听失败") : Tips.blink("fail", "取消收听失败")
	},
	toggleLbsMap: function() {
		var e = this.jObj.find("a.t_show-map").data("lat"),
		t = this.jObj.find("a.t_show-map").data("lon");
		if (!e || ! t) {
			console.error("must have lbs link");
			return
		}
		if (this.jObj.find("div.t_lbs-img").length < 1) {
			Canvas.loading();
			var n = "ABQIAAAAs2arCx3Ebp9iHtN3drjDuxRLr8XrmgYli4bJkXrC4b8DPKrv-hSp7h2ix1LQy_lS5s_aX2S8-rgHIQ",
			r = "http://ditu.google.cn/maps/api/staticmap?center=" + e + "," + t + "&zoom=13&size=265x150&mobile=true&language=zh-CN&markers=color:blue|size:S|" + e + "," + t + "&sensor=false&key=" + n,
			i = "http://ditu.google.com/maps?q=" + e + "," + t,
			s = '<div class="wb-media t_lbs-img"><a target="gmaps" href="' + i + '" ><img class="t_lbs-img" src=' + r + ' width="265" height="150"></a></div>';
			this.jObj.find("div.t_wb-area-info").append(s),
			this.jObj.find("div.t_lbs-img").show();
			var o = this;
			this.jObj.find("img.t_lbs-img").load(function() {
				Canvas.unloading(),
				o.jObj.find("a.t_show-map").text("隐藏地图")
			})
		} else this.jObj.find("img.t_lbs-img").unbind("load"),
		this.jObj.find("div.t_lbs-img").remove(),
		this.jObj.find("a.t_show-map").text("显示地图")
	},
	reply: function() {
		this.showActionForm(g_ac.AC_MSG_REPLY)
	},
	delSelf: function() {
		var e = {
			ac: g_ac.AC_MSG_DEL,
			mid: this.jObj.attr("msgid")
		},
		t = this,
		n = confirm("您要删除信息");
		n && NetWork.commonRequest(this, e, function(e) {
			e.result == 0 ? (Tips.blink("success", "已删除"), t.onDelete ? t.onDelete() : t.jObj.remove()) : Tips.blink("fail", "删除失败")
		})
	},
	favManager: function(e, t) {
		var n = this,
		r = t ? $(t) : n.jObj,
		i = r.attr("msgid"),
		s = {
			ac: e,
			mid: i
		};
		LoadingController.saveLoading(),
		NetWork.commonRequest(this, s, function(t) {
			LoadingController.unloading(),
			t.result == 0 ? e == g_ac.AC_MSG_KEEP ? (r.attr("isfav", "true"), Tips.blink("success", "已收藏")) : (r.attr("isfav", "false"), Tips.blink("success", "已取消收藏"), r.attr("favpage") == "true" && r.fadeOut(1e3)) : Tips.blink("fail", t.msg)
		})
	},
	showActionForm: function(e, t) {
		writePopLayer.init(),
		this.setPopContent(e, writePopLayer),
		writePopLayer.show()
	},
	setPopContent: function(e, t) {
		function m(e, t) {
			var n = $(t),
			r = n.text();
			n.children().length > 0 ? n.contents().each(h) : t.localName != "a" || r.indexOf("#") == 0 ? v.push(r) : t.localName == "a" && t.getAttribute("data-uid") != null ? t.getAttribute("data-cnid") != null && t.getAttribute("data-cnid") != "" ? v.push("@" + t.getAttribute("data-cnid")) : v.push("@" + t.getAttribute("data-uid")) : v.push(r)
		}
		var n = "",
		r = "发送",
		i = "",
		s = ! 1,
		o = this.jObj,
		u = o.attr("type") ? parseInt(o.attr("type")) : - 1,
		a = o.attr("usrname"),
		f = "",
		l = 0;
		e == g_ac.AC_MSG_REPLY || e == g_ac.AC_MSG_DIRECT_REPLY ? f = "对" + a + "说:": e == g_ac.AC_MSG_FORWARD ? (f = "转播", r = "转播") : e == g_ac.AC_MSG_COMMENT && (f = "评论", r = "评论", l = 1);
		if ((e == g_ac.AC_MSG_FORWARD || e == g_ac.AC_MSG_COMMENT) && (u == g_msgtype.FORWARD || u == g_msgtype.COMMENT)) {
			var c = [];
			function h(e, t) {
				var n = $(t),
				r = n.text();
				if (n[0].nodeType != 3 && n.css("display") == "none") return;
				if (n.children().length > 0) n.contents().each(h);
				else if (t.localName == "img" || t.localName == "a" && r.indexOf("#") != 0) {
					if (t.localName == "a" && t.getAttribute("data-uid") != null) t.getAttribute("data-cnid") != null && t.getAttribute("data-cnid") != "" ? c && c.push("@" + t.getAttribute("data-cnid")) : c && c.push("@" + t.getAttribute("data-uid"));
					else if (t.localName == "img" && ! n.hasClass("t_load")) {
						var i = t.getAttribute("src");
						i = i.substring(i.lastIndexOf("f") + 1),
						i = i.substring(0, i.lastIndexOf("."));
						var s = parseInt(i, 10),
						o = FaceMapping.getText(s);
						c && c.push(o)
					}
				} else c && c.push(r)
			}
			o.find(".t_fwd_content").contents().each(h);
			var p = o.attr("usrid");
			o.attr("cnid") != null && o.attr("cnid") != "" && (p = o.attr("cnid")),
			n = "|| @" + p + ":" + c.join("").replace(/\(|\)/g, "")
		}
		var d;
		u != g_msgtype.FORWARD ? (d = o.find(".t_source_msg"), d.length == 0 && (d = o.find(".t_fwd_content"))) : d = o.find(".t_source_msg"),
		d.length <= 0 && this.getSourceDom && (d = this.getSourceDom().find(".t_fwd_content"));
		var v = [];
		d.contents().each(m);
		var g = v.join("").replace(/\(|\)/g, "");
		i = "原文：<br>" + (g.length > 48 ? g.substr(0, 48) + "...": g);
		if (o.find("a.t_mb_image").length > 0 || this.getSourceDom && this.getSourceDom().find("a.t_mb_image").length > 0) i += '&nbsp;<span class="ico-image"></span>';
		var y = {
			srcContent: i,
			fContent: n,
			strTip: f,
			buttonTxt: r,
			ac: e,
			onlyComment: l,
			msg: this,
			image: s
		};
		t.setParams(y)
	},
	removeActionForm: function(e) {
		e = e ? e: this.jObj,
		e.children(".t_msg-op-form").remove(),
		e.children(".t_dialog").show(),
		e.find("a.t_comment-msg").show(),
		e.find(".t_mail-operation").show(),
		e.removeClass("t_edit")
	},
	submit: function(e) {
		var t = e.ac;
		Canvas.loading(this.jObj.find("a.t_wirte_send-btn").get(0));
		if ($.trim(e.msg) == "" && t != g_ac.AC_MSG_FORWARD) {
			Canvas.unloading(),
			writePopLayer.isPosting = ! 1,
			Tips.blink("fail", "请输入内容");
			return
		}
		LoadingController.pubLoading(),
		NetWork.sendMsg(this, e)
	},
	errorReaction: function(e) {
		writePopLayer.isPosting = ! 1,
		LoadingController.unloading(),
		writePopLayer.hide()
	},
	sendReaction: function(e) {
		writePopLayer.isPosting = ! 1;
		var t = this.jObj,
		n = $("#d_myhome");
		LoadingController.unloading(),
		Canvas.unloading(t.find("a.t_send").get(0)),
		writePopLayer.hide(),
		e.result == 0 ? (writePopLayer.writeParams.successTxt ? Tips.blink("success", writePopLayer.writeParams.successTxt) : writePopLayer.writeParams.ac == g_ac.AC_MSG_FORWARD ? (Tips.blink("success", "已转播"), Page.prototype.insertNewMessage.call(this, n, e)) : writePopLayer.writeParams.ac == g_ac.AC_MSG_COMMENT ? Tips.blink("success", "已评论") : Tips.blink("success", "已发布"), writePopLayer.writeParams.afterSuccess && writePopLayer.writeParams.afterSuccess.call(this)) : writePopLayer.writeParams.ac == g_ac.AC_MSG_FORWARD ? (Tips.blink("fail", "转播失败"), Page.prototype.insertNewMessage.call(this, n, e)) : writePopLayer.writeParams.ac == g_ac.AC_MSG_COMMENT ? Tips.blink("fail", "评论失败") : Tips.blink("fail", "发布失败")
	}
}),
MbMessage.initMessage = function(e, t, n) {
	e.length > 1 ? e.filter("li[msgid]").not(".t_getmore").each(function(e, r) {
		new MbMessage(r, t, n)
	}) : e.children("li[msgid]").not(".t_getmore").each(function(e, r) {
		new MbMessage(r, t, n)
	})
},
PrivateMessage.prototype = new MbMessage,
PrivateMessage.prototype.constructor = PrivateMessage,
$.extend(PrivateMessage.prototype, {
	bindAction: function() {
		var e = this;
		this.jObj.find(".t_reply").click(function() {
			var e = $(this),
			t = "上一条：" + e.parents("li").find(".t_content").html(),
			n = e.data("to");
			privateLayer.open({
				toUser: n,
				lastContent: t
			})
		})
	}
}),
PrivateMessage.initMessage = function(e) {
	e.find("li").each(function(e, t) {
		new PrivateMessage(t)
	})
},
MbDetailMessage.prototype = new MbMessage,
MbDetailMessage.prototype.constructor = MbDetailMessage,
$.extend(MbDetailMessage.prototype, {
	onDelete: function() {
		PageManager.require("myhome", function() {
			var e = PageManager.getObj("myhome");
			e.enter({
				forceRefresh: ! 0
			})
		},
		this)
	},
	getSourceDom: function() {
		return this.sourceElement
	}
}),
EJS.Helpers.prototype.renderFaceProxyImg = function(e, t) {},
EJS.Helpers.prototype.renderFwdSource = function(e) {
	if (typeof e == "undefined" || typeof e == "string" && e.length === 0) return "";
	var t = "writer",
	n = "",
	r = "",
	i = "",
	s = "",
	o = "",
	u = "",
	a = "",
	f = "",
	l, c = "";
	e.msgAuthorIsVIP && (t = "auth writer", n = '<span class="vip"></span>');
	if (e.imgSrc && e.imgSrc.length > 0 || e.videoImageUrl && e.videoImageUrl.length > 0) e.imgSrc && e.imgSrc.length > 0 && (e.hideImg ? r = '<a class="t_mb_image" ><span img-type="' + e.imgType + '"   src="' + e.imgSrc + '/120" >查看图片</span></a>': r = '<a class="t_mb_image" ><img class=\'t_load\' img-type="' + e.imgType + '"  data-src="' + e.imgSrc + '/120" src="http://3gimg.qq.com/microblog/touch/img/default.png" alt=""  /></a>'),
	e.videoImageUrl && e.videoImageUrl.length > 0 && (e.hideImg ? (r = r + '<a href="' + e.videoLink + '" class="mb-video" target="_blank">', r += "<span  >查看视频</span>") : (r = r + '<a href="' + e.videoLink + '" class="wb-video" target="_blank">', r = r + '<img src="' + e.videoImageUrl + '" alt="" width="100" height="80">'), r += "</a>"),
	i = '<div class="wb-media">' + r + "</div>";
	e.showLink && (s = "href='#guest_home/u=" + e.authorId + "'"),
	l = e.forwardCount > 9999999 ? "9,999,999+": util.numNotation(e.forwardCount);
	if (e.msgType == 4 || e.msgType == 5) f = "href='#guest_home/u=" + e.replyToUserId + "'",
	a = ' 对<strong class="wb-username"><a ' + f + '  class="' + t + '"> ' + e.replyToUserName + " </a></strong>说 ";
	return e && e.lbsInfo && (c = renderMsgLBSArea(e.lbsInfo)),
	u = '<div class="wb-reply"><div class="wb-msg t_blockquote"><a ' + s + '">' + e.username + " </a>" + n + a + " : <span class='t_source_msg'>" + e.content + "</span></div>" + i + c + "</div>",
	u
},
EJS.Helpers.prototype.renderFwdSourcePad = function(e) {
	if (typeof e == "undefined" || typeof e == "string" && e.length === 0) return "";
	var t = "",
	n = "",
	r = "",
	i = "",
	s;
	return e.msgAuthorIsVIP && (t = "vip"),
	e.imgSrc.length > 0 && (e.hideImg ? n = '<a class="imgview" relimg="' + e.imgSrc + '">查看图片</a>': n = '<img class="illu"  src="' + e.imgSrc + '/120" >'),
	e.showLink && (r = "href='#guest_home/u=" + e.authorId + "'"),
	s = '<div class="replybox"><strong class="username"><a ' + r + '  class="' + t + '">' + e.username + "</a>:</strong>" + e.content + "",
	e.imgSrc && e.imgSrc.length > 0 && (s += '<div class="showimg"><span><img class="msg-img" src="' + e.imgSrc + '/160" alt="microblog img" ></span></div>'),
	s += "</div>",
	s
},
renderMsgLBSArea = EJS.Helpers.prototype.renderMsgLBSArea = function(e) {
	if (typeof e == "undefined" || typeof e == "string" && e.length === 0) return "";
	var t = e.addr,
	n = e.lat,
	r = e.lon,
	i = "";
	return e.sDis ? i = '<div class="wb-area-info t_wb-area-info"><address><em class="ico-area"></em>' + e.dis + " - " + t + " - " + '<a class="t_show-map" data-lat="' + n + '" data-lon="' + r + '" >显示地图</a></address></div>': i = '<div class="wb-area-info t_wb-area-info"><address><em class="ico-area"></em>' + t + " - " + '<a class="t_show-map" data-lat="' + n + '" data-lon="' + r + '" >显示地图</a></address></div>',
	i
},
HomePage = generatePage("myhome"),
$.extend(HomePage.prototype, {
	jObjDom: '<div id="d_myhome" class="lay-main t_page" ><div class="timeline"><nav class="timeline-nav home-timeline-nav"><ul class="t_tab-container"><li class="timeline-nav-item timeline-nav-active"><a mst="' + g_mst.HOME_MSG + '" class="t_listen_class" clickid="254">全部</a>' + "</li>" + '<li class="timeline-nav-item">' + '<a class="t_uncascade t_listen_class" mst="' + g_mst.SPECIAL_MSG + '" clickid="255">特别收听</a>' + '<a id="t_timeline_type_selector_btn"  class="select t_listen_class" clickid="256"></a>' + '<div id="t_timeline_type_selector" class="timeline-type-tips" style="display:none"><div><div></div></div></div>' + "</li>" + '<li class="timeline-nav-item">' + '<a href="#nearbymsg" class="t_listen_class" clickid="257">附近</a>' + "</li>" + "</ul>" + "</nav>" + '<div class="wb-client-tips t_topBanner" style="display:none">' + '<a class="t_banner_text"><img height="30" width="320" src=""/></a>' + '<span class="ad-tips-close t_close_banner"></span>' + "</div>" + '<div class="t_ad ad-tips" style="display:none;">' + '<a class="t_ad_text"></a>' + '<a class="ad-tips-close t_close_ad">关闭</a>' + "</div>" + '<div class="last-year-today t_listen_class" clickid = "425" style="display:none">' + '<div class="wb-lyt-summary t_listen_class" clickid = "425"></div>' + "</div>" + '<div class="timeline-inner" content="content" style="min-height:340px"></div>' + "</div>" + "</div>",
	jObjSubNavDom: '<div id="myhome_subnav" class="wb-interact t_subnav"><div class="wb-interact-avatar"><a onclick="" class="breath-light wb-user-headimg t_home_avatar t_listen_class" clickid="249" style="background:url(http://t1.qlogo.cn/mbloghead/default/40) no-repeat;-webkit-background-size:34px auto;"></a></div><div onclick="" class="wb-interact-textarea t_towrite t_listen_class" clickid="248">说说你在做什么，想什么</div></div>',
	checkAdExpire: function() {
		var e = localStorageObj.get("home_ad_expire");
		if (!e) localStorageObj.set("home_ad_expire", (new Date).getTime());
		else {
			var t = new Date(parseInt(e)),
			n = new Date,
			r = (n.getTime() - t.getTime()) / 1e3 / 60 / 60 / 24;
			Math.ceil(r) >= 7 && (localStorageObj.remove("home_ad"), localStorageObj.set("home_ad_expire", n.getTime()))
		}
	},
	bindLastYear: function() {
		var e = this,
		t = function() {
			location.hash.indexOf("notification") == - 1 && location.hash.indexOf("myhome") == - 1 ? (localStorageObj.set("hideLastYear", "true"), $(window).unbind("hashchange", t)) : location.hash.indexOf("notification") > 0 && (e.fromNoti = e.fromNoti ? e.fromNoti + 1: 1, e.fromNoti > 1 && (localStorageObj.set("hideLastYear", "true"), $(window).unbind("hashchange", t)))
		};
		$(window).bind("hashchange", t)
	},
	refresh: function() {
		var e = (new Date).toDateString(),
		t = localStorageObj.get("lastyearSavedTime"),
		n = localStorageObj.get("hideLastYear") ? localStorageObj.get("hideLastYear") : "false";
		(new Date(t)).toDateString() != (new Date).toDateString() && (n = "false"),
		localStorageObj.set("hideLastYear", n),
		n == "false" ? this.updateArgument.lastyear = 1: this.updateArgument.lastyear = 0,
		MessagePage.prototype.refresh.call(this)
	},
	enter: function(e) {
		touch_console_log && console.log((new Date).getTime() - window.startTime + " enter " + this.id),
		this.checkAdExpire(),
		MessagePage.prototype.enter.call(this, e),
		$("nav a.t_status_myhome").addClass("t_open"),
		this.currentTab = this.jObj.find("nav li.timeline-nav-active a")[0],
		localStorageObj.get("myhome_head_hide") == "1" && $(".t_home_avatar").removeClass("breath-light")
	},
	leave: function() {
		userInfoLayer.hide()
	},
	init: function() {
		MessagePage.prototype.init.call(this),
		this.lastyearTpl = '<span class="wb-lyt-username t_listen_class" clickid = "425">[%=data[0]%]</span>[% if(window.g_isVip){ %]&nbsp;<span class="vip"></span>[% } %]<p class="wb-lyt-msg t_listen_class" clickid = "425">[%=data[1].content%][% if(data[1].imageUrl){ %]&nbsp;<img  class="t_listen_class" clickid = "425" src="[%=data[1].imageUrl%]/60">[% } %][% if(data[1].lbsInfo){ %]&nbsp;<em class="ico-area t_listen_class" clickid = "425"></em>[% } %]</p>',
		this.updateArgument = {},
		this.updateArgument.mst = g_mst.HOME_MSG,
		this.updateArgument.ac = g_ac.AC_MORE_HOME_MSG,
		this.selectorBtn = this.jObj.find("#t_timeline_type_selector_btn"),
		this.selector = this.jObj.find("#t_timeline_type_selector"),
		this.topBanner = this.jObj.find(".t_topBanner"),
		g_isLogin && g_usrimg && this.jObjSubNav.find(".t_home_avatar").css("background", "url(" + g_usrimg + ")"),
		this.prefetchGetMoreData = ! 1,
		this.saveLastRefreshData = ! 0,
		this.activeTabName = MoveableNav.navTabs.HOME,
		this.headNavLoad = ! 0,
		this.initList(),
		this.tabs = this.jObj.find(".t_tab-container a[mst]")
	},
	initList: function() {
		var e = $("#t_timeline_type_selector > div > div"),
		t = "",
		n;
		if (g_groupJson && g_groupJson.lists && g_groupJson.lists.length) for (var r = 0, i = g_groupJson.lists.length; r < i; r++) {
			var s = g_groupJson.lists[r].name,
			o = util.getByteLength(s) > 12 ? util.getByteStr(s, 10) + "...": s;
			r == i - 1 ? t += '<a class="type-separa" mst="' + g_mst.LIST_MSG + '" listid="' + g_groupJson.lists[r].id + '">' + o + "</a>": t += '<a mst="' + g_mst.LIST_MSG + '" listid="' + g_groupJson.lists[r].id + '">' + o + "</a>"
		}
		n = '<a href="javascript:void(0)" mst="' + g_mst.SPECIAL_MSG + '">特别收听</a>' + '<a href="javascript:void(0)" mst="' + g_mst.BIDIRECTION_FOLLOWS + '">相互收听</a>' + '<a href="javascript:void(0)" mst="' + g_mst.QQ_FRIENDS_MSG + '" class="type-separa">QQ好友</a>' + t + '<a href="javascript:void(0)" mst="' + g_mst.TIMELINE_ORIGINAL_MSG + '">原创</a>' + '<a href="javascript:void(0)" mst="' + g_mst.TIMELINE_WITH_IMAGE_MSG + '">图片</a>',
		e.append($(n)),
		e.css({
			overflow: "hidden"
		})
	},
	setAd: function(e) {
		var t = localStorageObj.get("home_ad");
		localStorageObj.set("home_ad", t ? t + "," + e: e)
	},
	bindAction: function() {
		var e = this;
		MessagePage.prototype.bindAction.call(this),
		e.bindLastYear(),
		$(document).delegate(".t_towrite", "click", function(e) {
			location.href = "#compose"
		}),
		this.topBanner.find(".t_banner_text, .t_close_banner").click(function(t) {
			cookieObj.set("home_top_closed", e.topBanner.find(".t_banner_text").attr("advid")),
			e.topBanner.hide()
		}),
		this.jObj.find(".t_close_ad").click(function(t) {
			var n = $(t.target);
			e.setAd(n.attr("data-id")),
			e.jObj.find(".t_ad").hide()
		}),
		this.jObj.find(".last-year-today").click(function(e) {
			location.hash = "#lastyear"
		}),
		this.selectorBtn.click(function(t) {
			e.toggleTypeSelector()
		});
		var t = $("#t_timeline_type_selector > div");
		this.listScroller = new iScroll(t[0]),
		$(document.body).delegate(".t_home_avatar", "click", function(e) {
			localStorageObj.get("myhome_head_hide") || (localStorageObj.set("myhome_head_hide", "1"), $(".t_home_avatar").removeClass("breath-light")),
			userInfoLayer.show()
		}),
		this.jObj.find(".t_ad_text").click(function(t) {
			var n = $(t.target),
			r = {
				type: n.attr("data-type"),
				iskeyword: n.attr("data-iskeyword"),
				title: n.text(),
				keyword: n.attr("data-keyword"),
				advid: n.attr("data-advid"),
				link: n.attr("data-link"),
				id: n.attr("data-id"),
				posid: n.attr("data-posid")
			};
			r.type == 2 ? (e.setAd(r.id), util.pushHashParams({
				pageId: "topic_detail",
				urlParams: {
					title: r.title,
					keyword: r.keyword,
					iskeyword: r.iskeyword,
					advid: r.advid,
					posid: r.posid,
					type: r.type,
					tid: r.id
				}
			})) : r.type == 3 ? (e.setAd(r.id), util.pushHashParams({
				pageId: "detail",
				urlParams: {
					advid: r.advid,
					posid: r.posid,
					type: r.type,
					msgid: r.id
				}
			})) : r.type == 4 ? (e.setAd(r.id), util.pushHashParams({
				pageId: "guest_home",
				urlParams: {
					advid: r.advid,
					posid: r.posid,
					type: r.type,
					u: r.id
				}
			})) : r.type == 5 && (e.setAd(r.id), location.href = r.link)
		})
	},
	afterRefresh: function() {
		MoveableNav.scrollToTop()
	},
	getAd: function(e) {
		var t = localStorageObj.get("home_ad");
		t = t ? t + "": "";
		var n = 5;
		if (!e.length) return ! 1;
		while (n > 0) {
			var n = parseInt(Math.random() * (n - 1 + 1) + 1),
			r = n - 1;
			if (!e[r]) break;
			if (!t || t.indexOf(e[r].id) < 0) return e[r];
			e.splice(r, r),
			n--
		}
	},
	showLastYear: function(e) {
		var t = this,
		n, r = "",
		i = [],
		s = (new Date).toDateString(),
		o = localStorageObj.get("lastyearSavedTime"),
		u = this.jObj.find(".last-year-today .wb-lyt-summary").eq(0);
		e.info.todayOfLastYear != undefined && e.info.todayOfLastYear != null && (r = util.getByteLength(e.info.todayOfLastYear.content), r > 74 && (e.info.todayOfLastYear.content = util.getByteStr(e.info.todayOfLastYear.content, 70) + "…")),
		u.html(""),
		e.info.todayOfLastYear != undefined && e.info.todayOfLastYear != null ? (localStorageObj.set("lastyearSavedTime", new Date * 1), i.push(g_usrName), i.push(e.info.todayOfLastYear), n = (new EJS({
			text: this.lastyearTpl,
			type: "["
		})).render({
			data: i
		}), u.append(n).parent().css("display", "block")) : (u.parent().css("display", "none"), t.lastYearOff = ! 0)
	},
	refreshReaction: function(e, t) {
		var n = this;
		n.showLastYear(e);
		var r = e.jsonDump;
		MessagePage.prototype.refreshReaction.call(this, e, t),
		r.mst == 0 && ! t && NotifiStatus.clearData("unread");
		if (e.result == 0 && r && ! t) {
			if (r.adList && r.adList.topics && r.adList.topics.length > 0 && ! t) {
				var i = this.getAd(r.adList.topics),
				s = function() {},
				n = this;
				i && ! this.showOly ? (this.jObj.find(".t_ad_text").text(i.text), this.jObj.find(".t_ad_text").attr("data-type", i.type), this.jObj.find(".t_ad_text").attr("data-iskeyword", i.iskeyword), this.jObj.find(".t_ad_text").attr("data-title", i.title), this.jObj.find(".t_ad_text").attr("data-keyword", i.keyword), this.jObj.find(".t_ad_text").attr("data-posid", i.posid), this.jObj.find(".t_ad_text").attr("data-advid", i.advid), this.jObj.find(".t_ad_text").attr("data-link", i.link), this.jObj.find(".t_ad_text").attr("data-id", i.id), this.jObj.find(".t_ad").show(), this.jObj.find(".t_close_ad").attr("data-id", i.id)) : this.jObj.find(".t_ad").hide()
			}
			r.topBanner ? (this.topBanner.find("img").attr({
				src: r.topBanner.image
			}), this.topBanner.find("a.t_banner_text").attr({
				href: r.topBanner.link,
				advid: r.topBanner.advId
			}), this.topBanner.show()) : this.topBanner.hide()
		}
		this.selector.getComputedStyle("display") == "block" && this.toggleTypeSelector(),
		touch_console_log && console.log((new Date).getTime() - window.startTime + " afterrefresh " + this.id)
	},
	tabSwitch: function(e, t) {
		this.selector.css("display") == "block" && this.selector.slideUp();
		var n = this.jObj.find("ul.t_tab-container a.t_uncascade"),
		r = $(t.target),
		i = $(t.target);
		i.parents(".timeline-type-tips").length || n[0] == t.target ? (r.attr("listid") != "undefined" ? (n.attr("listid", r.attr("listid")), this.updateArgument.listid = r.attr("listid"), this.tabrefresh = ! 0) : (n.attr("listid", ""), delete this.updateArgument.listid, this.tabrefresh = ! 1), n.attr("mst", r.attr("mst")), n.text(r.text())) : this.tabrefresh = ! 1,
		MessagePage.prototype.tabSwitch.call(this, e)
	},
	toggleTypeSelector: function() {
		var e = this,
		t = $("#t_timeline_type_selector > div"),
		n,
		r;
		console.log(this.selector.getComputedStyle("display")),
		console.log(this.selector.getComputedStyle("opacity"));
		if (this.selector.getComputedStyle("display") == "block") this.selector.slideUp();
		else {
			this.selector.css({
				opacity: 1,
				display: "none"
			}),
			n = this.selector.height(),
			r = this.selector.width();
			var i = this.selectorBtn.get(0).getBoundingClientRect().left - this.selectorBtn.parent("li.timeline-nav-item").get(0).getBoundingClientRect().left;
			i = i - r / 2 + this.selectorBtn.width() / 2,
			i -= 4,
			this.selector.css("left", i + "px"),
			this.selector.attr("computed") !== "true" && (t.css("height", n + "px"), this.selector.attr("computed", ! 0)),
			this.selector.slideDown(),
			setTimeout(function() {
				e.listScroller.refresh()
			},
			500)
		}
		e.contentListening || (this.jObj.find("div[content]").get(0).addEventListener("click", function(t) {
			e.selector.css("display") == "block" && e.selector.slideUp()
		},
		! 0), e.contentListening = ! 0)
	}
}),
ComposePage = generatePage("compose", Page),
$.extend(ComposePage.prototype, {
	jObjDom: '<div id="d_compose" class="lay-main t_page"> <div class="timeline"> <nav class="toolbar"> <a class="back-btn t_btn-back" onclick="">返回</a><a  class="toolbar-title">发微博</a> <a  class="send-btn t_compose_send">发送</a></nav><div class="editfield-inner"> <div class="wb-input-area"> <div class="wb-textarea"> <textarea id="writeT" style="height:100px;"></textarea> <div class="wb-input-tips"> <div id="img-display" class="t_img-display" style="display:none"><a class="ico-img "><img class="t_ico-img" src="http://t1.qlogo.cn/mbloghead/default/100" height="18" width="18"></a></div><div id="geo-info-area"></div></div> </div> </div> <div class="wb-input-bar" id="trigerList"> <a class="ico-bq t_triface"></a><a class="ico-at t_triat"></a><a class="ico-ht t_tritopic"></a><a class="ico-pic t_triimg"></a><a class="ico-wz t_tripos"></a> <span class="wb-num-total wb-num-mis t_numtip">140</span> </div> <div id="displayList" style="min-height:350px"><div class="wb-input-cont wb-faces t_wrapper_input-cont" selected="false"><div style="height:560px;overflow:hidden"> <div class="wb-input-faces" style="height:560px"></div> </div></div> <div class="wb-input-cont t_wrapper_input-cont" selected="false"> <form action="" class="wb-at"><button type="reset" class="wb-qx-btn t_cancel_input">取消</button><input id="nameInput" type="text" class="wb-text-input t_search_input" autocomplete="off"> <button class="wb-at-submit t_sure_input"></button></form> <div class="wb-at-list t_scroll_wrapper"><div></div></div> </div> <div class="wb-input-cont t_wrapper_input-cont"  selected="false"> <form action="" class="wb-at"> <button type="reset" class="wb-qx-btn t_cancel_input">取消</button> <input type="text" class="wb-text-input" id="topicInput"><button class="wb-at-submit t_sure_input"></button> </form> <div class="wb-at-list t_scroll_wrapper"><div></div></div></div><div class="t_wrapper_input-cont"  selected="false"><div class="wb-upload-pic t_wb-upload-pic"> <form action="' + tupdomain + "/fileupload/s?aid=image_upload_touch&backUrl=" + location.protocol + "//" + location.host + location.pathname + '" enctype="multipart/form-data" name="image_form" method="post">' + '<div class="fileinputs t_fileinputs">' + '<input id="image_form_file" type="file" name="image_file" class="file hidden">' + '<input type= "submit" value= "submit" style="display:none" /> ' + "</div> " + "</form>" + '<a  class="btn choose-img-btn t_choose-img-btn">选择图片</a>' + '<a class="btn cancel-btn t_cancel-btn" style="display:none">取消</a>' + '<a class="btn upload-btn t_upload-btn" style="display:none">上传</a> ' + "</div>" + '<div class="wb-upload" id="wb-upload-error" style="display:none">' + '<div class="wb-upload-error" id="wb-upload-error-text"> 上传失败，图片超过2M大小	</div>' + "</div> " + '<div class="wb-upload" id="wb-upload-tips"> ' + '<p class="wb-upload-des" > Tips：<br>建议选择200K以内图片，最大不超过2M。支持gif、jpg、jpeg、png格式。 </p>' + "</div>" + "</div>" + "</div>",
	init: function() {
		Page.prototype.init.call(this),
		this.updateArgument.ac = g_ac.AC_MSG_POST,
		this.updateArgument.dumpJSON = 1,
		this.oTextArea = this.jObj.find("textarea"),
		this.activeTabName = MoveableNav.navTabs.NONE
	},
	tabOne: function(e, t) {
		var n = $("#trigerList a"),
		r = this.jObj.find(".t_wrapper_input-cont");
		n.removeClass("current"),
		r.attr("selected", "false"),
		r.hide(),
		this.oTextArea[0].blur(),
		this.lastIndex !== e ? (n.eq(e).addClass("current"), r.eq(e).attr("selected", "true"), r.eq(e).show(), this.lastIndex = e) : this.lastIndex = undefined,
		e == 3 && (this.jObj.find("#image_form_file").addClass("hidden"), this.jObj.find("a.t_choose-img-btn").show(), this.jObj.find("a.t_cancel-btn").hide(), this.jObj.find("a.t_upload-btn").hide())
	},
	bindAction: function() {
		var e = this,
		t = $("#trigerList a"),
		n = e.jObj.find(".t_wrapper_input-cont"),
		r = this.oTextArea[0],
		i = $("#nameInput")[0],
		s = $("#topicInput")[0],
		o = n[0],
		u = n[1],
		a = n[2],
		f = $("#geo-info-area")[0],
		l = this.jObj.find("span.t_numtip")[0],
		c = this.jObj.find(".t_wb-upload-pic form")[0],
		h = new WritePlus.Face({
			elemTextArea: r,
			elemWrapper: o,
			onInputEnd: function() {
				window.scrollTo(0, 0),
				r.focus()
			}
		});
		this.id == "compose" && this.oTextArea.bind("focus", function() {
			MoveableNav.scrollToTop()
		}),
		$("#trigerList a.t_triface").tap(function(t) {
			setTimeout(function() {
				h.scroller.refresh()
			},
			0),
			e.tabOne(0, t)
		});
		var p = new WritePlus.UserList({
			type: "at",
			elInput: r,
			elSearch: i,
			elWrapper: u,
			onCancel: function(t) {
				e.tabOne(1, t),
				r.focus()
			},
			onInputEnd: function() {
				window.scrollTo(0, 0),
				r.focus()
			}
		});
		$("#trigerList a.t_triat").tap(function(t) {
			e.tabOne(1, t),
			p.scroller.refresh()
		});
		var d = new WritePlus.Topic({
			elemTextArea: r,
			elemInput: s,
			elemWrapper: a,
			cancelCallBack: function() {
				e.tabOne(2, event),
				r.focus()
			},
			onInputEnd: function() {
				window.scrollTo(0, 0),
				r.focus()
			}
		});
		$("#trigerList a.t_tritopic").tap(function(t) {
			e.tabOne(2, t),
			d.scroller.refresh()
		}),
		this.at = p,
		this.count = new WritePlus.Count(r, l),
		this.objLBS = new WritePlus.LBS(t[4], r, f),
		$("#trigerList a.t_triimg").click(function(t) {
			var n = 0;
			if (navigator.userAgent.indexOf("OS") > - 1) {
				var r = navigator.userAgent;
				n = r.charAt(r.indexOf("OS") + 3),
				n >= 6 && (e.jObj.find('.wb-upload-pic form[name="image_form"]').css("width", "272px"), e.jObj.find("#image_form_file").css("width", "272px"), e.jObj.find("a.t_choose-img-btn").css("width", "272px"))
			}
			g_canUpload ? (e.jObj.find("#wb-upload-tips").show(), e.jObj.find("#wb-upload-error").hide(), e.tabOne(3, t)) : alert("抱歉！您的手机浏览器暂不支持网页上传图片功能。")
		}),
		this.jObj.find("a.t_cancel-btn").click(function(t) {
			localStorageObj.remove("temp_upload_message"),
			e.tabOne(3, t)
		}),
		this.jObj.find("a.t_upload-btn").click(function(e) {
			var t = $(r),
			n = t.val(),
			i = t.attr("latitude"),
			s = t.attr("longitude"),
			o = t.attr("geoaddr");
			localStorageObj.set("temp_update_position", $(document).scrollTop()),
			localStorageObj.set("uploadBackHash", NavControl.prevHash ? NavControl.prevHash: "#myhome"),
			(n || i || s || o) && localStorageObj.set("temp_upload_message", [n, i, s, o].join("|"));
			var u = new Date;
			c.action = c.action + "&sid=" + g_sid + "&tmstp=" + u.getTime(),
			LoadingController.saveLoading(),
			c.submit()
		}),
		g_isqqbrowser ? (e.jObj.find('.wb-upload-pic form[name="image_form"]').css("width", "272px"), e.jObj.find('.wb-upload-pic form[name="image_form"]').css("display", "none"), e.jObj.find("a.t_choose-img-btn").css("width", "272px"), e.jObj.find("a.t_choose-img-btn").click(function(e) {
			var t = new Date;
			c.action.indexOf("wbupload") < 0 && (c.action = c.action.replace("http", "http://wbupload") + "&qqb=1&sid=" + g_sid + "&tmstp=" + t.getTime() + "&cookiejs=composePageCookiejs&successjs=composePageSuccessjs&positionjs=func3"),
			c.submit()
		})) : this.jObj.find("#image_form_file").change(function() {
			var t = e.jObj.find("#image_form_file").val();
			t != null && t != "" && (e.jObj.find("#image_form_file").removeClass("hidden"), e.jObj.find("a.t_choose-img-btn").hide(), e.jObj.find("a.t_cancel-btn").show(), e.jObj.find("a.t_upload-btn").show())
		}),
		this.jObj.find("a.t_send").click(function(t) {
			localStorageObj.remove("temp_upload_message"),
			e.submit()
		}),
		this.jObj.find(".t_compose_send").click(function(t) {
			e.submit()
		}),
		Page.prototype.bindAction.call(e)
	},
	enter: function(e) {
		var t = this.jObj.find("img.t_ico-img"),
		n = this.oTextArea[0],
		r = this.jObj.find(".t_ct"),
		i = $("#geo-info-area"),
		s = localStorageObj.get("temp_upload_message");
		this.afterPicUpload(g_uploadStatus, g_msgImage),
		e && e.urlParams.tu && (n.value = "@" + e.urlParams.tu + " "),
		e && e.urlParams.topic && (n.value = "#" + e.urlParams.topic + "# "),
		s && (s = s.split("|"), s[0] && $(n).val(s[0]), s[1] && $(n).attr("latitude", s[1]), s[2] && $(n).attr("longitude", s[2]), s[3] && $(n).attr("geoaddr", s[3]), s[3] && (r.text(s[3]), i.show()), localStorageObj.remove("temp_upload_message")),
		t.attr("init") == "true" ? t.attr("init", ! 1) : (this.jObj.find("div.t_img-display").hide(), t.attr("src", ""), window.g_msgImage = undefined),
		MoveableNav.hide(),
		$("footer").hide(),
		this.at.refreshData(),
		Page.prototype.enter.call(this, e),
		MoveableNav.scrollToTop(),
		n.focus()
	},
	afterPicUpload: function(e, t) {
		e == "SUCC" && t != null && t != "" ? (this.jObj.find("div.t_img-display").show(), this.jObj.find("img.t_ico-img")[0].src = t + "/60", this.jObj.find("img.t_ico-img").attr("init", ! 0), this.jObj.find("div.t_img-display")[0].addEventListener("click", function(e) {
			picMorePopLayer.init(),
			picMorePopLayer.show()
		}), Tips.blink("success", "图片已上传")) : e != "NO_UPLOAD" && e != "SUCC" && (this.tabOne(3), this.jObj.find("#wb-upload-tips").hide(), e == "FAIL" ? Tips.blink("fail", "网络繁忙，请稍后再试") : e == "INVALID_FORMAT" ? Tips.blink("fail", "上传失败，图片不是gif/jpg/jpeg/png格式") : e == "TOO_SMALL" ? Tips.blink("fail", "上传大小过小") : e == "TOO_LARGE" && Tips.blink("fail", "上传失败，图片超过2M大小!"))
	},
	clean: function() {
		var e = this.jObj;
		e.find("section > span.msg").text(this.defaultcfg.info),
		e.find("section").hide(),
		e.find("p[type]").hide(),
		e.find(".t_numtip").text("140字")
	},
	cookiejs: function() {
		return "cookie"
	},
	successjs: function(e) {
		var t = e;
		t.status == "SUCC" && t.image != null && t.image != "" && (window.g_msgImage = t.image),
		this.afterPicUpload(t.status, t.image),
		this.jObj.find("img.t_ico-img").attr("init", ! 1);
		var n = this.oTextArea[0];
		n.focus()
	},
	leave: function() {
		delete this.updateArgument.latitude,
		delete this.updateArgument.longitude,
		delete this.updateArgument.geoAddr;
		var e = this.jObj;
		g_uploadStatus = "NO_UPLOAD",
		this.lastIndex !== undefined && this.tabOne(this.lastIndex),
		e.find("input.t_input-search").val(""),
		e.find("textarea").val(""),
		e.find("section > span.msg").text(""),
		localStorageObj.set("uploadBackHash", ""),
		MoveableNav.show(),
		$("footer").show()
	},
	refresh: function() {
		return ! 1
	},
	submit: function() {
		var e = this.oTextArea.val(),
		t = this.count.getNum();
		if (!e) {
			Tips.blink("fail", "请输入内容");
			return
		}
		if (t < 0) {
			Tips.blink("fail", "字数超过140字限制");
			return
		}
		var n = this.oTextArea.attr("latitude") ? this.oTextArea.attr("latitude") : null,
		r = this.oTextArea.attr("longitude") ? this.oTextArea.attr("longitude") : null,
		i = this.oTextArea.attr("geoAddr") ? this.oTextArea.attr("geoAddr") : null;
		n && r && (this.updateArgument.latitude = n, this.updateArgument.longitude = r, this.updateArgument.geoAddr = i),
		this.updateArgument.imgUrl = "",
		g_msgImage && (this.updateArgument.imgUrl = g_msgImage, window.g_msgImage = undefined),
		this.updateArgument.msg = e,
		LoadingController.pubLoading(),
		NetWork.sendMsg(this, this.updateArgument)
	},
	sendReaction: function(e) {
		var t = this;
		LoadingController.unloading();
		if (e.result == 0) {
			Tips.blink("success", "已发布");
			var n = $("#d_myhome ul[mst='" + g_mst.HOME_MSG + "']");
			n.length > 0 && Page.prototype.insertNewMessage.call(this, $("#d_myhome"), e),
			this.oTextArea.val(""),
			$("#img-display").css("display", "none"),
			t.objLBS.clear(),
			t.backAction(),
			localStorageObj.set("uploadBackHash", "")
		} else e ? Tips.blink("fail", "发布失败") : Tips.blink("offline")
	},
	backAction: function() {
		var e = this,
		t = localStorageObj.get("uploadBackHash"),
		n = e.oTextArea.val().length,
		r = e.oTextArea.attr("geoAddr"),
		i = $("#img-display").css("display") != "none",
		s = function() {
			t ? location.href = t: NavControl.back()
		};
		n || r || i ? confirm("确定离开此页面？") && (e.oTextArea.val("").attr("latitude", null).attr("longitude", null).attr("geoAddr", null), e.objLBS.clear(), s()) : s()
	}
});

